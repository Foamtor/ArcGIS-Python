{"meta":{"title":"kikita & Maps","subtitle":"For Tech and Fun","description":"kikita's Blog","author":"Xiaoyan Mu","url":"http://www.kikitamap.com"},"pages":[{"title":"","date":"2016-06-14T03:19:06.639Z","updated":"2016-06-13T08:49:13.444Z","comments":true,"path":"baidu_verify_nO8f44Co3Y.html","permalink":"http://www.kikitamap.com/baidu_verify_nO8f44Co3Y.html","excerpt":"","text":"nO8f44Co3Y"},{"title":"","date":"2016-03-21T07:13:52.632Z","updated":"2016-03-03T07:44:32.000Z","comments":true,"path":"about/index.html","permalink":"http://www.kikitamap.com/about/index.html","excerpt":"","text":"这里是 kikita 的个人博客 …. Welcome …. Who is kikita ? ArcGIS 爱好者 | Esri 长期桌面木工 木工开物 部分是她平时的一些和GIS相关的学习笔记、问题解决方法等，2016年3月之前的文章是从她的CSDN博客—慕名ArcGIS 中搬过来的。 当然这里还有一些她的 碎碎念 ； 还有，自以为是地感觉 相机里 拍得很美，或者很有情结的照片…"}],"posts":[{"title":"Make Query Layer在Model Builder中的使用","slug":"QueryLayerResult","date":"2016-06-30T10:11:33.000Z","updated":"2016-07-01T08:53:05.291Z","comments":true,"path":"2016/06/30/QueryLayerResult/","link":"","permalink":"http://www.kikitamap.com/2016/06/30/QueryLayerResult/","excerpt":"","text":"前两天碰到一个关于在 Model Builder 中使用 Make Query Layer 工具的问题，“如何把Make Query Layer结果输入到下一个工具中？” TIPS: 什么是 Query Layer？ 在ArcMap中，我们可以通过定义SQL语句创建Query Layer，来查询存储在DBMS中的空间数据或者非空间数据。 每次在ArcMap中显示或使用Query Layer时，都会执行查询，因此无需生成数据的副本或快照便可显示最新的信息，这尤其适用于处理频繁更改的动态信息。 Query Layer功能适用于 ArcGIS支持的所有DBMS。~ 详请点这里看 帮助。 下面通过一个实例先来说明下Query Layer的使用场景。 为了阐述方便，我找了一份数据稍作修改来模拟这个问题，数据位于基于Oracle的ArcSDE数据库，一个空间数据为点要素类，一个非空间表。 点数据表示事件，每发生一次事件（例如报警电话）就记录一个点，假设理想情况下同一个地址的事件都是重合点，如下图高亮的记录； 非空间表中记录了各个地址的某项分值（例如警力配备得分）。 打开脑洞，假设你是警察局长，需求是，获取每个有完整信息的地址（例如，点位于路的左侧或右侧的信息）的报警电话数，并对比警力配备分值，用于后续的工作，例如指挥调配或者空间统计工作等等。这时，使用Query Layer是个好选择。 Query Layer 返回的记录集可以是包含空间信息的 Feature Query Layer ，也可以是非空间信息的 StandAlone Table。 那么，其实在回到文章开头的问题，“如何把Make Query Layer结果输入到下一个工具中？” 这取决于“下一个工具” 接受的输入数据的类型是什么。 假如后续工作中需要用到空间数据，例如进行热点分析，评估下犯罪高发区，那么就需要查询SHAPE空间字段。 如果忽略了空间字段，普通的非空间表是没办法将记录集传递给后续空间处理的工具的。 Make Feature Layer 中的 SQL语句： 123456789101112131415select c.SHAPE, c.ADDRESS, count(c.ADDRESS) as CallNum, min(s.SCORE) as MinScore, c.POINT_X, c.POINT_Yfrom SDE.kikita_Calls c left join SDE.kikita_ScoreTable s on c.ADDRESS=s.ADDRESSwhere c.AV_SIDE in ('R','L')group by c.SHAPE,c.ADDRESS,c.POINT_X, c.POINT_Yorder by CallNum DESC 附一张结果图：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"Troubleshooting： 有防火墙的情况下你需要如何部署许可服务器？","slug":"LMthroughFireWall","date":"2016-06-17T08:11:33.000Z","updated":"2016-07-06T08:43:29.975Z","comments":true,"path":"2016/06/17/LMthroughFireWall/","link":"","permalink":"http://www.kikitamap.com/2016/06/17/LMthroughFireWall/","excerpt":"","text":"防火墙是一种有效的安全策略，如果部署ArcGIS许可的环境中不允许关闭防火墙，你可能会遇到这个错误：ArcGIS administrator 连不到许可服务器，提示错误， “ “xxx.xxx.xxx.xxx”没有有效的许可管理器。请输入一个有效的许可管理器服务器。 ” 那么，如何解决这个问题？ 如下。 1 找到 Service.txt 文件在许可服务器所在的机器上，默认位于：C:\\Program Files (x86)\\ArcGIS\\License10.x\\bin 目录下。 打开之后，类似下图： 通过修改此配置文件可以控制ArcGIS许可服务器后台进程使用哪个端口。 1Plus 知其所以然如果你对问题的原因不感兴趣，那么直接跳至2。 ArcGIS License Server Administrator（旧称ArcGIS License Manager）的后台进程有两个：lmgrd.exe 和 ArcGIS.exe，用于响应客户端获取许可的请求。 在 Service.txt 文档中： 第一行配置的是 lmgrd.exe 这个进程的端口，默认是 27000，自 10.3 版本之后，有效范围仅可以是 27000-27009 这个几个端口号之一； 第二行是用于 ArcGIS.exe 进程的端口配置，默然情况下，这个端口是动态的，系统可以使用任何监听到的空闲端口。 我们用个小工具来检测一下，Process Explorer，官网下载点这里，即可一目了然。在安装有 ArcGIS License Manger 的测试机上的执行小工具，抓取有用的信息： 从结果中可以得到，ArcGIS.exe 采用了 49479 这个端口与其他客户端通信。 在下次 ArcGIS License Service 启动时，这个端口会动态选择另一个。 这也就是问题的 key point，为什么用户即使在防火墙中开放了27000，甚至 27000-27009段的端口，然而许可服务器还是连不上。 2 锁定后台进程端口号前文提到 ArcGIS.exe 端口是动态的，为了方便防火墙的设置，锁定端口是最简单有效的方法。 在 Service.txt 文件中，第二行结尾增加 PORT=&lt;端口号&gt; 的参数。 例如我选择 50000 ，如下图： 修改完成，保存txt，重启 ArcGIS License Service ，然后过一会再去抓信息，发现 ArcGIS.exe 的端口号已经被锁定为 50000 ，变成静态。 3 在防火墙中创建规则放行端口现在需要做的仅是，在防火墙上建立白名单，设置规则允许 27000 和 50000 端口的 TCP/IP 协议通信即可。 这个配置方法在 官方文档 中有很清楚的说明，如果感兴趣也一起看看。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"License","slug":"License","permalink":"http://www.kikitamap.com/tags/License/"},{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"}]},{"title":"海","slug":"theBlueSea","date":"2016-05-24T05:27:49.000Z","updated":"2016-05-24T05:36:12.190Z","comments":true,"path":"2016/05/24/theBlueSea/","link":"","permalink":"http://www.kikitamap.com/2016/05/24/theBlueSea/","excerpt":"","text":"摄于 2014-5-4, Paros Island, Greece 瞄了一眼《太阳的后裔》，看到里面的沉船湾，又想起了那片海，真的美！","categories":[{"name":"相机里","slug":"相机里","permalink":"http://www.kikitamap.com/categories/相机里/"}],"tags":[]},{"title":"浅谈使用ArcPy执行大数据量处理任务","slug":"ParallelPython","date":"2016-04-28T04:31:40.000Z","updated":"2016-04-29T03:41:55.474Z","comments":true,"path":"2016/04/28/ParallelPython/","link":"","permalink":"http://www.kikitamap.com/2016/04/28/ParallelPython/","excerpt":"","text":"Python功能强大而易于学习。对于ArcGIS for Desktop用户来讲，Python是提高工作效率的不二选择。 Arcpy是esri提供的用于高效数据处理分析、制图等的Python站点包。 利用ArcPy，我们可以在ArcMap的Python窗口交互执行脚本，还可以创建自定义脚本工具或脚本工具箱，还可以在ArcGIS之外运行独立脚本，享受更纯正的python体验。 这一篇说说如何利用Python批量执行数据处理任务，这个问题也是前段时间遇到的用户的实际问题，比较有价值。 需求还是从实例开始…… 有一个简单但耗体力的裁剪任务，希望通过大量面分割（逐一裁剪）大量的数据，类似Split工具要完成的任务，并且要按照一定的规则命名将分割结果输出到指定的位置，例如要求有指定前缀。 实现例如，一种思路是逐一遍历面要素，然后去裁剪目标数据再输出，这时你可能会遇到下面的小问题： 我如何通过ArcPy获取要素的几何？ 在ArcPy中提供了一个数据访问模块/Data Access (arcpy.da)，我们可以通过游标（Cursor）来查询要素的几何或属性。在这个需求中是逐一遍历面要素的几何，我们选择 SearchCursor，通过 SHAPE@ 可以访问要素的几何。 语法： SearchCursor(in_table, field_names, {where_clause}, {spatial_reference}, {explode_to_points}, {sql_clause}) 了解详细的帮助信息点这里。 那么可以把函数主体定义成这样，即可实现需求： 12345678910111213def MyBatchClip(Parameter): # 参数 inputFC = Parameter[0] ClipArea = Parameter[1] OutputWS = Parameter[2] Prefix = Parameter[3] # 字段列表，SHAPE@ 访问要素几何对象 Fields = ['FID','SHAPE@'] # 遍历面要素逐一裁剪目标数据并输出自定义前缀的结果。 with arcpy.da.SearchCursor(ClipArea,Fields) as cursor: for row in cursor: outputFC = os.path.join(OutputWS, Prefix+str(row[0])+'.shp') arcpy.Clip_analysis(inputFC, row[1], outputFC) 多进程如果这个批量任务是大量的，如何更高效地开动起来？ 这里按照esri以前的一篇 Blog 提到的方法分享给大家，使用Multiprocessing模块并行处理。 Multiprocessing 模块是Python的一个标准库，通过这个库，我们可以利用多核CPU，来实现多进程处理大数据量的任务。 可以通过 multiprocessing.Pool 来使用进程池，Pool类可以管理固定数目的进程，默认是开启和机器CPU数目相同的进程。 语法：multiprocessing.Pool([processes[, initializer[, initargs[, maxtasksperchild]]]])processes表示pool中进程的数目，默认地为当前CPU的核数。initializer表示新进程的初始化函数。initargs表示新进程的初始化函数的参数。maxtasksperchild表示每个进程执行task的最大数目 把脚本修改下，加上多进程处理的部分： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546# -*- coding:utf-8 -*-__author__ = 'kikita'import arcpyimport timeitimport timeimport multiprocessingimport osarcpy.env.workspace = r'D:\\LearnAboutPython\\MyPythonProject\\UsingCurser\\DemoDataS.gdb'arcpy.env.overwriteOutput = True# 批量裁剪函数def MyBatchClip(Parameter): # 参数 inputFC = Parameter[0] ClipArea = Parameter[1] OutputWS = Parameter[2] Prefix = Parameter[3] # 字段列表，其中 SHAPE@用于访问数据几何 Fields = ['OBJECTID','SHAPE@'] with arcpy.da.SearchCursor(ClipArea,Fields) as cursor: for row in cursor: outputFC = os.path.join(OutputWS, Prefix+str(row[0])+'.shp') arcpy.Clip_analysis(inputFC, row[1], outputFC) print Prefix+str(row[0])+'.shp'if __name__ == '__main__': # 参数 OutputWS = r'D:\\LearnAboutPython\\MyPythonProject\\UsingCurser\\OutputWS' # SDE库输出 #OutputWS = r'C:\\Connection131.sde' Parameter1 = ['CountyPoints','Area_A',OutputWS, 'AAA_'] Parameter2 = ['hyd_line','Area_B',OutputWS, 'BBB_'] Parameter3 = ['River_line.shp','Area_C.shp',OutputWS,'CCC_'] Parameters = [Parameter1,Parameter2,Parameter3] # 当前CPU核数 print 'CPU Count:' + str(multiprocessing.cpu_count()) # 进程池 MyGPpool = multiprocessing.Pool() # 多进程并行处理 StartTime = time.time() results = MyGPpool.map(MyBatchClip,Parameters) EndTime = time.time() print 'Elapsed: ' + str(EndTime - StartTime) + ' Seconds...' 结果 123456789101112131415161718192021222324CPU Count:8AAA_0.shpBBB_0.shpCCC_0.shpBBB_1.shpAAA_1.shpCCC_1.shpBBB_2.shpAAA_2.shpCCC_2.shp………………BBB_28.shpAAA_27.shpBBB_29.shpCCC_28.shpCCC_29.shpAAA_28.shpBBB_30.shpCCC_30.shpAAA_29.shpAAA_30.shpElapsed: 28.628000021 Seconds... 一点有用的提示：1.在使用Multiprocessing时，注意数据锁定（Schema Lock）的问题，例如这个例子中，当输出工作空间选择为FileGDB时出现异常。 使用文件夹输出 Shapefile，或者以SDE数据库作为输出工作空间，都是可以的。 2.我在代码中也加入了计时，用于比较并行与否的耗时情况。 但是有时确实会发现，较简单的处理任务时，多进程并行并不比单进程快，因为导入模块和启动进程都需要花时间。 参考：https://blogs.esri.com/esri/arcgis/2012/09/26/distributed-processing-with-arcgis-part-1/https://docs.python.org/2/library/multiprocessing.html#using-a-pool-of-workershttps://www.binpress.com/tutorial/simple-python-parallelism/121http://cloga.info/python/2014/01/12/PythonMultiprocessingintro/http://kmdouglass.github.io/posts/learning-pythons-multiprocessing-module.htmlhttp://broadcast.oreilly.com/2009/04/pymotw-multiprocessing-part-2.html","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Python","slug":"Python","permalink":"http://www.kikitamap.com/tags/Python/"},{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"留着","slug":"ForMyself","date":"2016-04-14T12:26:07.000Z","updated":"2016-04-14T14:34:40.000Z","comments":true,"path":"2016/04/14/ForMyself/","link":"","permalink":"http://www.kikitamap.com/2016/04/14/ForMyself/","excerpt":"","text":"看到几个句子，认同，留着 Love yourself, because you are unique and wonderful in your own way. You don’t have to win every argument. Agree to disagree. What other people think of you is none of your business. Life is too short to waste time hating anyone. So, get rid of those ill feelings. No one is in charge of your happiness except you. Forget issues of the past. Don’t remind your partner with her/his mistakes of the past. Don’t compare your life to others. You have no idea what their journey is all about. Don’t have negative thoughts or things you cannot control. Instead invest your energy in the positive present moment. 道理简单深刻，能够持久地实践才是真的懂了","categories":[{"name":"碎碎念","slug":"碎碎念","permalink":"http://www.kikitamap.com/categories/碎碎念/"}],"tags":[]},{"title":"红沙滩","slug":"RedBeach","date":"2016-04-08T12:38:22.000Z","updated":"2016-04-08T13:52:19.000Z","comments":true,"path":"2016/04/08/RedBeach/","link":"","permalink":"http://www.kikitamap.com/2016/04/08/RedBeach/","excerpt":"","text":"摄于 2014-5-8，Akrotori, Santorini, Greece","categories":[{"name":"相机里","slug":"相机里","permalink":"http://www.kikitamap.com/categories/相机里/"}],"tags":[]},{"title":"宁静的白与蓝","slug":"Peaceful","date":"2016-04-01T14:02:28.000Z","updated":"2016-04-01T14:35:33.000Z","comments":true,"path":"2016/04/01/Peaceful/","link":"","permalink":"http://www.kikitamap.com/2016/04/01/Peaceful/","excerpt":"","text":"摄于 2014-5-8, Oia, Santorini, Greece","categories":[{"name":"相机里","slug":"相机里","permalink":"http://www.kikitamap.com/categories/相机里/"}],"tags":[]},{"title":"CGA：自动判断模型间关系的3D建模方法","slug":"IfModelsTuches","date":"2016-04-01T02:29:27.000Z","updated":"2016-04-06T03:50:56.741Z","comments":true,"path":"2016/04/01/IfModelsTuches/","link":"","permalink":"http://www.kikitamap.com/2016/04/01/IfModelsTuches/","excerpt":"","text":"背景最近遇到一个有趣的问题，如何在CityEgnine中判断有接触或相交关系的模型，从而自动进行建模？ 这个问题有点抽象，我们来看个实例，了解下问题的背景: 以往绝大多数情况下，我们拿到的2D建筑物底面（FootPrint）都是一个建筑对应一个面，也就是这样的： 实际生活中的的建筑物可能是更复杂的，例如商场、大型会议中心、复杂居民楼等参差不齐的多栋联合建筑，我们可以采集多个底面来表示建筑物，例如这样： 使用多个底面表示一栋复杂建筑物的做法可以很大程度上简化建模的工作，因此无可厚非。 但是问题来了，因为是彼此独立的Footprint，建模时若不加判断，就会出现如下图所示的情况，好像“空中地下室”。这样的房子既不美观也不实际。 解决方法CityEngine的真正魅力在于“动态”建模，这是CE的创作者一直想要传播的理念。 CityEgnine提供很多内置函数解决这些问题，其中有一组为：Occlusion Functions，包含：inside，overlaps，touches 三个函数。 我们可以利用 touches() 来实现判断。 先写段简单的来了解下函数用法： 1234567Init --&gt; extrude(40) MassMass --&gt; comp(f)&#123;top:NIL| side:Side&#125; Side --&gt; case touches(): color(1,0,0) ShareSide else: Walls 针对前面“空中地下室”的问题，可以在楼层切割到窗户和墙体的时候做个判断，楼层不touch其他楼层时，再进行分割。 可以实现这个样子： 全部 CGA 代码共享给大家： 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566/** * File: TestTouches.cga * Created: 1 Apr 2016 13:00:24 GMT * Author: kikita */version \"2015.2\"# Define Attributesattr AVG_HEIGHT = 0attr WindowsWidth = 8attr WallWidth = 2.5# Building SchmeticInit --&gt; extrude(AVG_HEIGHT) MassMass --&gt; comp(f)&#123;top:Top|side:Walls&#125;Walls --&gt; split(y) &#123; 15 : GroundFloor | &#123;~10 : UpperFloors &#125; * &#125;# Ground FloorGroundFloor --&gt; setupProjection(0, scope.xy, '1, '1) projectUV(0) texture(\"GroundFloor.jpg\") # All Upper FloorsUpperFloors --&gt; # Use touches() function case touches(): setupProjection(0, scope.xy, 10, 10) projectUV(0) texture(\"Wall/wall_grey.jpg\") else: split(x)&#123; ~WallWidth : AllWalls | &#123; ~WindowsWidth : WindowTiles | ~WallWidth : AllWalls &#125; * &#125; WindowTiles --&gt; split(y)&#123; ~WallWidth/2: AllWalls | ~WindowsWidth : Windows| ~WallWidth/2 :AllWalls &#125;# Wall Texture AllWalls --&gt; setupProjection(0, scope.xy, 10, 10) projectUV(0) texture(\"Wall/wall_grey.jpg\")# Windows Windows --&gt; color(\"DAFAF3\") i(\"Windows/sash_window.obj\") s('1,'1,'2) # RoofsTop --&gt; offset(-0.5) comp(f)&#123; border : RoofEdge | inside : RoofFlat &#125; RoofFlat --&gt; setupProjection(0, scope.xy, '1, '1) projectUV(0) texture(\"flatroof6.bw.jpg\") RoofEdge --&gt; extrude(1) 明天就放假了 节日愉快 我说的是愚人节 哈","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"},{"name":"CityEngine","slug":"CityEngine","permalink":"http://www.kikitamap.com/tags/CityEngine/"},{"name":"CGA","slug":"CGA","permalink":"http://www.kikitamap.com/tags/CGA/"}]},{"title":"圈","slug":"TheCircle","date":"2016-03-30T14:26:41.000Z","updated":"2016-04-08T13:55:28.000Z","comments":true,"path":"2016/03/30/TheCircle/","link":"","permalink":"http://www.kikitamap.com/2016/03/30/TheCircle/","excerpt":"","text":"摄于 2015-4-29 ，牛岛，济州岛 这是一个很有意思的场景，在当时有段极平常的谈话 M：马和草地上渐变色的圆圈真好看J：马被拴着，当然把草地吃了个圈 人会不会也这样？ 埋头努力，无意识地啃了一个人人称赞的漂亮的圈，然而ta的愿望是想摆脱这个圈。","categories":[{"name":"相机里","slug":"相机里","permalink":"http://www.kikitamap.com/categories/相机里/"}],"tags":[]},{"title":"Hexo My Blog","slug":"WhatHasBeenDoneUntill327","date":"2016-03-27T10:36:17.000Z","updated":"2016-03-31T05:27:16.810Z","comments":true,"path":"2016/03/27/WhatHasBeenDoneUntill327/","link":"","permalink":"http://www.kikitamap.com/2016/03/27/WhatHasBeenDoneUntill327/","excerpt":"","text":"截止到今天，都做过什么？ 备个忘…… 1.安装Hexo [文档] 2.选主题 Hueman [hexo-theme-hueman] 3.搬运填内容 [CSDN] 4.各种倒饬主题 - Banner图片、favicon - Widget顺序 - weiboxiu,友链 - 多说评论，国内Share - 自定义网页字体 - 图床外链 - Goolge Analyst 5.在Mac上部署Hexo，多个终端一起更新博客 欠倒饬的地方： 归档目录折叠 博客加目录导航 下一期再说……","categories":[{"name":"碎碎念","slug":"碎碎念","permalink":"http://www.kikitamap.com/categories/碎碎念/"}],"tags":[]},{"title":"渺小","slug":"insignificant","date":"2016-03-21T10:36:17.000Z","updated":"2016-04-01T06:27:01.963Z","comments":true,"path":"2016/03/21/insignificant/","link":"","permalink":"http://www.kikitamap.com/2016/03/21/insignificant/","excerpt":"","text":"摄于 2014-5-7, volcano island, Santorini, Greece 我在山谷这头，对面是驻足的游客，忽然觉得此刻很美 和自然相处，会发现人真的很渺小，很多郁结不开的琐事就变得不知何物 要常常提醒不要忘记那刻的自己","categories":[{"name":"相机里","slug":"相机里","permalink":"http://www.kikitamap.com/categories/相机里/"}],"tags":[]},{"title":"分割线","slug":"SplitLine","date":"2016-03-21T09:22:49.000Z","updated":"2016-03-23T06:19:32.319Z","comments":true,"path":"2016/03/21/SplitLine/","link":"","permalink":"http://www.kikitamap.com/2016/03/21/SplitLine/","excerpt":"","text":"前阵子走走停停、陆陆续续地搬内容、改主题 枯燥的工作终于结束了 这篇是华丽的分割线 后面会有些新的文字 To Be Continued ……","categories":[{"name":"碎碎念","slug":"碎碎念","permalink":"http://www.kikitamap.com/categories/碎碎念/"}],"tags":[]},{"title":"Hello World ！","slug":"HelloWorld","date":"2016-03-01T04:45:39.000Z","updated":"2016-03-04T10:23:42.000Z","comments":true,"path":"2016/03/01/HelloWorld/","link":"","permalink":"http://www.kikitamap.com/2016/03/01/HelloWorld/","excerpt":"","text":"我的个人博客 kikita &amp; Maps 上线了，记录点见闻感触，累积点技术知识，只为让自己的生活鲜活积极。 今天中午换了个新主题 hueman，慢慢摸索学习 Hexo，还是很有趣的。 还是那句话，I walk slowly, but I never walk backward.","categories":[{"name":"碎碎念","slug":"碎碎念","permalink":"http://www.kikitamap.com/categories/碎碎念/"}],"tags":[]},{"title":"你所不知的有趣投影方法","slug":"FunnyProjections","date":"2016-02-04T05:00:00.000Z","updated":"2016-03-21T07:22:07.684Z","comments":true,"path":"2016/02/04/FunnyProjections/","link":"","permalink":"http://www.kikitamap.com/2016/02/04/FunnyProjections/","excerpt":"","text":"高斯克吕格/Gauss Kruger、兰伯特/Lambert、墨卡托/Mercator……这些是业内人士耳熟能详的 投影方法，它们各有适用场景以确保投影后某类或某几类变形最小，其最终要义就是最大程度地精确表示位置。然而，这一篇中不是对这些投影方法进行阐述，而是传递一些新奇特的投影玩法。 ArcGIS中提供了众多的坐标系统定义信息，有些 投影坐标系一直静静存在，只是没有被关注，今天我们一起翻几个牌子。 准备示例数据，世界大洲及格网数据，当前是地理坐标系 WGS1984，首次拖拽到 ArcMap看起来是我们最熟悉的这个样子： 下面我们变换不同的投影方法，看看世界发生了什么变化。 埃托夫投影/Aitoff projection将世界投影到长短轴为2：1的椭圆上，有关这个投影方法的说明，戳 这里。 等距方位投影/Azimuthal equidistant projection这是一种平面投影，由纬度和经度确定的一个点作为平面与椭球的切点，详情戳 这里。 当切点是本初子午线和赤道交点时，我们看到的世界是这样，大陆好像散开的拼图： 当以北极为切点时，我们看到的世界是这样： 为什么有种莫名的熟悉感？联合国的Logo是这样吧，灵感来自这里： 柏哥斯星状投影/Berghaus Star Projection这种投影方法很有趣，让人一见倾心。此方法通常中心在北极，是对中央半球使用等距方位投影，而地球的另一半被分割为五个三角形，从而形成了一个围绕圆心的星形。详情戳 这里。 这种投影方法被 美国地理学家协会(AGG) 采用作为 Logo。 彭纳投影/Bonne Projection这个投影方法，博主同样喜欢。伪圆锥投影，所有的纬线为同心圆弧，并且投影变换后是个大大的心形。 喜欢研究算法的同学，戳这里看公式。 温克尔三重投影/Winkel tripel projection这可能是我们最常见的世界地图挂图的一种投影方法，详情戳这里。 古蒂等面积投影/Goode homolosine projection这种投影方法最小化整个地球的变形，是一种不连续的伪圆柱等积投影，详情戳这里，还有这里。 这种投影方法有两个版本，大陆和海洋。 Land: Ocean: “上帝视角”/The World From Space最后说一种 ArcGIS 自带的命名为 “The_World_From_Space” 的平面坐标系（WKID: 102038），使用了正射投影（Orthographic Projection）方法。投影变换后，像是在太空遥看这个蓝色星球。 这个坐标系的默认参数是 Longitude_Of_Center: -72.5333333334；Latitude_Of_Center: 42.5333333333，因此北美大陆位居中央。 修改下参数，调整下切点位置，把我们心中美丽的中国转过来~ 投影变换是不是也挺有意思的？ 让我们真正发现了“数学之美”。春节临近，祝大家新春愉快喽！","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Coordinate System","slug":"Coordinate-System","permalink":"http://www.kikitamap.com/tags/Coordinate-System/"},{"name":"Mapping","slug":"Mapping","permalink":"http://www.kikitamap.com/tags/Mapping/"}]},{"title":"为影像数据去除无效值","slug":"RasterNodata","date":"2016-02-02T05:00:00.000Z","updated":"2016-03-04T10:46:32.000Z","comments":true,"path":"2016/02/02/RasterNodata/","link":"","permalink":"http://www.kikitamap.com/2016/02/02/RasterNodata/","excerpt":"","text":"在使用栅格数据时，黑边和白边问题比较困扰我们，╮(╯-╰)╭ ，丑丑地如下所示： 那如何处理这些问题呢？方法不是唯一的，我把 ArcMap 中最常用的几种方式列举一下，帮你给数据“化妆”，或者更确切的说是“整容”： Option 1 栅格计算器在去黑边之前最先需要了解的是黑边的像元值是什么？ 可以使用 Identify 工具 查查看。 例如这份数据是 0。 这时，你也许会想到设置图层背景值的色彩可以吧？ 如果仅为了显示使用，是可以解决问题的，但传统意义上的去黑边，我们一般理解成栅格数据的处理，也就是从存储上修改特定值（本例中是 0）值为 Nodata。 单波段数据处理起来常常相对容易些，最常用的工具就是 栅格计算器/Raster Calculator 了。Raster Calculator 可以通过输入的Python语法的表达式，对当前数据框内的栅格图层进运算。它是个非常实用的栅格数据处理工具，如果你想 Dive In ，点 这里了解 Raster Calculator 的工作原理。 例如这个需求中仅需要一个简单表达式，使用到SetNull函数，如下所示： 其中，表达式是 SetNull(“RasterLayer” == 0 , “RasterLayer” ) 这样执行工具之后，所有的 0 值变成了 Nodata，彻底去了黑边。 Option 2 影像分析窗口多波段数据同样会受到黑边的困扰，而且现实情况往往没有单波段数据那么理想，仅通过一个表达式就可以搞定。例如，我们常用的影像底图数据，通常有三个波段，通过包含RGB三个波段的一组值来表示像元值，例如 (0,255,129)。我一般会根据需要处理的数据量的多少给出不同的处理方法建议： 同样第一步需要确认黑边值是什么？本例中是 (0,0,0) ArcMap的 Windows 菜单中有 Image Analysis 。在 Image Analysis 窗口中的 Processing 部分可以对当前数据框中的图层赋予函数或函数链，从而对栅格数据实时处理。 在弹出的窗口中，在 fx行右键插入函数，例如这个需求中会使用到 Mask Function。 设置 Mask Function，(0,0,0) 组合是无效值。为什么选择 All 而不是 Any？ 这个答案很显见，同时都为0的像元值才是无效值，否则不是，例如（1，255，0）是有效的。或者说各个波段的0值是and关系，而不是or。 这样带有函数的新栅格图层会自动加入 ArcMap 的 TOC，看起来万事大吉，然而这里需要说明下，这个图层需要Export到硬盘上的某个位置，它目前还是个临时数据，当layer被移除掉，这个结果就不复存在。 所以，最后重要的一步，导出数据。 (￣ˇ￣) 这种方法，还适用于具有多种无效值的情况。例如，除了(0,0,0) 还包含 (255,255,255) ： 我们需要做的仅是继续增加栅格函数。在 Function Template Editor 中函数们顺序相接，像个环环相接的链条，所以称为 ”函数链/ Function Chain“，咦，好像跑题了。请继续看如何设置无效值： 这样就实现了去掉两组无效值。 Option 3 镶嵌数据集那么摆在你面前的数据不是一个，而是“很多”呢？凡事保证质量之后，重复工作多了之后就同时需要保证效率，那么这种方法适用于“很多”、“大量”…… ArcGIS 的镶嵌数据集是个理想与实用兼备的影像数据管理模型，我们用它来“处理”大量栅格数据也是个不错的选择。 在地理数据库中创建镶嵌数据集，并将数据添加到镶嵌数据集中，之后： 在”之后“之前的预备动作，此文中不赘述，但是你可以看这篇了解这些内容。 在镶嵌数据集中可以使用工具 Define Mosaic Dataset Nodata 工具，对数据的无效值进行定义。 从而批量去除了无效值。 镶嵌数据集本身也支持栅格函数，类似影像数据窗口中函数模板的设置，同样可以设置函数链来实现一些复杂的要求。 有关镶嵌数据集函数，也可以参考这篇。 常见的操作一般就这几种，总结下，单波段优先考虑栅格计算器；多波段可以使用影像分析窗口；如果数据量较大，建议使用镶嵌数据集。 ArcGIS Desktop 虽然不是专业做影像数据处理的平台，但是拥有的这些功能能很大程度上解决影像处理的常见问题。写这一篇是因为不少用户遇到类似问题，集中总结下比较有意义，希望给大家一些思路，下次遇到此类的问题时，自己动手试试吧。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"实践 ArcGIS Web 3D","slug":"ArcGISWeb3D","date":"2016-01-17T02:45:37.000Z","updated":"2016-03-07T02:50:28.000Z","comments":true,"path":"2016/01/17/ArcGISWeb3D/","link":"","permalink":"http://www.kikitamap.com/2016/01/17/ArcGISWeb3D/","excerpt":"","text":"ArcGIS 产品家族的 Web 3D 功能众多用户期待已久，从 ArcGIS 10.3.1 版本开始，Esri 放了个大招，千呼万唤始出来的 Web 3D 功能，终于不再犹抱琵琶半遮面了。 那到底如何将创建和发布3D场景呢？ 下面就把今天的测试过程记录下。 测试环境硬件 处理器：Intel Core i7 4710MQ @ 2.50GHz 内存：16G 显卡：NVIDIA GeForce GT 730M OS Windows 10 Pro 软件 ArcGIS Pro 1.1.1 （必要） ArcGIS for Server 10.3.1 （必要）包括： Portal for ArcGIS ArcGIS Web Adpter (IIS) ArcGIS Data Store ArcGIS for Desktop 10.3.1 CityEgnine 2015.2 不可不知的先决条件1. 首先确保自己的环境满足系统要求，这是非常重要的、不可忽略的条件之一，详情参考如下文档： ArcGIS for Server 系统要求 http://server.arcgis.com/zh-cn/server/latest/install/windows/arcgis-for-server-system-requirements.htm ArcGIS Pro 系统要求 http://pro.arcgis.com/zh-cn/pro-app/get-started/arcgis-pro-system-requirements.htm 2. ArcGIS 的 Scene Service 是一种新的 Web 服务类型，这种服务来自于 ArcGIS Pro，并且要求创建和发布 Scene Service 的ArcGIS Pro是1.1或将来的更高版本。 也就是说， 目前传统的ArcGIS for Desktop 是不能创建和发布Scene Service的。 3. 从 ArcGIS for Server 10.3.1 版本才开始了Scene Service 的支持。也就是，略早的 10.3 版本也是不可以的哦。为了发布3D数据（Multipatch）和2D数据作为门户中的托管场景图层，必要的安装组件有 Portal for ArcGIS，ArcGIS Data Store 。 其中，ArcGIS Data Store 用于存储 Scene Service 中所使用的场景图层切片缓存。 4 将 ArcGIS Server 与门户联合；并且将 ArcGIS Server 指定为门户的托管服务器。 具体如何配置？ 参考帮助文档，这里不赘述，虽然略有繁琐但有章可依： 联合 ArcGIS Server 站点与门户http://server.arcgis.com/zh-cn/server/latest/administer/windows/federate-an-arcgis-server-site-with-your-portal.htm 配置托管服务器http://server.arcgis.com/zh-cn/server/latest/administer/windows/configure-hosting-server-for-portal.htm 创建和发布Scene Service 的过程 1. 打开 ArcGIS Pro ，创建场景，加入场景数据。其中建筑物模型为 File Geodatabase 中的 Multipatch Feature Class。 2. 确保连接并激活 Portal，且自己的账户有创建内容、发布托管要素和发布托管场景的权限。 &gt; 这里需要说明下，目前，只用 Portal for ArcGIS 才支持发布 Multipatch 数据源的 Scene Service。 ArcGIS Online 暂不支持。如果大家的 ArcGIS Pro 是60天试用版本的许可，默认激活的门户是ArcGIS Online，需要添加并切换到一个可用的Portal。 3. 确保ArcGIS Pro 中场景的打开方式是 Global View。如果是 Local View ，也可以切换。 4. 分享场景，分析服务，确保没有 Error，如果有，需要事先修复。 5. 等待完成，确保Job目录中所有任务全部成功完成。 根据数据量的不同，带宽的不同，硬件配置的不同，整个发布服务的过程时间长短不一。 我的这个测试中共89个精细程度不一的建筑物模型，发布全过程大约耗时1分钟，供参考。 Web 前端访问服务ArcGIS Scene Viewer 需要支持 WebGL 的桌面 Web 浏览器，WebGL 是用于渲染 3D 图形的 web 技术标准。 点 这里 测试浏览器是否启用了 WebGL，请打开 get.webgl.org； 要解决与 WebGL 相关的问题，请访问 WebGL 疑难解答。 ArcGIS Scene Viewer 支持这些 web 浏览器：Chrome，Firefox，Internet Explorer 11，Safari。我这里使用的是 Chrome 是 Version 47.0.2526.111 m (64-bit)。 好像还不错哦 表示树木的 Feature Layer 可以在 Web 端修改渲染 再凑近看看细节 再换换底图，做几个Slide 刚好这个周末比较清闲，可以用比较连续的时间做了测试，效果还算令人满意，后面我会再做些大数据量的测试，有空再更新。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"},{"name":"Web","slug":"Web","permalink":"http://www.kikitamap.com/tags/Web/"},{"name":"ArcGIS Pro","slug":"ArcGIS-Pro","permalink":"http://www.kikitamap.com/tags/ArcGIS-Pro/"}]},{"title":"Troubleshooting：Shapefile 乱码与字符截断问题","slug":"TroubleshootingShapefile","date":"2015-12-21T05:00:00.000Z","updated":"2016-07-06T08:45:29.159Z","comments":true,"path":"2015/12/21/TroubleshootingShapefile/","link":"","permalink":"http://www.kikitamap.com/2015/12/21/TroubleshootingShapefile/","excerpt":"","text":"Shapefile是上个世纪90年代的数据格式，但是由于它开放易用至今仍然倍受欢迎，最近与shapefile编码相关的问题此起彼伏连绵不绝，整理下几个高频问题共享之。 为什么我的shapefile在ArcGIS 10.3中打开乱码？ 原因这个问题的根本原因就是读取文件使用的编码类型和文件实际存储的编码类型不一致。 Shapefile文件的头文件（dBase Header）中，一般会包含shapefile使用的编码类型的信息，这个信息成为 LDID （ Language Driver ID），这样在使用应用程序打开 shapefile 的时候，应用程序就知道用何种编码类型去正确读取它，而不会发生乱码。 在 ArcGIS Desktop 生产的 shapefile 数据中通常会包含这项信息。在Shapefile的子文件中，有时我们还会发现同名 *.cpg 文件，文件中也存储了编码信息，用记事本打开，看到例如 utf-8。 二者被ArcGIS 识别的优先顺序是，LDID 优先于 CPG文件。也就是如果头文件中没有约定读shapefile的编码类型时，如果这时刚好有个CPG文件，那么ArcGIS就会使用这里的编码类型读取。 我们知道 shapefile 是个开放格式，只要你了解了数据规范，完全可以脱离ArcGIS自己生产出来。在Windows中文语言设置下，假设你自己写代码或者使用第三方的程序生产了shapefile，例如MapGIS，默认使用 CP936（GBK）编码存储，但是无论粗心大意还是有意为之没有在数据头文件中约定“我用了936！”。如果是 ArcGIS 10.2 和之前的版本，那么没问题，ArcGIS 默认就是以这种方式识别，没有乱码。可是拿到 ArcGIS 10.2.1 ，ArcGIS 10.2.2，ArcGIS 10.3.x 这几个版本中发现乱！码！了！在缺失 LDID 和 CPG时，这几个版本默认使用 UTF-8 来读取 shapefile，这样必然乱码了。 解决方法在shapefile子文件旁边创建个记事本，修改为同名的CPG文件，文本内容oem或者936。 这样 ArcGIS 10.2.1 、10.2.10.3.x 在读取的时候，就知道你的数据是这种编码类型存储的，从而按照正确的方式读取。 为什么ArcGIS 10.3导出 Shapefile的字段名会被截断成3个汉字？低版本中不是至少可以存储4个汉字吗？ 原因这个问题仍然与编码类型有关。 ArcGIS 10.2 以及更早的版本，ArcGIS写shapefile的时候，遇到中文默认使用Windows当前语言 字符集编码（也称 代码页/CodePage/OEM CodePage），例如中文一般使用的是 CodePage 936（GBK）。 ArcGIS 10.2.1 以及之后的版本，ArcGIS写shapefile的时候，默认使用的是 UTF-8 编码类型。 这两种编码类型存储汉字所使用的字节数是不相同的，上面的关键字中我也给出了 wiki 的链接，有兴趣点进去看看详情。简言之，shapefile自身的限制是字段为9个字节，CP936编码下汉字通常为双字节存储，因此可以存储 9/2=4 个汉字；UTF-8 编码下汉字至少需要3个字节存储，因此最多只能存储 9/3=3 个汉字了。 举个例子，在Python命令行中，我们求一下 Unicode字符串的长度就可以真相大白。 解决方法Perfect Solution：使用地理数据库，放弃shapefile，避免各种截断问题，这也是存储地理数据的康庄大道。 但是，shapefile的拥趸说“我的需求是恢复以前存储4个汉字的shapefile，我不想用地理数据库，我希望得到老版本的shapefile的结果，我不在乎shapefile的编码类型是什么 ……bla bla……”好吧，方法还是有的。 Workaround： 这里还有个注意事项：如果你用的刚好是 10.2.1 和10.2.2 这两个版本，那么要打补丁后以下设置才生效。以前写过另外一篇，详情点 这里。如果你用的是 10.3.x ，那么直接向下进行。 打开注册表，定位到 ‘My Computer\\HKEY_CURRENT_USER\\Software\\ESRI\\Desktop 10.x‘ 创建项 ‘Common‘， 接着在其下创建 ‘CodePage‘ 项， 添加 ‘字符串’，名称： dbfDefault，健值：oem（或者 936）。 这样ArcGIS Desktop 读、写 shapefile的默认方式就将是Windows当前语言 OEM CodePage 936。 PS：当然这种方法，也可以解决第一个问题，并且不需要为缺失oem编码信息的数据增加cpg文件了。两种方法，任君选择。 我如何检测当前shapefile使用了什么编码类型？ shapfile本身是个开放格式，当然我们有很多种途径查看shapefile的内部，读者中不乏代码大牛，只要了解数据规范应该方法多多。 我这里就分享一种通过 python 查看编码类型的简单的方法，使用python中的 struct模块 可以处理二进制数据，从而探测下 shapefile 的子文件 dbf 的头文件中的 LDID 信息是什么。 python代码示例：12345678910#-*-coding:utf-8 -*-__author__ = 'kikita'import structdbf = u'D:\\ExportShapefiles\\中文字段.dbf'dat = open(dbf, 'rb').read(30)[29:]id = struct.unpack('B', dat)[0]print(id, hex(id)) 例如，得到这样的打印结果： (77, &#39;0x4d&#39;) 通过这样的 ID 到 编码表 中查到就是 CodelPage 936。 当然如果有你更好的方法，博主求分享，可以直接在评论区里贴出来，共同讨论。 上面是三个最常被问到的问题，这三个问题通了，那么好多shapefile读写乱码问题就迎刃而解了。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"如何在ArcGIS for Desktop中实现批量任务","slug":"IterationinArcGISforDesktop","date":"2015-12-06T05:00:00.000Z","updated":"2016-03-04T10:52:04.000Z","comments":true,"path":"2015/12/06/IterationinArcGISforDesktop/","link":"","permalink":"http://www.kikitamap.com/2015/12/06/IterationinArcGISforDesktop/","excerpt":"","text":"ModelBuilder 是 ArcGIS for Desktop 产品中最可爱的功能之一，它可以尽可能免代码地将我们从重复劳动中解放出来。使用 ModelBuilder 的过程常常被比喻为“搭积木”，我们只需要拿着 ArcGIS for Desktop 中为我们提供的“积木”去搭建满足于自己的特定工作流模型。 再打个比方，我们要实现的某个功能比作是自己做面包。首先要准备食材，例如面粉、牛奶、鸡蛋、黄油、糖、盐、酵母，类比为 地理数据； 食材齐备了，就可以顺序开始和面、发酵、烘焙，这些工作由特定的器具承担，例如各种烘焙工具、烤箱，就好比ArcGIS提供的 工具，例如 ArcToolbox中的工具们； 面包制作过程中可以根据自己口味，规定发酵时间、控制糖和盐的多少等，这就类比为工具的自定义 参数 。 如果自己享受整个烘焙的过程，不厌其烦地面面俱到，那大可维持现状；可是如果你觉得做面包是个体力活，你只是想吃到自家面包，而希望把做面包的过程“外包”出去，那么面包机的市场就来了。这篇blog就和大家说说如何制作“面包机”。 1 明确需求我们从一个简单常见的实例开始…… 需求：现有一些表示各种研究对象的地理数据，小明希望把所有研究数据变换到需要的坐标系统，并且全部裁剪至研究范围。 如果只有一份数据，小明会不假思索的找到 ArcToolbox中的 Project和Clip工具，顺序执行即可解决问题；如果是3+份数据，小明可能会想，该做个工具了。 2 构建工作流从【地理处理】菜单，打开 ModelBuilder，依次拖拽和连接 Project 和 Clip 两个工具。Project 工具的输出作为 Clip 工具的输入。 双击工具可以打开工具继续填补工具需要的参数，直至Model因参数完全而变成彩色。 3 使用迭代器前一步的工具已经满足一次任务的需要了，接着就是解决批量处理的问题。ModelBuilder提供了一些额外的自带工具来满足我们的一些高级需求，其中一类就是 迭代器，它用来实现循环。 在这个例子中，需要遍历的对象是表示各种研究对象的要素类，因此选择 迭代要素类 / Iterate Feature Classes。当然也可以根据自己的实际需求选择其他迭代器。 接下来就是把迭代器与工具串联起来。首先，双击迭代器的六边形为迭代器设置工作空间，即地理数据库/GDB，或者文件夹目录（例如shapefile所在的目录）。这样，迭代器会在指定的工作空间遍历要素类。删除现有Project工具的输入数据，将迭代器的输出数据连接到Project工具。 工具基本准备完毕，但是还差了重要的一步。目前，最后的输出数据是常量，也就是说，即使前面的工具执行了N次，那结果都将被同名覆盖。那么，行内变量 就显出用武之地了。 迭代器每次遍历到一个要素类，会返回一个 Name，内容是当前要素类的名称，这个Name就是行内变量。引用的方法就是使用百分号括起来，即 %Name% 。 输出数据设置示例： 至此我们就完成了一次批量任务。 4 复用工具如果我们以后想按照这个相同的需求处理数据，完全可以将其做成模型工具。将输入数据和输出数据设置为模型变量，我们就可以在“运行”状态下使用。 设置方法，在需要作为参数方便后续修改的项目上右键，勾选 “模型参数”即可，然后项目的头上顶了个“P”，(￣▽￣)”。 将模型保存至工具箱后，双击运行工具。现在就可以把它当成“面包机”，放入食材，等面包即可。 5 注意事项下面是些有用的提示，FYI： 每个模型仅可使用唯一一个迭代器。如果模型中已经存在一个迭代器，那么用于添加迭代器的菜单就不可用了。这是限制之一。 如果将含有迭代器的模型导出为 Python 脚本，则导出的脚本中将不会包括迭代逻辑。这是限制之二。Python中有list函数，也可以实现类似的需求，但是需要重写。 尽管Model可以嵌套调用，但是迭代器的嵌套循环逻辑不佳，不建议使用。如果需要实现嵌套循环，强烈建议使用python脚本。例如，实现遍历工作空间内每个要素类中的每个要素（记录）这样的需求，可以使用 ArcPy中的函数 ListFeatureClasses 和 SearchCursor来实现。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"地统计分析笔记——探索数据","slug":"ExplorerData","date":"2015-11-27T10:19:41.000Z","updated":"2016-03-04T10:52:16.000Z","comments":true,"path":"2015/11/27/ExplorerData/","link":"","permalink":"http://www.kikitamap.com/2015/11/27/ExplorerData/","excerpt":"","text":"在执行地统计分析之前，浏览、熟悉、检查自己的数据是至关重要的。绘制和检查数据是地统计分析过程中的必要阶段，我们可以从这些工作中获得一些先验知识，指导后续的工作。 Stage 1 绘制数据通过ArcMap的图层渲染方案绘制数据，我们可以获得对数据的第一印象。 例如，使用单一符号渲染了解采样点的疏密分布，通过分类渲染了解采样点高值低值的分布，等等。 Stage 2 检查数据绘制数据后，使用 探索性空间数据分析 (Exploratory Spatial Data Analysis，ESDA) 工具来执行数据探索的第二阶段。这些工具提供了一种比绘制数据更加量化的方式来检查数据，有助于我们更深入地了解正在研究的现象，有助于我们对插值模型的构建方式做出更加正确的决策。 ESDA 工具包括： Ⅰ 是否服从正态分布？Histogram/直方图 直方图用于显示感兴趣数据集的频率分布并计算汇总统计数据，如何解读图形和统计信息呢？ 如果数据服从正态分布，则平均值（mean）与中值（median）类似，偏度（skewness）应接近零，并且峰度（kurtosis）应接近 3。 平均值即为数据的算数平均值。平均值提供分布中心的测量值。 中位数与累积比例 0.5 对应。如果数据以升序排列，50%的值位于中间值之下，50% 的值位于中间值之上。中间值提供了分布中心的另一个测量值。 第一和第三分位数分别与累积比例 0.25 和 0.75 对应。如果数据以升序排列，则 25% 的值位于第一分位数之下，25% 的值位于第三分位数之上。第一和第三分位数是分位数的特殊情况。 偏度系数是分布对称度的测量值。对于对称的分布，偏度系数为零。如果分布具有较长的大值右尾部，则为正偏分布；如果分布具有较长的小值左尾部，则为负偏分布。对于正偏分布，平均值大于中间值；对负偏分布，平均值小于中间值。 峰度取决于分布尾部的大小，提供分布产生异常值可能性的衡量指标。正态分布的峰度等于三。具有较厚尾部的分布被称为高峰态，其峰度大于三。具有较薄尾部的分布被称为低峰态，其峰度值小于三。 数据的方差，通常对过高值或过低值很敏感。标准差为方差的平方根，它描述了数据在平均值周围的分散程度。方差和标准差越小，测量值聚类相对于平均值就越紧密。 Normal QQPlots/正态QQ图 正态 QQ 图上的点可指示数据集的单变量分布的正态性。如果数据是正态分布的，点将落在 45 度参考线上。如果数据不是正态分布的，点将会偏离参考线。 General QQPlots/普通QQ图普通 QQ 图用于评估两个数据集的分布的相似程度。这些图的创建和所述的正态 QQ 图的过程类似，不同之处在于第二个数据集不一定要服从正态分布，使用任何数据集均可。如果两个数据集具有相同的分布，普通 QQ 图中的点将落在 45 度直线上。 ### 有关数据变换 Geostatistical Analyst 中的一些插值方法要求数据呈正态分布。如果数据偏斜（分布不均衡），则可能需要将数据变换为正态分布。 Box-Cox 变换（又称幂变换）如果在某一部分研究区域中计数值很小，这一区域的变异性就小于计数值更大的另一区域的变异性。在这种情况下，平方根变换将有助于使整个研究区域内的方差更加恒定，通常还会使数据呈正态分布。平方根变换是 Box-Cox 变换中 λ = ½ 时的特例。 对数变换对数变换实际上是 Box-Cox 变换中 λ = 0 时的特例。对数变换通常用于呈正偏分布的数据。其中有些值非常大，如果这些大值位于研究区域中，对数变换有助于使方差更加恒定和归一化数据。 例如数据如下分布： 变换前后对比： 反正弦变换反正弦变换可用于表示比例或百分比的数据。通常在数据为比例形式时，方差在接近 0 和 1 时最小，接近 0.5 时最大。反正弦变换有助于使整个研究区域内的方差更加恒定，通常还会使数据呈正态分布。 Ⅱ 是否存在异常值？全局异常值是相对于数据集中的所有值而言具有非常高值或非常低值的已测量采样点。局部异常值是一个已测量采样点，其值处于整个数据集的正常值域范围内，但查看周围点时，其值则显得异常高或异常低。 如果异常值是现象中的真实异常情况，那么这可能是研究和理解现象的最重要的位置点。如果异常值是由数据输入过程中的错误所导致的，那么在创建表面之前应该对其进行校正或移除。 Histogram/直方图如果在直方图的最左侧（极小值）或最右侧（极大值）能够看到一个孤立的条，可能表明这个条所表示的点是异常值。这种条越孤立于直方图的主条组，点是异常值的概率就越大。 Voronoi 图Voronoi 图是由采样点形成的泰森多边形地图。 在查看 Voronoi 图时，检查附近是否有面符号色彩差别很大的值。 例如，下图中红色面明显异于周围值。 Semivariogram/Covariance Cloud / 半变异函数/协方差云半变异函数/协方差云工具可以用来检查数据集中空间自相关的局部特征以及查找局部异常值。 云中的每个点表示数据集中的一对点，x 轴表示各位置间的距离，y 轴表示这些位置上的值的差值平方。半变异函数中的每个点都表示一个位置对，而不是地图上的单个位置。因此云中点的数量会随着数据集中点的数量的增加而快速增加。如果数据集中存在 n 个点，则半变异函数/协方差云中将显示 n*(n-1)/2 个点。因此，不建议使用点数超过几千个的数据集。如果数据集包含几千个点，那么应使用子集要素工具来随机选择点，然后在半变异函数/协方差云中使用子集。 “半变异函数/协方差云”工具对检测局部异常值特别有用。它们显示为互相接近的点（x 轴上的低值），但在 y 轴上却是高值，表明组成点对的两个点的值有很大差异。这与所期望的结果正相反，即互相接近的点有相似的值。 Ⅲ 是否存在趋势？Trend Analyst / 趋势分析“趋势分析”工具提供数据的三维透视图。采样点的位置绘制在 x,y 平面上，z值表示感兴趣的属性值。趋势分析工具将散点图投影到 x,z 平面和 y,z 平面上，通过多项式曲线对每个投影进行了拟合。 浏览图形垂直墙面上的粗线。这些线表示趋势。一条趋势线沿 x 轴（通常表示纵向趋势），另一条显示沿 y 轴的趋势（通常表示纬度趋势）。如果经过投影点的曲线是平的，则不存在趋势；如果多项式曲线具有确切的模式（如下图的蓝线和绿线），这表明数据中存在某种趋势。 另外，检查趋势时更改多项式的阶非常有用；检查不同于标准 N–S 和 E–W 方向的趋势非常有帮助，可以通过旋转趋势轴检查数据。 Ⅳ 是否空间自相关？我们可通过检查不同的位置的采样数据对来探索数据的空间自相关，仍然使用前面提到过的ESDA工具半变异函数云。 Semivariogram/Covariance Cloud / 半变异函数/协方差云如果存在空间相关性，则距离较近的点对（在 x 轴的最左侧）应具有较小的差值（在 y 轴上的值较小）。随着各个点之间的距离越来越大（点在 x 轴上向右移动），通常，差值的平方也应随之增大（在 y 轴上向上移动）。通常，平方差超过某个距离后就会保持不变。超过这个距离的位置对被视为不相关。 如果半变异函数中的点对构成一条水平的直线，那么数据中可能不存在空间自相关，因而对数据进行插值也就失去了意义。 地统计方法的基本假设是，对于任意两个彼此间的距离和方向都相近的位置，其差值的平方也应相近。这种关系称为平稳性。空间自相关可能仅依赖于两个位置之间的距离，这被称为各向同性。如果事物在某些方向上比在其他方向上更相似，也就是半变异函数和协方差中都存在这种方向性影响，它被称为各向异性。 交叉协方差云“交叉协方差云”工具可用于研究两个数据集之间的交叉相关。交叉协方差云显示了两个数据集间的所有位置对的经验交叉协方差，并且将其作为两位置间距离的函数对其进行绘制，与上面的工具类似，该工具也提供具有搜索方向功能的协方差表面。 对数据有了第一印象，并且用 ESDA 工具对数据做了检查，我们已经对待研究的数据有了一些先验知识，那么下面就可以选择插值方法来创建表面了，下一篇继续。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"},{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"“连不上ArcGIS License Manager” 的一点常用诊断方法","slug":"CanNotConnectAGSLM","date":"2015-11-27T10:00:41.000Z","updated":"2016-03-07T03:10:28.000Z","comments":true,"path":"2015/11/27/CanNotConnectAGSLM/","link":"","permalink":"http://www.kikitamap.com/2015/11/27/CanNotConnectAGSLM/","excerpt":"","text":"在 ArcGIS Desktop 的问题库中，有一类不算做核心技术问题，但却可能会位列“最常见的问题”之一。简言之一句话，”许可服务器连不上怎么办？！“ 下面就来演绎下问题的诊断过程。 本文仅适用于客户端 ArcGIS Administrator 访问 ArcGIS License Manager 正式版许可的问题的诊断，目前适用于 ArcGIS for Desktop 10.x、ArcGIS Engine 10.x、CityEngine 201x 版本的浮动许可诊断问题。博主说，你可能很难找到第二篇与ArcGIS Desktop 正版授权有关的博客了…… 单机版和破解版请绕行。 问题现象ArcGIS License Manager 已经授权完毕且成功，可用性（Availability）栏目中总计（Total）和可用（Available）的数目正常，服务器状态也运行正常。 图中的过期栏目中的日期可忽略，内部工作使用的正式许可是限定有效日期的。如果你使用的是购买得到的正式版许可，这里会显示 永久（Permanent），也就是许可是永久有效的。 然而，在通过局域网访问许可服务器的其它机器上的 ArcGIS Administrator 中，连接许可服务器失败。 常见错误提示： “机器名或者IP”does not have a valid Licesne Manager. Please enter a valid License Manager Server. 诊断思路我们可以结合一些初级的网络知识，按照如下思路测试，大多数情况下，你不需要依次全做完，就发现问题已经解决或至少找到了问题的原因。 1. 从许可服务器本机入手 如果情况允许，最好在许可服务器本机也安装 ArcGIS Desktop 程序，然后使用 ArcGIS Administrator 连接本机许可服务器，各次分别填写 localhost，本机IP，本机机器名，检查是否有问题。一般如果本机连接不上，就不要期待其它机器可以正常连接了。 常见处理方法： 在ArcGIS License manger 中执行：重读许可服务 –&gt; 停止许可服务 –&gt; 启动许可服务确保 ArcGIS Administrator 中许可类型选择正确，如 Advanced ，Standard ，Basic。 2. 确保网络连通 可以使用ipconfig /all观察本地网络设置是否正确。 可以使用 ping 命令测试下网络情况 ping 127.0.0.1 如果本地址无法Ping通，则表明本地机TCP/IP协议不能正常工作。ArcGIS的许可走的是TCP/IP 协议 ping本机IP地址 这样是为了检查本机的IP地址是否设置有误 ping本网网关或本网IP地址 这样的是为了检查硬件设备是否有问题，也可以检查本机与本地网络连接是否正常 如果这时遇到错误提示，就该向自己单位的 IT 寻求帮助了。有了通畅的网络环境，ArcGIS许可才能有效通讯。 3. 确认端口可用 如果网络通畅，然而还是无法连接许可服务器，肿么办？！那就再稍微往下深一步，博主的知识量有限，但是好奇心和倔强还是迫使她尽可能地再努力多做一点。 在”许可服务管理器指南“中提到，”默认情况下，将 lmgrd 后台程序设为端口 27000“。那么，连不上许可服务器是因为端口被锁定了吗？ 有可能，动手查查才放心。 听说，netstat是控制台命令,是一个监控TCP/IP网络的非常有用的工具。那么动手吧。 以管理员的身份运行命令窗口，并输入命令：netstat -abn 如果找到 27000 和 lmgrd.exe 这个进程 ，并且状态 Established，可以认为端口正常。 27000-27009是ArcGIS License Manger 的默认端口段，是相对不拥挤的段。但是，如果发现这个端口被其他程序占用了，那么就要修改ArcGIS许可服务器或者其它程序的端口了。在这里我就只能说说 ArcGIS 许可服务器的端口的修改方法了。 如何修改 ArcGIS 许可服务的端口？在 ArcGIS license manager 的安装目录下，bin目录下，找到 service.txt，打开如下样子： 修改这个配置文件，例如：在 SERVER 行的结尾处，您可选择直接在 ANY 后面指定端口号。在 VENDOR 行上，添加 PORT=####，其中 #### 是指定的特定端口号，用来将供应商后台程序锁定到特定端口，例如 1234。 这样我们可以在客户端使用例如 27004@许可服务器IP或机器名 的方式访问许可。 再看客户端机器，如果机器上有 telnet 客户端，那么还可以试试 telnet 命令测试远程主机的端口是否可用。 例如：telnet 192.168.100.115 27000，其中假设许可服务器IP为 192.168.100.115。 如果返回黑屏，仅左上角光标闪烁，那么可以认为可用。 如果不幸提示，”Connecting to 192.168.100.115……Could not open connection to the host on port 27000. Connect Failed. ” 关掉许可服务器和客户端机器的防火墙试试，确认是否可以正常访问。如果真的是防火墙作祟，我们可以在防火墙上创建个例外规则，确保27000端口可以穿过防火墙。windows 防火墙的例外规则创建看看 windows 的帮助吧，点 这里，我不叨叨了。如果单位里有更高级的防火墙或安全系统，需要配置例外规则，那么还是联系 IT 吧。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"License","slug":"License","permalink":"http://www.kikitamap.com/tags/License/"},{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"}]},{"title":"给自己做个地图故事——Trip to Greece","slug":"TriptoGreece","date":"2015-09-30T10:23:16.000Z","updated":"2016-06-16T06:14:53.756Z","comments":true,"path":"2015/09/30/TriptoGreece/","link":"","permalink":"http://www.kikitamap.com/2015/09/30/TriptoGreece/","excerpt":"","text":"Esri 的 地图故事 很有意思，用句官媒的广告 “每个人都有要讲述的故事，利用地图的强大功能来讲述您的故事” …… 国庆假期将至，放点有趣的东西。如果喜欢分享，又想记录自己的过往，动手试试不错哦。 如何制作故事地图 ? 我把链接搬运过来，点吧 地图故事中有好多应用程序模板可选，即使不懂技术也能hold住，只需要选个要讲的“故事类型”。 比如选择 Story Map Tour，这也有攻略，点这里。其实不看攻略也没关系。 在 Story Map Tour Builder 中可以选择上传自己的照片，ArcGIS Online 会自动管理。如果照片是带有GPS信息的 Geo-tagged 照片，那太好了，上传之后就自动定位了。 我把自己的一次行程做成了地图故事 Trip to Greece。 短链接：http://arcg.is/1LLY6fm 上面的与技术好像都不沾边，下面的可能沾点边…… 打开ArcGIS Online 上我的组织，查看我的内容，我们看到这个地图故事的应用一共有这样几个内容： 照片对应的点信息是通过 Feature Layer 维护的，所以在一开的时候选择上传照片时，要给 Feature Service 起个名字。","categories":[{"name":"相机里","slug":"相机里","permalink":"http://www.kikitamap.com/categories/相机里/"}],"tags":[{"name":"Mapping","slug":"Mapping","permalink":"http://www.kikitamap.com/tags/Mapping/"},{"name":"Web","slug":"Web","permalink":"http://www.kikitamap.com/tags/Web/"}]},{"title":"在ArcGIS中创建Python工具（三）","slug":"CreatePythonTool3","date":"2015-09-10T06:42:04.000Z","updated":"2016-03-04T10:52:52.000Z","comments":true,"path":"2015/09/10/CreatePythonTool3/","link":"","permalink":"http://www.kikitamap.com/2015/09/10/CreatePythonTool3/","excerpt":"","text":"从 ArcGIS 10.1 版本开始，我们可以创建 python工具箱 来自定义脚本工具，这种工具箱相比较上一篇提到的标准工具箱。有着独特的优势，具体二者的区别总结过，看这一篇。 认识 Python工具箱Python 工具箱 (.pyt) 是一个简单的文本文件，可以在任何文本编辑器中或者任何 Python IDE 中创建、查看和编辑。要确保 ArcGIS 正确识别 Python 工具箱，工具箱类的名称必须是 Toolbox。在 Toolbox 类的 __init__ 方法中定义工具箱的属性，这些属性包括 alias、label 和 description，我们可以按照 帮助文档 中的模板构建 Python 工具箱模板。 如下代码中创建了包含一个工具（名为 Tool）的 Python 工具箱： 1234567891011121314151617181920212223242526272829303132333435363738394041424344import arcpyclass Toolbox(object): def __init__(self): \"\"\"Define the toolbox (the name of the toolbox is the name of the .pyt file).\"\"\" self.label = \"Toolbox\" self.alias = \"\" # List of tool classes associated with this toolbox self.tools = [Tool]class Tool(object): def __init__(self): \"\"\"Define the tool (tool name is the name of the class).\"\"\" self.label = \"Tool\" self.description = \"\" self.canRunInBackground = False def getParameterInfo(self): \"\"\"Define parameter definitions\"\"\" params = None return params def isLicensed(self): \"\"\"Set whether tool is licensed to execute.\"\"\" return True def updateParameters(self, parameters): \"\"\"Modify the values and properties of parameters before internal validation is performed. This method is called whenever a parameter has been changed.\"\"\" return def updateMessages(self, parameters): \"\"\"Modify the messages created by internal validation for each tool parameter. This method is called after internal validation.\"\"\" return def execute(self, parameters, messages): \"\"\"The source code of the tool.\"\"\" return 动手做做下面我就依据这个模板，写一个简单的脚本工具箱。需求是批量裁剪，我希望我只提供一个文件夹或者数据库等这样的工作空间和一个裁剪区域面，就可以批量完成工作空间内全部数据的裁剪工作，并且无视栅格还是矢量，一并裁剪。 Let the scripting begin …… 1 创建工具箱工具箱的name就是 .pyt 文件的名字，通常我们把工具添加到 ArcToolbox窗口中时会显示工具箱的 label。在 Toolbox 类的 __init__ 方法中定义属性，例如： alias、label 和 description。 工具作为类被添加至 .pyt 中，工具箱的 tools 属性必须设置为包含定义的所有工具类的列表。比如，需要做ATool，ATool，CTool三个工具，不是写三个脚本，而是创建三个类，然后将类名放入列表， self.tools = [ATool,ATool,CTool] 。 这里，我仅定义一个工具类 ClipWorkspace，来说明构建过程即可 ： 123456789101112131415161718192021'''Source Name: ClipWorkspace.pytAuthor: KikitaDescription: Python tool to clip spatial data in the same workspace by batch.'''import arcpy# The class name must be \"Toolbox\" ...class Toolbox(object): def __init__(self): self.label = \"Clip Workspace Toolbox\" self.alias = \"\" # List of tool classes associated with this toolbox self.tools = [ClipWorkspace]class ClipWorkspace(object): …… 在 ArcGIS Desktop 中已经可以看到这个工具箱的雏形： 2 定义工具下面就是完善工具内部的代码。我就以 ClipVectorWorkspace 为例。 每个工具类应至少包括 __init__ 和 execute 方法。此外，还可以选择使用 getParameterInfo、isLicensed、updateParameters 和 updateMessages 方法向工具的行为中添加其他控制。 工具类中的 __init__ 方法是标准 Python 类初始化方法。对于 Python 工具箱中的工具，__init__ 方法用于设置该工具的属性，例如工具的标注、描述、是否允许在后台运行等。 下面的例子就创建了ClipVectorWorkspace这个工具： 123456class ClipWorkspace(object): def __init__(self): self.label = \"Clip Workspace\" self.description = \"clip spatial data in the same workspace by batch.\" self.canRunInBackground = True 有了工具的构造函数，我们继续看如何给工具定义参数。在 Python 工具箱 (.pyt) 中，可在工具类的 getParameterInfo 方法中创建 Parameter 对象，并设置对象的属性来定义工具参数。Parameter的属性中datatype包含的类型可以在帮助文档中查询，点这里。 此示例中的参数就是输入工作空间（inWorkspace）、裁剪区域面（ClipArea）、输出工作空间（outWorkspace）。 1234567891011121314151617181920212223242526272829def getParameterInfo(self): # Parameter Definitions # First parameter - Input Workspace param0 = arcpy.Parameter( displayName=\"Input Workspace\", name=\"inWorkspace\", datatype=\"DEWorkspace\", parameterType=\"Required\", direction=\"Input\") # Second parameter - Clip Area param1 = arcpy.Parameter( displayName=\"Clip Area\", name=\"CLipArea\", datatype=\"DEFeatureClass\", parameterType=\"Required\", direction=\"Input\") # Third parameter - Output Workspace param2 = arcpy.Parameter( displayName=\"Output Workspace\", name=\"outWorkspace\", datatype=\"DEWorkspace\", parameterType=\"Required\", direction=\"Input\") params = [param0,param1,param2] return params PS : 在代码中，如果仔细看，或许你会疑惑，为何输出工作空间的方向是 input ，而不是 output？ 因为工具最终输出的为 Feature Class 或 Raster，输出工作空间也是作为输入参数传入工具使用的。如果不关心，也可以不在意这些细节…… 继续向下了解工具的构建过程。 下面就是工具的具体执行部分了，当然里面还加了些辅助了解工具执行状态的消息： 1234567891011121314151617181920212223242526272829303132333435363738394041def execute(self, parameters, messages): \"\"\"The source code of the tool.\"\"\" # Get tool parameters inWorkspace = parameters[0].valueAsText arcpy.AddMessage(\"###Input Workspace is &#123;0&#125;\".format(inWorkspace)) ClipArea = parameters[1].valueAsText arcpy.AddMessage(\"###Clip Area is &#123;0&#125;\".format(ClipArea)) outWorkspace = parameters[2].valueAsText arcpy.AddMessage(\"###Out Workspace is &#123;0&#125;\".format(outWorkspace)) # Clip Feature by Batch arcpy.env.workspace = inWorkspace # Clip Vector FeatureClasses = arcpy.ListFeatureClasses() arcpy.AddMessage(\"Input Workspace contains &#123;0&#125;\".format(FeatureClasses)) for fc in FeatureClasses: arcpy.AddMessage(\"&gt;&gt; Clipping &#123;0&#125;\".format(fc)) arcpy.Clip_analysis(fc,ClipArea, os.path.join(outWorkspace,fc)) arcpy.AddMessage(\"&#123;0&#125; has been clipped.\".format(os.path.join(outWorkspace,fc))) # Clip Raster Rasters = arcpy.ListRasters() arcpy.AddMessage(\"Input Workspace contains &#123;0&#125;\".format(Rasters)) for Raster in Rasters: arcpy.AddMessage(\"&gt;&gt; Clipping &#123;0&#125;\".format(Raster)) arcpy.Clip_management(in_raster = Raster, rectangle = \"\", out_raster = os.path.join(outWorkspace,Raster), in_template_dataset = ClipArea, nodata_value = \"\", clipping_geometry = \"ClippingGeometry\", maintain_clipping_extent = \"NO_MAINTAIN_EXTENT\") arcpy.AddMessage(\"&#123;0&#125; has been clipped.\".format(os.path.join(outWorkspace,Raster))) return 到这里，工具的核心部分已经完成，执行下试试。 OK，应该是预期的结果： 3 完善我们发现不像标准工具箱中的脚本工具和脚本文件本身是散列存储的，python工具箱以及其中的所有工具的代码都在这一个pyt文件中，维护起来便利了不少。如果想在工具箱中继续添加工具，只要继续增加一个工具类即可。 经过前两步的过程，工具已经可以拿去使用。如果为了工具更友好，还可以继续调整下代码，以便遇到异常的时候，让用户了解更详细的原因，这里就再往下进行了。工具分享给别人，最后只差要丰富下工具文档了，同样在 Python 工具的 Item Description 中编辑。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Python","slug":"Python","permalink":"http://www.kikitamap.com/tags/Python/"},{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"在ArcGIS中创建Python工具（二）","slug":"CreatePythonTool2","date":"2015-09-02T14:19:20.000Z","updated":"2016-03-04T10:53:04.000Z","comments":true,"path":"2015/09/02/CreatePythonTool2/","link":"","permalink":"http://www.kikitamap.com/2015/09/02/CreatePythonTool2/","excerpt":"","text":"上一篇中我们了解到有两种方式在 ArcGIS 中创建 Python工具，这一篇就来看看如何在标准工具箱中创建脚本工具。 ArcGIS Help 中脚本工具的帮助过于枯燥，在这里，我以一个具体的实例来总结构建脚本工具的过程，我要实现的需求是做个快速实现羽化边界效果的小工具，预期得到如下的效果： 上面效果在ArcMap中完全可以手工运行几个工具实现，但是过程稍微繁琐，那么需求来了，如何做个自定的一键生成羽化边界的小工具？ 1 准备Python脚本文件第一步，先写好脚本工具的核心 —— python脚本文件。 脚本中我希望根据指定环间距自动生成一个9环的缓冲面，然后添加一个字段，用于存储给各个缓冲面的透明度百分比。 看下图就知道我想做什么了： 写一个py文件，将要用到的工具串联起来实现自己的需求，大致是下面的样子。这不是最终要做成脚本工具的版本，只是为了预先了解要如何实现，后面还要修改。 1234567891011121314151617181920212223242526272829303132333435__author__ = 'kikita'# FileName: EasyFeathering.pyimport arcpy# arcpy.env.workspace = \"D:\\something\\Data.gdb\"# Script Tool ParametersInputFeature = \"InterestArea\"OutputFeature = \"OutFeathering\"SingleRingWidth = 10000# Some Predefined Parametersdistances = []level = 9bufferUnit = \"meters\"NewField = \"Percent\"# My Easy Feathering functionfor i in range(level): distances.append(SingleRingWidth*(i+1)) i = i+1print str(distances)print \"Distance Complete!\"arcpy.MultipleRingBuffer_analysis(InputFeature, OutputFeature, distances, bufferUnit, \"\", \"ALL\",\"OUTSIDE_ONLY\")print \"Success to execute Multi Ring Buffer.\"arcpy.AddField_management(OutputFeature,NewField,\"double\")print \"Success to add Transparency Percent Field.\"arcpy.CalculateField_management(OutputFeature, NewField, \"!OBJECTID! *10\", \"PYTHON\", \"\")print \"Success to Calculate Transparency Percent Field.\" 2 脚本工具参数配置有了py文件之后，如何把它塞进工具箱里呢？ 在ArcMap的Catalog窗口中，找一个自己喜欢的任意文件夹，新建一个Toolbox，然后右键 Add –&gt; Script，进入向导，这些操作如果不了解，可以点 这里 查查帮助，照着做即可，不赘述。 这里我主要说说参数传递。 我希望做好的工具中，我只去指定三个参数，分别是：输入的兴趣区域面（input Feature ），多环缓冲的环间距（Single Ring width ），输出结果（output Feature ）。预览下工具界面： 那么问题又来了，这三个参数如何从工具界面传给真正执行工具的 python 脚本？我们需要对前面的脚本参数定义部分做个修改，使用 arcpy 提供的 GetParameterAsText()函数即可在工具界面和脚本之间传递参数。用下面的代码替换前面对这三个参数的替换： 1234# Script Tool ParametersInputFeature = arcpy.GetParameterAsText(0)SingleRingWidth = arcpy.GetParameterAsText(1)OutputFeature = arcpy.GetParameterAsText(2) 对应的脚本工具参数配置： 为工具配置参数的时候，有2个原则需要遵守： 工具对话框中的参数顺序必须与脚本中的参数顺序一致。 每个脚本工具参数都有关联的数据类型。ArcGIS的地理处理不会将值发送给数据类型不正确的脚本，从这点上看，脚本工具比下一篇要说到的脚本工具箱多了一个优势，就是，在参数值发送给脚本之前会有数据类型检验。 修改Python脚本文件后，现在就运行工具，发现可以得到预期的结果： 但是有点不完美，就是在工具的运行过程中，工具给我返回的信息并不充足，我只知道 “Running Script EasyFeathering …”，而不了解工具在做什么，执行到了哪个步骤。这不是好的体验。 3 消息工具和用户之间的所有沟通均通过消息来实现。接着上一步提出的问题，如何在工具进度窗口中传递消息给用户？ 虽然在开始调试脚本的时候，如开头代码所示，我加了些 Print 语句，方便我了解自己的脚本独立执行时的状态，但是如果运行脚本工具，这些print语句是看不到的。可以使用 ArcPy中提供的有关消息的函数，AddMessage、AddWarning、AddError等向工具进度条界面发送消息。这里我做了个简单的步骤的消息性提示，以及，如果结果没有记录输出，会提示警告。 1234567891011121314151617181920212223242526272829303132333435363738394041__author__ = 'kikita'# FileName: EasyFeathering.pyimport arcpy#arcpy.env.workspace = \"D:\\IncidentSupport2015\\something\\Data.gdb\"# Get the input values from tool UIInputFeature = arcpy.GetParameterAsText(0)SingleRingWidth = arcpy.GetParameterAsText(1)OutputFeature = arcpy.GetParameterAsText(2)# Some Predefined Parametersdistances = []level = 9bufferUnit = \"meters\"NewField = \"Percent\"# My Easy Feathering functionfor i in range(level): distances.append(int(SingleRingWidth)*(i+1)) i = i+1arcpy.AddMessage(\"Step1 Distance list Complete!\")arcpy.MultipleRingBuffer_analysis(InputFeature, OutputFeature, distances, bufferUnit, \"\", \"ALL\",\"OUTSIDE_ONLY\")arcpy.AddMessage(\"Step2 Success to execute Multi Ring Buffer.\")arcpy.AddField_management(OutputFeature,NewField,\"double\")arcpy.AddMessage(\"Step3 Success to add Transparency Percent Field.\")arcpy.CalculateField_management(OutputFeature, NewField, \"!OBJECTID! *10\", \"PYTHON\", \"\")InputFeatureCount = int(arcpy.GetCount_management(OutputFeature).getOutput(0))if InputFeatureCount == 0: arcpy.AddWarning(\"&#123;0&#125; has no features.\".format(OutputFeature))else: arcpy.AddMessage(\"Step4 Success to Calculate Transparency Percent Field.\") 这样在工具的执行过程中，我就收到了消息： 到这里，工具的功能部分就完成了。 4 显示结果图层 我进一步希望脚本工具运行之后，自动显示在当前的地图文档中，从而避免重复设置透明度的操作。 为输出参数配置模板图层。 在处理设置中，激活设置 这样在运行工具之后，结果即自动添加显示。 5 配置路径如果是在本机使用脚本工具，一般我们会使用绝对路径，但是如果希望分享自己的工具给别人，就要考虑路径问题，也就是新用户运行脚本工具时，相关的脚本文件和其他用到的资源能否访问到。我的工具按照如下的结构组织： 在脚本工具的属性中，可以配置存储相对路径引用 py 文件： PS：但是不要想太多，这个设置仅仅会将脚本文件所在位置按照相对路径存储，而不会将脚本内部的路径进行转换。 这个示例中我还需要用到一个图层文件作为模板，如果希望使用相对路径使用，就建议将符号化信息写在脚本内部，而不是在参数窗口中配置。所以，要继续修改下Python脚本文件。 在脚本文件的最后追加两行代码，我这里将获取与Python脚本文件在相同目录下的lyr文件： 1234567# Layer files are located in same folder as the .py filePythonFilePath = os.path.dirname(__file__)params = arcpy.GetParameterInfo()params[2].symbology = os.path.join(PythonFilePath, \"FeatheringEffectTemplate.lyr\")# Pass message arcpy.AddMessage(\"Finding Feathering Effect Template Layer ...\" +\"/n\"+ os.path.join(PythonFilePath, \"FeatheringEffectTemplate.lyr\")) OK，路径的问题就解决了。 6 帮助文档还可以进一步为工具添加帮助文档，让更多的人了解如何使用这个工具。 在ArcCatalog 或者ArcMap的Catalog 中，在脚本工具上右键，点击 Item Description 菜单，点击 Edit 就可以对工具的帮助文档进行编辑。 这样当别人打开你的工具时，就看到帮助喽。 好啦，关于ArcGIS 中使用脚本工具的过程就说到这里。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Python","slug":"Python","permalink":"http://www.kikitamap.com/tags/Python/"},{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"在ArcGIS中创建Python工具（一）","slug":"CreatePythonTool1","date":"2015-08-31T07:16:01.000Z","updated":"2016-03-04T11:23:02.000Z","comments":true,"path":"2015/08/31/CreatePythonTool1/","link":"","permalink":"http://www.kikitamap.com/2015/08/31/CreatePythonTool1/","excerpt":"","text":"ArcGIS Desktop 自带有大量的工具，可以执行各种各样的地理处理任务。通过 python 我们可以灵活地调用这些工具，把工具组织成自己的工作流，甚至创建一些新的工具。今天就说说在 ArcGIS 中创建 Python工具这个话题。 在 ArcGIS 中我们可以通过两种方式来创建python工具： 一种是在标准工具箱下创建 脚本工具: 一种是创建 脚本工具箱： 到这里，可能你会有和我一样的疑问，二者有什么区别？ 第一种 脚本工具 需要我们首先在 ArcGIS 环境中创建一个工具箱，然后添加 Python脚本文件（*.py），并通过向导来精确配置参数。这种工具很适合脚本工具的初学者，通过前面说的三步就可以搭建出一个自定义工具。但是这种模式也有一些缺点，工具箱和源脚本是分离的，我们很难集中的去管理和维护它们。 相比于前者的难以集中管理的缺点，第二种的 Python工具箱 就体现出了它的优势。在 Python 工具箱中，参数定义、代码验证和源代码都在同一位置进行处理，因此Python 工具的创建和维护更加容易。此外，Python 工具箱支持脚本工具不支持的功能，例如值表、复合数据类型和自定义许可检查。 Python 工具箱是在 ArcGIS 10.1 之后的版本出现的。如果你熟悉 Python，就可以充分利用所掌握的 Python 技能来创建 Python 工具箱。 下面是一些更加具体的对比列表：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Python","slug":"Python","permalink":"http://www.kikitamap.com/tags/Python/"},{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"蜂巢网格","slug":"Hexagon","date":"2015-08-07T10:01:07.000Z","updated":"2016-03-04T11:28:56.000Z","comments":true,"path":"2015/08/07/Hexagon/","link":"","permalink":"http://www.kikitamap.com/2015/08/07/Hexagon/","excerpt":"","text":"比起死板硬朗的矩形渔网，六边形的蜂巢网格越来越受欢迎。推荐个小工具，实现下面的效果： 1.准备自己的兴趣区域和需要统计的要素。例如，下面的美国国境面（浅灰色），机场点数据。 2.ArcGIS Online上有 GISers 分享的生产六边形格网的工具： ModelBuilder版本的 Create Hexagon Tessellation Python版本的 Create Hexagons 我就以第一个工具为例，运行状态打开： 如果有关心工具内部的同学，编辑状态下看看工具： 运行之后，得到布满兴趣区域的蜂巢格网： 3.统计每个六边形内有多少座机场（多少个点），统计是ArcMap的强项。这里我就使用 Spatial Join 工具实现，其中我只保留有连接要素的目标要素，也就是仅保留有机场点的六边形。 4.上一步自动统计得到六边形包含的机场的数目 Join_Count 字段，那我们就根据它渲染起来。 再放个ArcGIS Online 的web map，作者也是用到了六边形网格，来看看。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Mapping","slug":"Mapping","permalink":"http://www.kikitamap.com/tags/Mapping/"}]},{"title":"凹凸有致的地图——浮雕风","slug":"ChoroplethHillshade","date":"2015-08-07T06:13:37.000Z","updated":"2016-03-04T11:31:10.000Z","comments":true,"path":"2015/08/07/ChoroplethHillshade/","link":"","permalink":"http://www.kikitamap.com/2015/08/07/ChoroplethHillshade/","excerpt":"","text":"想要下面这样一副地图，怎么做？ 1.准备包含一个数值属性字段的面数据，比如包含人口信息的欧洲大陆数据，使用分级色带渲染。 2.使用 Choropleth Hillshade 工具制造“浮雕”栅格。感谢作者jwasil的分享，这个工具可以在Github上自取：点这里。 3.给矢量面图层设置30%的透明，完成。 Maps we love 中也有一个web map，就是使用这个工具做的，来看看。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Mapping","slug":"Mapping","permalink":"http://www.kikitamap.com/tags/Mapping/"}]},{"title":"上传代码到PyPI","slug":"UploadCodetoPyPI","date":"2015-07-09T06:26:05.000Z","updated":"2016-03-04T11:33:50.000Z","comments":true,"path":"2015/07/09/UploadCodetoPyPI/","link":"","permalink":"http://www.kikitamap.com/2015/07/09/UploadCodetoPyPI/","excerpt":"","text":"我们可以把自己的代码，尤其是期待分享的得意代码，上传分享到第三方Python模块的“集中营” —— PyPI，如果没有账号，可以注册个先。 1 准备发布像在本地发布安装一样，先新建一个文件夹，然后将自己的py文件放进去，然后再这个文件夹中创建一个 setup.py 的文件，内容如下面的样子： 123456789101112from distutils.core import setupsetup( name='nesterprint', version='1.0.0', packages=[''], url='http://blog.csdn.net/kikitaMoon', license='', author='kikita', author_email='kikitamoopn@gmail.com', description='My Test') 2 注册登录使用命令行窗口，跳转到要发布的py所在的文件夹目录，首先进行注册登录，让命令行上传工具知道我的PyPI账户和密码。输入命令：python setup.py register，选择 1，输入账户和密码，并且保存登录信息，下次上传可以跳过这个步骤。 3 上传发布接着在命令行窗口中，输入命令： python setup.py sdist upload： 看到 OK 即上传成功。到 PyPI 自己的账户下看看吧。 Bingo ~ 4 更新模块当我们修改了模块中的代码，并想更新 PyPI 上的模块，那就在上传之前更改下 setup.py 的 version 参数，告诉 PyPI 这是个新的版本。 并使用相同的命令来上传新的发布版本。 好了，看看 PyPI，两个版本的模块都在，其中旧的版本默认被隐藏。 我们可以下载最新版本直接解压安装使用。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Python","slug":"Python","permalink":"http://www.kikitamap.com/tags/Python/"}]},{"title":"发布和安装python自定义模块","slug":"SetupPythonModule","date":"2015-07-09T05:00:00.000Z","updated":"2016-03-07T02:41:12.000Z","comments":true,"path":"2015/07/09/SetupPythonModule/","link":"","permalink":"http://www.kikitamap.com/2015/07/09/SetupPythonModule/","excerpt":"","text":"这一篇说下如何发布和安装python自定义模块，版本：Python 2.7 。 1.创建setup.py现在如果已经写好一个python文件，为了尽量简明，创建一个新的文件夹，把自己py文件放进去。接着在这个文件夹中创建一个名为 setup.py 的文件，用来表示模块的元数据，文件的内容类似下面这个样子。除了手工创建，有很多python编辑器也可以更简便的来创建这个文件，例如 pycharm。 123456789101112from distutils.core import setupsetup( name='nesterprint', version='1.0.0', packages=[''], url='http://blog.csdn.net/kikitaMoon', license='', author='kikita', author_email='kikitamoopn@gmail.com', description='My Test') 2. 打包发布使用Window自带的命令窗口，转到上一步创建的文件夹目录，输入命令，python setup.py sdist： 通过上面的状态信息知道，产生了下面的结果： 3. 安装在命令窗口输入命令： python setup.py install 安装命令也会产生额外的目录，build/lib 。 4. 导入模块import nesterprint ，导入这个自定模块，开始使用其中的myprint函数吧。 PS:这一篇重在发布安装模块的流程，模块内部脚本没提及，在前一篇的最后Demo中有写，可以参考，但是这真的不是重点。 5. 升级模块如果我们想升级模块，可以不？ 可以！ 更新了nesterprint.py 中的一些代码，改进了功能后，来升级下模块。到 setup.py 文件中修改下版本信息，我就叫他2.0.0 。 用 2， 3 两步一样的方法发布安装就好了。 试验一下： nesterprint 的功能已经升级到 2.0 版本了。 what’s new？ 增加了根据列表的深度自动缩进的功能。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Python","slug":"Python","permalink":"http://www.kikitamap.com/tags/Python/"}]},{"title":"Python列表常用操作","slug":"PythonList","date":"2015-07-07T09:49:58.000Z","updated":"2016-03-07T02:41:32.000Z","comments":true,"path":"2015/07/07/PythonList/","link":"","permalink":"http://www.kikitamap.com/2015/07/07/PythonList/","excerpt":"","text":"Python的列表非常好用，一些常用的操作写在这里。 在Python中创建一个列表时，解释器会在内存中创建一个类似数组（但不是数组）的数据结构来存储数据。列表中的编号从 0 开始，然后是1，依此类推。 print() 显示列表； len() 得出列表中有多少数据项； append() 在列表末尾追加一个数据项； extend() 在列表末尾增加一个数据项集合； pop() 在列表末尾删除一个数据项； remove() 在列表中删除一个特定的数据项； insert() 在特定位置前面增加一个数据项； count() 统计某个数据项在列表中出现的次数； reverse() 反向列表中数据项。 12345678910111213141516171819202122232425262728293031323334353637&gt;&gt;&gt; Fruit = [\"Apple\",\"Pear\",\"Grape\",\"Peach\",\"Bananer\"]&gt;&gt;&gt; print(len(Fruit))5&gt;&gt;&gt; print(Fruit[0])Apple&gt;&gt;&gt; print(Fruit[4])Bananer&gt;&gt;&gt; Fruit.append(\"tomato\")&gt;&gt;&gt; print(Fruit)['Apple', 'Pear', 'Grape', 'Peach', 'Bananer', 'tomato']&gt;&gt;&gt; Fruit.extend([\"lemon\",\"coconut\"])&gt;&gt;&gt; print(Fruit)['Apple', 'Pear', 'Grape', 'Peach', 'Bananer', 'tomato', 'lemon', 'coconut']&gt;&gt;&gt; Fruit.pop()'coconut'&gt;&gt;&gt; print(Fruit)['Apple', 'Pear', 'Grape', 'Peach', 'Bananer', 'tomato', 'lemon']&gt;&gt;&gt; Fruit.remove(\"Peach\")&gt;&gt;&gt; print(Fruit)['Apple', 'Pear', 'Grape', 'Bananer', 'tomato', 'lemon']&gt;&gt;&gt; Fruit.remove(Fruit[0])&gt;&gt;&gt; print(Fruit)['Pear', 'Grape', 'Bananer', 'tomato', 'lemon']&gt;&gt;&gt; Fruit.insert(0,\"Apple\")&gt;&gt;&gt; print(Fruit)['Apple', 'Pear', 'Grape', 'Bananer', 'tomato', 'lemon']&gt;&gt;&gt; Fruit.insert(6,\"coconut\")&gt;&gt;&gt; print(Fruit)['Apple', 'Pear', 'Grape', 'Bananer', 'tomato', 'lemon', 'coconut']&gt;&gt;&gt; Fruit.count(\"Apple\")1 用迭代显示列表中的数据项，以下的代码段中 for 和 while 完成的工作是一样的： 12&gt;&gt;&gt; for item in Fruit: print(item) 123&gt;&gt;&gt; while count &lt; len(Fruit): print(Fruit[count]) count = count + 1 1234567# 输出结果Apple1Pear2Bananer3 如果字符串中需要包含双引号，不要忘记转义 ，\\”。 123&gt;&gt;&gt; Fruit.append(\"\\\"Tomato\\\"\")&gt;&gt;&gt; print(Fruit)['Apple', 1, 'Pear', 2, 'Bananer', 3, '\"Tomato\"'] isinstance() 函数可以用来判断特定标识符是否包含某个特定类型的数据。 12345&gt;&gt;&gt; isinstance(Fruit,list)True&gt;&gt;&gt; isinstance(count,list)False Python中列表可以嵌套，并且可以支持任意多层的嵌套，例如： 12345678910&gt;&gt;&gt; print(Fruit)['Apple', 1, 'Pear', 2, 'Bananer', 3]&gt;&gt;&gt; Fruit.append([\"A\",\"B\",\"C\"])&gt;&gt;&gt; print(Fruit)['Apple', 1, 'Pear', 2, 'Bananer', 3, '\"Tomato\"', ['A', 'B', 'C']]&gt;&gt;&gt; Fruit[-1].append([\"aa\",\"bb\",\"cc\"])&gt;&gt;&gt; print(Fruit)['Apple', 1, 'Pear', 2, 'Bananer', 3, '\"Tomato\"', ['A', 'B', 'C', ['aa', 'bb', 'cc']]] 1234567891011&gt;&gt;&gt; for i in Fruit: print(i) Apple1Pear2Bananer3\"Tomato\"['A', 'B', 'C', ['aa', 'bb', 'cc']] 试试输出三层嵌套的列表中的各个数据项： 12345678910111213141516171819202122232425&gt;&gt;&gt; for i in Fruit: if isinstance(i,list): for j in i: if isinstance(j,list): for k in j: print(k) else: print(j) else: print(i) Apple1Pear2Bananer3\"Tomato\"ABCaabbcc 上面的循环嵌入的有点多，如果是N层嵌套的列表重复代码会很多，来点优化试试： 12345678910111213141516171819202122&gt;&gt;&gt; def my_print(mylist): for i in mylist: if isinstance(i,list): my_print(i) else: print(i) &gt;&gt;&gt; my_print(Fruit)Apple1Pear2Bananer3\"Tomato\"ABCaabbcc 定义个递归函数实现，看起来好多了。 列表操作符部分，+表示列表组合，*表示列表重复： 1234567&gt;&gt;&gt; mylist = [1,2,3] + [4,5,6]&gt;&gt;&gt; print mylist[1, 2, 3, 4, 5, 6]&gt;&gt;&gt; mylist = mylist*4&gt;&gt;&gt; print(mylist)[1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6, 1, 2, 3, 4, 5, 6] 今天就写到这里吧。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Python","slug":"Python","permalink":"http://www.kikitamap.com/tags/Python/"}]},{"title":"ArcGIS地图设计性能优化","slug":"MapDesignPerformance","date":"2015-06-26T05:00:00.000Z","updated":"2016-03-07T02:27:12.000Z","comments":true,"path":"2015/06/26/MapDesignPerformance/","link":"","permalink":"http://www.kikitamap.com/2015/06/26/MapDesignPerformance/","excerpt":"","text":"制作一幅较高性能的地图检查如下方面是否注意到了 ？ 1 内容组织： · 空间参考/Spatial Reference在ArcMap中配置地图文档，要尽可能将所有数据与数据框使用相同的空间参考，特别是编辑或创建要提供服务的数据的时候。虽然ArcMap可以进行动态投影，但是这样做可以避免动态投影计算所造成的性能损耗。 对于不同空间参考的数据，可以使用工具 Project 进行转换。 · 连接与关联/Join &amp; Relate我们有时会通过Join表中的字段进行标注或符号化，也可能会通过Relate操作来执行查询等。然而，通过连接和关联访问数据可能会降低性能，需要执行额外的工作来维护连接。 对于需要使用Join过来的字段内容，可以考虑导出数据，获得包含连接字段的新要素类。 · 索引/Index这里说的索引包含空间索引和属性索引。空间索引在大多数情况下，ArcGIS 都会自动维护。如果遇到没有自动更新的情况，可以手动更新创建；如果数据源允许使用索引，则应为所有查询字段或渲染字段建立索引。 有关创建删除索引，ArcToolbox有个工具箱 Index可以找到需要的工具。 · 数据简化/Data Simplification如果需要使用小比例尺出图，无需展示非常详细细节，那就可以考虑简化、概化数据。如果将图层简化为具有更少的折点和线段，图层在小比例下将绘制得更快并且差别不大。此外，简化的数据可以提高查询和识别操作的性能。 需要的工具在工具箱也可以找到，例如：Simplify Polyline、Simplify Polygon。 · 底图图层/Basemap使用底图图层以优化绘制性能，底图图层支持本地硬盘缓存。我们可以把不经常更新的数据作为底图图层，例如衬托在业务数据下的数据图层、影像数据图层等。 如何配置地图图层不啰嗦，点这里看帮助 · 隐藏图层或要素通过设置图层属性中的可见比例尺范围（Scale Range）和定义查询（Query Defination）来避免绘制不必要的图层或者要素。 · 要素缓存/Feature CacheArcMap 要素缓存可以将 ArcMap 当前地图显示中的要素临时存储到本地计算机的内存中。由于从本地内存中检索要素是一个非常快的操作，因此使用要素缓存通常可以提高性能。例如：绘制较大或复杂的数据集；标注、编辑和选择要素；为地图上的多个图层检索相同的要素；使用定义查询来绘制要素。 · 栅格数据金字塔/Pyramid改善和缩短显示大型栅格数据集时间的最好方法是创建金字塔，目的在于提高显示速度及降低 CPU 使用率。ArcMap 使用合适的分辨率等级来快速绘制整个数据集。如果不使用金字塔，则必须从磁盘中读取整个数据集，然后将其重采样为更精细的大小。对于镶嵌数据集需要创建概视图（Overview）。 · 布局视图/Layout需要打印输出时，查看一下布局视图的数据框的边界。圆角拐角、背景和阴影会降低性能。消除这些影响并将这些属性设置为方形拐角可以提高布局视图中数据框的绘制性能。 2 地图符号 · 标记符号/Marker Symbol尽可能使用简单样式标记，避免使用多层符号。 使用图片标记符号来代替晕圈。 尽可能使用简单形状。 将标记符号的大小属性设置为小于 60 磅。 尽可能不使用图片标记符号，特别是数据量较大的时候。当标记符号只有一种颜色时，.emf 文件所提供的性能要好于 .bmp、.png 或 .jpg/.jpeg 文件。但是，当标记符号有两种或更多种颜色时，.png 文件是性能更好的格式。 · 线符号/Line Symbol如果要减少显示时间，简单线符号是最好的选择；制图线作为最常用的线符号，在使用更多选项时绘制得相对缓慢一些。 使用多图层符号时，请避免将不同的符号类型混合在一起。 谨慎使用偏移或虚线样式，因为它们会增加绘制时间。 宽线和带有整饰的线（例如标记和箭头）绘制起来较慢。 · 面符号/Fill Symbol对面进行符号化处理时，没有轮廓的简单填充符号将绘制得最快。 需要在面周围加上轮廓时，应尽量选择简单线符号，其他的线类型（例如制图线、标记线和混列线）会显著增加绘制时间。 与其他符号相同，使用尽可能少的图层来构成填充符号。 特别是带有掩膜图层的点密度填充符号绘制起来更慢，因此应尽量避免使用这种填充符号。 使用线填充符号时，无论是填充还是轮廓，尽量使用简单线。 当图片填充符号只有一种颜色时，.emf 文件所提供的性能要好于 .bmp、.png, 或.jpg/.jpeg 文件。但是，当标记符号有两种或更多种颜色时，.png 文件是性能更好的格式。 3 地图文本 · 通用文本符号与其他类型的符号一样，ArcMap 需要做出的处理决策越少，地图的绘制速度就越快。一般来说，使用注记代替标注可以提高性能。 尽可能地减小文本的大小。非常大的文本符号（例如那些大于 60 磅的文本符号）会增加绘制时间。 符号越复杂，绘制速度越慢。因此，应尽可能少使用文本效果（例如，注释、牵引线、偏移、晕圈、背景和填充方式）。 在文本周围使用阴影，不使用晕圈或掩膜。 · 标注尽可能简化 SQL 查询和标注放置要求。如果标注文本存储在图层属性表中的单个字段中，绘制标注将非常快。 标注表达式会减慢绘制速度。尽可能避免在绘制时使用标注表达式脚本进行条件判断，或格式化标注字符串，或将多个字段值串连到一个标注字符串中。 尽量为 SQL 查询中的字段建立索引。 谨慎使用标注和要素冲突权重。 直线型标注的绘制速度要快于曲线型标注。 设置标注的显示比例尺范围。地图被缩小时，需要绘制更多的标注，而这需要时间。检查某些标注在较小的比例下是否需要绘制。 “Maplex 标注引擎”拥有比“标准标注引擎”更多的标注放置选项。高级放置决策可能会影响性能。 · 注记使用 ArcMap 创建注记时，可以存储在地图文档的注记组中，或存储在Geodatabase的注记要素类中。 一般情况下，应该将注记存储在地理数据库中，因为相比地图文档注记，ArcMap 可以更快地访问和显示地理数据库注记。这是推荐的方式。 如果要创建一张地图并且注记文本只应用到当前地图上，那么可以将文本存储到地图文档的一个或多个注记组中。这种情况很少。如果删除了地图，则该注记也被删除，因为其存储在地图文档中。另外，每个添加到注记组的注记都会增大地图文档文件 (.mxd) 的大小。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Mapping","slug":"Mapping","permalink":"http://www.kikitamap.com/tags/Mapping/"}]},{"title":"在Linux上安装ArcGIS许可管理器备忘录","slug":"DeployAGSLMonLinux","date":"2015-06-10T05:00:00.000Z","updated":"2016-03-07T03:10:00.000Z","comments":true,"path":"2015/06/10/DeployAGSLMonLinux/","link":"","permalink":"http://www.kikitamap.com/2015/06/10/DeployAGSLMonLinux/","excerpt":"","text":"这篇文章中使用的环境信息： Red Hat Enterprise Linux Server release 6.4Red Hat Enterprise Linux Server release 5.8ArcGIS License Manager 10.2.2Xmanager 5 ★ 安装之前一定要了解系统要求，这一步很重要，这里不啰嗦，详情点 [这里](http://resources.arcgis.com/en/help/system-requirements/10.2/#/ArcGIS_10_2_for_Desktop/015100000002000000/)。 1. 准备安装文件我的Linux服务器是虚拟机，没有光驱，选择ftp上传安装文件。一般在各种linux的发行版中，默认带有的ftp软件是vsftp。 检查vsftpd软件是否安装， # rpm -qa|grep vsftp启动 vsftp 服务，# service vsftpd start 使用ftp客户端上传 ArcGIS License Manager （LM）安装包。如果上传的 iso 镜像文件之后使用 mount 命令挂载，其实也可以仅将光盘中 LicenseManager 目录下的 linux 文件夹上传，此文件夹为 LM 的Linux安装包。 包含如下几个文件（夹）： 2. 创建账户ArcGIS License Manager 不允许 root 账户安装，因此要创建一个其它账户，例如：arcgis PS : 如果使用 root 账户直接安装，则会遇到错误提示： 3. 创建 Trusted Storage目录并赋权在安装 ArcGIS License Manager 之前，需要手动创建用于存储许可 Trusted Storage File (TSF) 的目录，具体目录为：“/usr/local/share/macrovision/storage” 创建目录： 为目录赋权： 如果不创建这个目录而直接安装 LM 程序，就会遇到 Fatal Error 提示： 4. 安装 ArcGIS License Manager 有图形界面模式和静默模式两种安装模式，建议选择前者： Option 1 图形界面安装安装 ArcGIS License Manager 需要 X Windows Display的支持来进行图形界面的交互。尽管我们可以选择使用静默安装和静默授权，但是在许可管理过程中，还是会用到图形界面。强烈建议安装个 Xmanager，来连接Linux主机。 设置DISPLAY环境变量 :例如： $ export DISPLAY=192.168.100.115:0.0 运行 Setup 文件开始安装，建议使用精细模式（Verbose Mode），这样如果安装失败，我们可以通过运行过程中的消息判断问题的所在。例如，没有创建必要的目录，没有安装必要地包，没有足够的权限，等等问题。 $ ./Setup -v 稍等片刻，即弹出界面： 后面按照向导，下一步即可，此处省略100字…… Option 2 静默安装如果选择静默安装也可以，例如： $ ./Setup -m silent -v -l Yes 如果需要了解安装ArcGIS 许可管理器的选项： -m silent/gui 静默安装/图形界面-v 精细模式-h 帮助-e 示例静默安装专用选项：-l Yes/No 是否同意许可条款-d 安装目录 5. 授权许可LM安装完成之后，需要进行许可的授权，事先将自己的许可文件 *.prvs 上传到Linux主机中。 仍然建议GUI mode 授权，运行LM安装目录中的 SoftwareAuthorizationLS 程序： 稍后弹出界面： 后面按照向导，下一步即可，可以参考windows的授权手册，此处省略100字…… 运行 LSAdmin 程序可以打开 License Manger ，查看和管理许可。 相关资源整理FAQ: What are the best practices when installing and troubleshooting Esri software on Linux? http://support.esri.com/em/knowledgebase/techarticles/detail/42921 HowTo: Silently authorize ArcGIS License Manager 10.x on Linux http://support.esri.com/es/knowledgebase/techarticles/detail/38412","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"License","slug":"License","permalink":"http://www.kikitamap.com/tags/License/"},{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"},{"name":"Linux","slug":"Linux","permalink":"http://www.kikitamap.com/tags/Linux/"}]},{"title":"羽化效果的HeatMap","slug":"FeatureHeatMap","date":"2015-06-09T03:07:58.000Z","updated":"2016-03-07T02:55:26.000Z","comments":true,"path":"2015/06/09/FeatureHeatMap/","link":"","permalink":"http://www.kikitamap.com/2015/06/09/FeatureHeatMap/","excerpt":"","text":"用采样点制作热力图是个非常常见的需求。热力图可以给地图的阅读者直观的信息，下面就看看如何在 ArcGIS Pro 中做一个漂亮的HeatMap。 1.准备好采样点数据，当然是量大更优。我这里用了全球地震点数据，大约有 21W+ 的数据量。像这一类的数据可以从一些提供公开数据的网站获取，例如 USGS 。 2.使用 ArcGIS 中的密度分析工具可以从点数据直接生成密度栅格，工具位于 ArcToolbox —— Spatial Analyst —— Density 工具集下。这里我采用了 Kernel Density 。 3.制作一个自己喜欢的热力色带，最边缘的颜色使用透明色，这样就有“羽化”的效果。 应用色带之后： 如有需要，可以进一步为图层设置透明：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Mapping","slug":"Mapping","permalink":"http://www.kikitamap.com/tags/Mapping/"},{"name":"ArcGIS Pro","slug":"ArcGIS-Pro","permalink":"http://www.kikitamap.com/tags/ArcGIS-Pro/"}]},{"title":"为Runner做一张有质感的图","slug":"RunnerRoutes","date":"2015-06-05T02:52:33.000Z","updated":"2016-03-07T02:55:54.000Z","comments":true,"path":"2015/06/05/RunnerRoutes/","link":"","permalink":"http://www.kikitamap.com/2015/06/05/RunnerRoutes/","excerpt":"","text":"如今，通过 GPS 我们可以轻松采集到自己的足迹，Runner们用各种手机App记录跑步路线也再平常不过。如果我们有大量的足迹信息，也可以试试 ArcGIS Pro 的渲染能力，来看看自己的 Favourite 线路如何分布。 我在 ArcGIS Online 上 down 到了某位 Runner 的足迹信息，当然大家也可以用自己的，gpx，txt，kml 等常见的 GPS Tracklog 文件都是可以直接导入成为 ArcGIS 支持的格式。根据文件格式的不同，你可能会需要 GPX to Feature ， Add XY Event layer， KML to Layer ，Points to Line 等这些工具的辅助，得到路线数据，表示路线的线数据当然越多越好。 ArcGIS Pro 的符号化中增加了符号的透明效果，这一点完胜 ArcMap 的渲染效果。你想问ArcMap什么效果？如下，好像有点惨不忍睹： 由于ArcGIS Pro 中的新增的符号透明不是图层的整体透明，而是每个Feature的符号透明，就会产生色彩叠加的效果。直观上说，就是符号叠加越密集的位置，色彩会越深，给人以渐变色彩的热力图的感受。 #怎么做？ ##1.加入数据，GPS路线数据和深灰色主题的底图服务。 ##2. 选个喜欢的颜色，并进入 more。 ##3. 设置个透明百分比。 ##4. Done ! 无需任何高级的分析，所见即所得。相比周围，明显这条路是这位 Runner 最经常挥洒汗水的一条……","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Mapping","slug":"Mapping","permalink":"http://www.kikitamap.com/tags/Mapping/"},{"name":"ArcGIS Pro","slug":"ArcGIS-Pro","permalink":"http://www.kikitamap.com/tags/ArcGIS-Pro/"}]},{"title":"Web Mercator 公开的小秘密","slug":"SecretofWebMercator","date":"2015-05-29T01:44:56.000Z","updated":"2016-03-21T07:22:30.933Z","comments":true,"path":"2015/05/29/SecretofWebMercator/","link":"","permalink":"http://www.kikitamap.com/2015/05/29/SecretofWebMercator/","excerpt":"","text":"网上已经有好多作者都不吝笔墨，写了好多有关 Web Mercator这个坐标系的前世今生。多搜罗多摄入，我们会得到很多有用的信息。今天讨论到 3758，3857，102100，900913…… 这些ID又一石激起千层浪，看来整理总结下还是有点必要。 Web Mercator 如何定义？ 我们知道，地理数据的坐标系一般有两大类，一是地理坐标系(GCS)，是经纬度单位的椭球坐标系；二是投影坐标系(PCS)，是平面直角坐标系。 投影坐标系（PCS）的定义一般会包含两方面的定义信息：（1）基准面/Datum — 与GCS相应（2）投影方法/Projection Method 1Web Mercator 是一个投影坐标系统，其基准面是 WGS 1984 。 那么，第一个问题，WGS 1984 是什么？ “ 世界大地坐标系是美国国防部制图局（Defence Mapping Agency， DMA）为统一世界大地坐标系统，实现全球测量标准的一致性，定义用于制图、大地、导航的坐标基准。它包括标准地球坐标框架、用于处理原始观测数据的标准椭球参考面（即基准和参考椭球）和定义标准海平面的重力等势面（大地水准面）。……”（摘自《大地坐标系统及其应用》） 在上面一段中可以知道，定义一个坐标系绝对是一个复杂浩大的数学工程。 我们经常听说的 WGS 1984 （或 WGS 84）就是其中一个世界大地坐标系统。我们经常使用的 GPS 的坐标参考系统也是它。 WGS 1984 的具体定义参数： GCS_WGS_1984WKID: 4326 Authority: EPSG Angular Unit: Degree (0.0174532925199433)Prime Meridian: Greenwich (0.0)Datum: D_WGS_1984 Spheroid: WGS_1984 Semimajor Axis: 6378137.0 Semiminor Axis: 6356752.314245179 Inverse Flattening: 298.257223563 通过参数描述，我们知道 WGS 1984 是一个长半轴(a)为6378137，短半轴（b）为6356752.314245179 的椭球体，扁率(f)为298.257223563，f=(a-b)/a 。 2Web Mercator 坐标系使用的投影方法不是严格意义的墨卡托投影，而是一个被 EPSG（European Petroleum Survey Group）称为伪墨卡托的投影方法，这个伪墨卡托投影方法的大名是 Popular Visualization Pseudo Mercator，PVPM。 看起来就觉得这个投影方法不是很严谨的样子，大众化的？受欢迎的？可视化伪墨卡托投影…… 因为这个坐标系统是 Google Map 最先使用的，或者更确切地说，是Google 最先发明的。在投影过程中，将表示地球的参考椭球体近似的作为正球体处理（正球体半径 R = 椭球体半长轴 a）。这也是为什么在 ArcGIS 中我们经常看到这个坐标系叫 WGS 1984 Web Mercator (Auxiliary Sphere)。Auxiliary Sphere 就是在告知你，这个坐标在投影过程中，将椭球体近似为正球体做投影变换，虽然基准面是WGS 1984 椭球面。 后来，Web Mercator 在 Web 地图领域被广泛使用，这个坐标系就名声大噪。尽管这个坐标系由于精度问题一度不被GIS专业人士接受，但最终 EPSG 还是给了 WKID:3857。 下面放一张在 EPSG 官网上找到的3857坐标的具体参数介绍，供参考： Web Mercator 的阴暗面 Web Mercator 无论是来自Google程序员的谬误，还是为了简化换算的有意为之，现在它都已经名正言顺的成为了 Web 底图的最受欢迎平面坐标系。 问题又来了，为什么这么受欢迎的坐标系还会受到GIS大咖的诟病？ 拒绝给这个坐标系分配 坐标系ID 的原话是这样的： “ The projected coordinate reference system originally lacked an official spatial reference identifier (SRID), and the Geodesy subcommittee of the OGP’s Geomatics committee (also known as EPSG) refused to provide it with one, declaring “We have reviewed the coordinate reference system used by Microsoft, Google, etc. and believe that it is technically flawed. We will not devalue the EPSG dataset by including such inappropriate geodesy and cartography.” ” 这不是EPSG 冷酷无情无理取闹，从技术角度看是有原因的。简而言之，主要原因在于基准面被篡改后，本来是等角投影的Mercator坐标变换算法，不再等角了，而是近似等角，也就是出现角度变形。这种变形势必影响了坐标的精度，如下是某位GIS专家给出的概要说明（闪亮的最后一条）： 如果你想进一步关心细节，想知道这位专家对 Web Mercator 的 dark side 的深入见解，点这里看看。 不再混乱的 ID 也是由于GIS专业人士的质疑，这个坐标系的ID经历了曲折的过程，好多做Web开发的朋友都感到困惑。简单地顺一下： OpenLayers:900913 由于得不到官方的认证ID，Google为Web Mercator 任性地制定了这个ID，自娱自乐，也祝大家玩的开心……下面可不是我编的。 i think 900913 is great.9-g0-o0-o9-g1-l3-eget it? 900913 is equal to google. THAT’S AMAZING ! =-) EPSG:3785 这是 EPSG 在 2008 年给 Web Mercator 设立的WKID，但是这个坐标系的基准面是正圆球，不是WGS 1984。 存在了一段时间后被弃用。 EPSG:3857 EPSG为 Web Wercator 最终设立的WKID，也就是现在我们常用的Web 地图的坐标系，并且给定官方命名 “WGS 84 / Pseudo-Mercator“。 ESRI:102113 Esri内部使用ID，与 EPSG:3785 相应。已被弃用。 ESRI:102100 Esri内部使用ID，与 EPSG:3857 相应。 因此，细心地话，会发现在 ArcGIS Server 的REST 服务页面中，Web Mercator 的空间参考会记做： 102100(3857) 这些东西其实一直都是公开的，博主没有生产这些小秘密，只是小秘密的搬运工。 我把自己看过的资源放在下面，共享之，文中提到的已经做链接了地，下面就不重复列举： http://en.wikipedia.org/wiki/Web_Mercator http://blogs.esri.com/esri/arcgis/2014/09/25/what-does-the-nga-web-mercator-advisory-mean-for-esri-defense-and-intelligence-users/ http://blogs.esri.com/esri/arcgis/2012/03/05/mercators-500th-birthday/ http://www.sharpgis.net/post/2008/05/15/SphericalWeb-Mercator-EPSG-code-3785 http://crschmidt.net/blog/archives/243/google-projection-900913/ http://forums.esri.com/Thread.asp?c=93&amp;f=984&amp;t=288607","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Coordinate System","slug":"Coordinate-System","permalink":"http://www.kikitamap.com/tags/Coordinate-System/"}]},{"title":"Linux下安装绿色版Oracle客户端备忘录","slug":"LinuxOracleClient","date":"2015-05-26T04:40:27.000Z","updated":"2016-03-07T03:15:02.000Z","comments":true,"path":"2015/05/26/LinuxOracleClient/","link":"","permalink":"http://www.kikitamap.com/2015/05/26/LinuxOracleClient/","excerpt":"","text":"环境及版本信息：远程服务器- Redhat 6.4；Oracle 11g x64； ArcGIS Server 10.2；本地机器- Windows 8.1 开始安装 12c 和 11g 的客户端，总是不满足系统需求，各种提示缺包，所以还是使用绿色版省心点。 1将Oracle绿色版客户端安装文件上传到 Linux 服务器（oracle-instantclient11.2-basic-11.2.0.1.0-1.x86_64.zip） ，并解压到自己指定的目录，如 Client。 2由于安装Oracle客户端的目的是为了 ArcGIS Server 能够访问数据库服务器，所以对Client目录赋予 ArcGIS Server 账户（arcgis）的755权限。 3修改环境变量，使得ArcGIS Server 能够使用这个客户端。 环境变量文件位于ArcGIS Server 安装目录中 usr文件夹下的 init_user_param.sh 。 编辑init_user_param.sh，将Oracle客户端所在的目录配置到对应的环境变量中，保存退出。PS，不要忘记删除前面的＃…… 默认所有的变量信息是被注释掉的。 4重启 ArcGIS Server 服务。 5然后到 ArcGIS Server Manger中或者 ArcGIS Desktop 的 Server Connection中去注册数据库试试。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"},{"name":"Linux","slug":"Linux","permalink":"http://www.kikitamap.com/tags/Linux/"}]},{"title":"解决Linux系统中缺少Xvfb包的问题","slug":"LackofPackonLinux","date":"2015-05-08T13:19:05.000Z","updated":"2016-03-07T03:22:58.000Z","comments":true,"path":"2015/05/08/LackofPackonLinux/","link":"","permalink":"http://www.kikitamap.com/2015/05/08/LackofPackonLinux/","excerpt":"","text":"上一篇文中写了在 Linux上安装 ArcGIS Server前的准备工作，最后一步是环境检测，只有所有项都通过才可以安装 ArcGIS Server。 不幸的是，第一次其实没有通过环境监测，提示系统中缺少了Xvfb包，具体的检测结果如下： 检测报告中提示了解决方法，参考技术文章 40860： 但是这篇文章只告诉我们缺包了，需要安装一个Xvfb包，没有说明包的获取与安装过程等，下面我就bala一下喽。 1 . 下载Xvfb包到主机用 wget 命令下载xorg-x11-server-Xvfb-1.10.4-6.el6.x86_64.rpm包到主机。 wget http://vault.centos.org/6.2/os/x86_64/Packages/xorg-x11-server-Xvfb-1.10.4-6.el6.x86_64.rpm 2 . 运行安装Xvfb包 yum localinstall xorg-x11-server-Xvfb-1.10.4-6.el6.x86_64.rpm 3 . 执行环境检测所有检测通过即可安装 ArcGIS Server 程序：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"},{"name":"Linux","slug":"Linux","permalink":"http://www.kikitamap.com/tags/Linux/"}]},{"title":"Linux 下安装 ArcGIS Server 前的准备工作备忘录","slug":"LinuxArcGISServerDeployment","date":"2015-05-08T08:55:01.000Z","updated":"2016-03-07T03:43:02.000Z","comments":true,"path":"2015/05/08/LinuxArcGISServerDeployment/","link":"","permalink":"http://www.kikitamap.com/2015/05/08/LinuxArcGISServerDeployment/","excerpt":"","text":"安装环境： ArcGIS for Server Linux 10.2.2 ， Redhat 6 因为是在网络虚拟机中安装部署，首先需要一个远程Linux的客户端，这里使用 putty，可以在官方的 www.putty.org 下载，但是貌似网站被墙了，我也放了一份在我的资源中。 1） 运行 putty.exe ,登陆linux服务器： 2） 输入用户名密码，登入服务器： 3） 查询主机的 IP 地址： 4） 查询 hostname： 5） 编辑hosts文件，映射IP地址和主机名： 6） 创建 ArcGIS Server 账户： 备注：/etc/group 中存储了用户组信息，格式如下：用户组名:组密码:GID:组内帐号（多个帐号用逗号分隔）/etc/passwd 中存储了用户账户信息，格式如下：用户名:密码:UID:GID:用户信息:HOME目录路径:用户shell其中UID为0则是用户root，1～499为系统用户，500以上为普通用户 7） 为ArcGIS Server 账户设置密码： 8）在home目录下创建ArcGISServer目录，授权 ArcGIS Server账户对文件夹的权限： 9）文件句柄和进程的硬限制要求 要增加软限制和硬限制，需要使用超级用户访问权限编辑 /etc/security/limits.conf 文件。例如，添加以下四行： 10） 将安装程序上传到Linux主机 Linux主机是个网络虚拟机，也没有光驱，就用上传安装包（iso镜像）的方式安装了。一般在各种linux的发行版中，默认带有的ftp软件是vsftp。 检查vsftpd软件是否安装， # rpm -qa|grep vsftp 启动 vsftp 服务，# service vsftpd start 其它命令： 停止ftp：service vsftpd stop 重启ftp：service vsftpd restart 软后用ftp客户端连接服务器即可，这里我用了以前一直用的 FileZilla. 11） 挂载 ISO映像 PS：第一次mount没写完整的路径信息，文件没找到，请忽略，看最后一行。 12）执行安装前的环境检测 各项检测通过，可以安装 ArcGIS Server 了。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"},{"name":"Linux","slug":"Linux","permalink":"http://www.kikitamap.com/tags/Linux/"}]},{"title":"ASCII 栅格的显示","slug":"MappingASCIIRaster","date":"2015-04-21T10:25:39.000Z","updated":"2016-03-07T03:54:50.000Z","comments":true,"path":"2015/04/21/MappingASCIIRaster/","link":"","permalink":"http://www.kikitamap.com/2015/04/21/MappingASCIIRaster/","excerpt":"","text":"今天刚好有人问到一个有关 ASCII 栅格数据的问题，这里梳理下，用最简单的方式极速理解。 什么是ASCII栅格？ 就是用ASCII文本记录的栅格数据…… 怎么得到ASCII栅格？ 比如使用工具 Raster to ASCII…… 一般在 ASCII 栅格的文件头中我们会看到这几行： ncols 和 nrows 表示这份数据的行列数，这份数据是10×10。 xllcorner 和 yllcorner 表示的就是栅格的左下角（low left）角点的坐标。 cellsize 也就是像元大小，表示每个正方形单元的尺寸。 通过这几个值不就确定了栅格数据的范围了吗？嗯，确定了。 看图说话： 文本文件下面的值就对应到每个格子里的像元值： 我想你不会再有any疑问了……","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"ArcGIS Editor for OSM, 10.3.x Desktop","slug":"ArcGISEditorforOSM103xDesktop","date":"2015-04-01T06:32:13.000Z","updated":"2016-03-07T03:56:14.000Z","comments":true,"path":"2015/04/01/ArcGISEditorforOSM103xDesktop/","link":"","permalink":"http://www.kikitamap.com/2015/04/01/ArcGISEditorforOSM103xDesktop/","excerpt":"","text":"对于好多地图爱好者，由于保（众）密（所）严（周）格（知），获取高精度的数据不是个容易事，幸亏有了可爱的 OpenStreetMap 。 ArcGIS Editor for OpenStreetMap 是一个免费开源的 ArcGIS Desktop 插件。上个月Esri官网提供可用于Desktop 10.3 的最新版本插件。 下载页面：ArcGIS Editor for OSM, 10.3.x Desktop 相关资源自取：点这里 下载之后，有32位和64位两个安装包，如果你安装了Desktop的64位后台GP补丁，就把64位的插件程序也安装上。 ArcToolbox中多了好多工具…… 这里我就推荐两个最常用的工具。 Download OSM Data 下载的范围，可以通过手工填写坐标指定，也可以根据ArcMap现有的图层范围进行指定，这个方便又好用。 Load OSM Data 如果你已经从 OpenStreetMap 下载了 *.osm 数据文件，那就用这个工具导入 GDB 即可。简单到没什么可说的，请看图。 有个关键问题，注意： How much of the OSM data can I download? The ArcGIS Editor for OpenStreetMap uses the OpenStreetMap API, which limits downloads to an area of 0.5 by 0.5 degrees or 50,000 nodes, whichever is reached first. This is usually more than enough to fill an area for editing.","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"空间统计（五）诊断回归分析结果","slug":"RegressionAnalysisResult","date":"2015-03-31T06:52:06.000Z","updated":"2016-03-07T04:41:10.000Z","comments":true,"path":"2015/03/31/RegressionAnalysisResult/","link":"","permalink":"http://www.kikitamap.com/2015/03/31/RegressionAnalysisResult/","excerpt":"","text":"为了理解、解释、预测某个问题，我们会进行回归分析。上一篇中提到了回归模型中的因变量和解释变量的概念，用一组解释变量来建模解释因变量，但事实上，选择一组优质的解释变量并不是那么容易。通常我们会根据一些常识、理论基础、某些研究、专家的意见、参考文献等等选择一组解释变量，来进行解释变量的筛选。在ArcGIS Desktop中，当我们使用 普通最小二乘法（OLS）执行回归分析的时候，工具会进行诊断测试，提供一个汇总报告，帮助我们诊断回归分析的质量。这篇文章咱们就围绕这个话题展开——回归分析的结果诊断。 六项检查 帮助文档中也有相关的内容，但是觉得相对还是比较晦涩，我就结合Esri Global UC的视频介绍一下。内容不尽相同，但是对学习回归分析是有帮助的。 Check #1 解释变量与因变量具有预期的关系否？ 每个解释变量都会有一个系数，系数具有+/-号，来表示解释变量与因变量的关系。从工具的得到的报告中，我们看到的系数的正负，每个解释变量应该是我们期望的关系。如果有非常不符合逻辑的系数，我们就应该考虑剔除它了。 当然，有时也可能得到与常识不同的结论。举个例子，假如我们在研究森林火灾，我们通常认为降雨充沛的区域火灾的发生率会相对较低，也就是所谓的负相关，但是，这片森林火灾频发的原因可能是闪电雷击，这样降雨量这个解释变量可能就不是常识中的负相关的关系了。 因此，我们除了验证解释变量的系数与先验知识是否相符外，还有继续结合其他项检查继续诊断，从而得出更可靠的结论。 Check #2 解释变量对模型有帮助否？解释变量对模型有无帮助说的就是解释变量是否有显著性，同样我们可以从 OLS 工具的汇总报表中得出些结论。 那如何了解这些解释变量是否有显著性呢？ OLS 工具除了对模型中的每个解释变量计算一个系数外，还执行统计检验以确定这些解释变量是否对模型有所帮助。 如果解释变量的系数为零（或非常接近零），我们认为这个解释变量对模型没有帮助，统计检验就用来计算系数为零的概率。如果统计检验返回一个小概率值（p 值），则表示系数为零的概率很小。如果概率小于 0.05，OLS 汇总报告上 概率（Probability） 旁边的一个 星号（*） 表示相关解释变量对模型非常重要。换句话说，其系数在 95% 置信度上具有统计显著性。 利用空间数据在研究区域内建模的关系存在差异是非常常见的，这些关系的特征就是不稳定。我们就需要通过 稳健概率（robust probability） 了解一个解释变量是否具有统计显著性。 OLS 汇总报告中所包括的另一项统计检验是用于不稳定性的 Koenker（Koenker 的标准化 Breusch-Pagan）统计量。 你也可以忽略上面说的，傻瓜方法就是：确保解释变量的概率、稳健概率列中带星号。 Check #3 残差是否有空间聚类？残差在空间上应该是随机分布的，而不应该出现聚类。这项检查我们可以使用 空间自相关工具（Spatial Autocorrelation Tool）工具进行检查。 Check #4 模型是否出现了倾向性？我们以前听过政治老师说过，不要戴着“有色眼镜”看人！也可能是历史老师？这不重要。。同样，回归分析模型中，也不要带有“成见”，不能具有倾向性，否则，这不是个客观合理的模型。 我们都知道正态分布是个极好的分布模式，如果我们正确的构建了回归分析模型，那么模型的残差会符合完美的正态分布，其图形为钟形曲线。 当模型出现偏差时，可能我们看到的图形也是诡异的，这样我们就无法完全信任所预测的结果。 如何检验呢？ 在 OLS 汇总报告中，有一个具有统计显著性的 Jarque-Bera 诊断表示模型是否出现偏差。如下图中是没有偏差的模型，如果有偏差，在篮框中会出现星号。 因此，判断自己的模型没有偏差的最直观的方法就是：Jarque-Bera 诊断中没有星号。 解决偏差！ 为了解决模型偏差，最好为所有模型变量创建一个散点图矩阵。因变量和一个解释变量之间存在非线性关系，这是出现模型偏差的常见原因。这些在散点图矩阵中看起来像一条曲线。 OLS 是一种线性回归方法，假设您正在建模的关系是线性关系。如果不是，可尝试变换您的变量，以查看这样做是否可创建出线性更明显的关系。常见变换包括对数变换和指数变换。 另外，散点矩阵图还可以显示出数据异常值。要了解一个异常值是否正在影响您的模型，请尝试在含有和不含有异常值的情况下分别运行 OLS，从而了解异常值对模型性能的更改程度，以及移除异常值是否会校正模型偏差。 Check #5 解释变量中存在冗余吗？在我们建模的过程中，应尽量去选择表示各个不同方面的解释变量，也就是尽量避免传达相同或相似信息的解释变量。要清楚，引入了冗余变量的模型是不足以信任的。 那么问题来了，如何判断是否存在冗余解释变量？ OLS工具会为每个变量计算膨胀因子（Variance Inflation Factor，VIF），VIF 值是对变量冗余度的一种度量，可辅助决定在不削弱模型解释能力的情况下可从中移除哪些变量。根据经验，VIF 值超过 7.5 就有问题。如果有两个或更多解释变量的 VIF 值超过了 7.5，应该一次移除其中一个变量并重新运行 OLS，直到冗余消失。记住，不要全部移除掉哦！ Check #6 评估模型的性能最后需要做的是，评估模型的性能。 矫正R2值 是评估解释变量对因变量建模的重要度量。 这项检查应该放到最后。一旦我们通过了前面的所有检验，接下来就可以进行评估矫正R2值。 R2值的范围介于 0 和 1 之间，以百分比形式表示。假设正在为犯罪率建模，并找到一个通过之前所有五项检查的模型，其校正 R2 值为 0.65。这样就可以了解到模型中的解释变量说明犯罪率是 65%（更技术一些来说就是，模型解释了犯罪率因变量中 65% 的变化量）。在有些科学领域，能够解释复杂现象的 23% 就会让人兴奋不已。在其他领域，一个R2值可能需要更靠近 80% 或 90% 才能引起别人的注意。不管采用哪一种方式，校正 R2 值都会帮我们判断自己模型的性能。 另一项辅助评估模型性能的重要诊断是修正的 Akaike 信息准则 /Akaike’s information criterion (AICc)。AICc 值是用于比较多个模型的一项有用度量。例如，可能希望尝试用几组不同的解释变量为学生的分数建模。在一个模型中仅使用人口统计变量，而在另一个模型选择有关学校和教室的变量，如每位学生的支出和师生比。只要所有进行比较的模型的因变量（在本示例中为学生测试分数）相同，我们就可以使用来自每个模型的 AICc 值确定哪一个的表现更好。模型的 AICc 值越小，越适合观测的数据。 有关回归分析结果诊断就说这么多了，希望看起来不是那么枯燥无味……","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Statistics","slug":"Spatial-Statistics","permalink":"http://www.kikitamap.com/tags/Spatial-Statistics/"}]},{"title":"空间统计（四）回归分析探索","slug":"RegressionAnalysis","date":"2015-03-20T08:01:54.000Z","updated":"2016-08-08T06:35:27.487Z","comments":true,"path":"2015/03/20/RegressionAnalysis/","link":"","permalink":"http://www.kikitamap.com/2015/03/20/RegressionAnalysis/","excerpt":"","text":"在上一篇文章中，我提到的这些工具都是用于研究数据有什么样的空间模式，哪里聚类？哪里是热点？哪里有冷点？哪里有异常值？等等，总之研究的是“生米煮成熟饭”的结果状态。 而“空间关系建模”工具箱中的工具，更倾向于研究 Why？ 例如，为什么会出现这种情况？ 或者说什么导致了这种情况。这时我们就可以使用工具进行回归分析，如：普通最小二成法（OLS） 和 地理加权回归（GWR）。 你可能会问，为什么要进行回归分析？帮助文档中回归分析基础这一章写的最好，比较贴近读者，而不是冰冷的字典，我把回归分析的应用示例搬过来帮助理解，以下内容整理自帮助文档。 对某一现象建模，以更好地了解该现象并有可能基于对该现象的了解来影响政策的制定以及决定采取何种相应措施。基本目标是测量一个或多个变量的变化对另一变量变化的影响程度。示例：了解某些特定濒危鸟类的主要栖息地特征（例如：降水、食物源、植被、天敌），以协助通过立法来保护该物种。（更好地了解） 对某种现象建模以预测其他地点或其他时间的数值。基本目标是构建一个持续、准确的预测模型。示例：如果已知人口增长情况和典型的天气状况，那么明年的用电量将会是多少？（ 建模预测） 您还可以使用回归分析来深入探索某些假设情况。假设您正在对住宅区的犯罪活动进行建模，以更好地了解犯罪活动并希望实施可能阻止犯罪活动的策略。开始分析时，您很可能有很多问题或想要检验的假设情况：（ 探索检验假设） “破窗理论”表明公共财产的破坏（涂鸦、被毁坏的建筑物等）可招致其他犯罪行为。破坏财产行为与入室盗窃之间是否存在正关系？ 非法使用毒品与盗窃行为之间存在某种关系吗（吸毒成瘾的人有可能通过偷取财物来维持他们吸毒的习惯吗）？ 窃贼恃强凌弱吗？老人或女性户主家庭居多的住宅区内发生盗窃的可能性更高吗？ 是住在富有的小区内更容易遭受盗窃，还是住在贫穷的小区内更容易遭受盗窃？您可以通过回归分析来探索这些关系并解答您的问题。 总之，通过回归分析，我们可以对空间关系进行建模、检查和探究；回归分析还可帮助我们解释所观测到的空间模式背后的诸多因素。 在所有的回归方法中，OLS 最为著名。而且，它也是所有空间回归分析的正确起点。它可以尝试了解或预测（早逝/降雨）的变量或过程提供一个全局模型；而且，它可创建一个回归方程来表示该过程。地理加权回归 (GWR) 是若干空间回归方法中的一种，被越来越多地用于地理及其他学科。通过对数据集中的各要素拟合回归方程，GWR 为您要尝试了解/预测的变量或过程提供了一个局部模型。若使用得当，这些方法可提供强大且可靠的统计数据，以对线性关系进行检查和估计。 例如如下是两个变量之间存在正、负关系以及无关系的情况： 通过上文，我们有了对回归分析的基本的印象，下面我们就来深入进去，看看 回归分析是如何实现的？ 回归分析是一个复杂的过程。在这个过程中，我们利用一个或多个解释变量对因变量进行最佳预测。说到底就是一个包含因变量、解释变量、系数、残差的数学公式，像下面的样子。 什么是因变量？ 等式的左边是 因变量（Dependent Variable） ，记为 Y，表示我们要研究或者预测的对象。通常我们会先给定一些已知的 Y 值，用于构建回归方程，这些已知的 Y 值称为 观测值。 什么是解释变量？ 等式的右边的 X ，称为 自变量 或 解释变量（Explanatory Variables）。因变量是解释变量的函数。到这里，可能有的同学就晕了。同样，举个栗子。我们想研究人们肥胖的诸多原因，想找到肥胖与收入、健康食品摄入、教育水平等等因素是否有关联。在这个例子中，肥胖就是因变量（Y），收入、健康食品摄入、教育水平等这些因素即为解释变量（X）。 还有重要的回归系数呢！ 在方程中，我们还发现有些 β 值，称为 回归系数（Coefficient） 。表示解释变量与因变量之间的关系强度和类型，每个解释变量都有一个对应的回归系数。当关系为正时，关联系数的符号也为正。当关系为负时，关联系数的符号也为负。如果关系很强，则系数也相对较大。如果关系较弱，则关联系数接近于零。 其中， 为回归截距。 它表示所有自变量（解释变量）均为零时因变量的预期值。 绝对不能忘记的残差！ ε称为 残差（Residual）或 随机误差项，是因变量不能解释的部分。回归工具可以构造出能够对那些已知的 y 值作出最佳预测的方程。不过，预测值很少会和观测值完全匹配。y 的观测值与预测值之差称为残差。回归方程中的残差可用于确定模型的拟合程度。残差较大表明模型拟合效果较差。 回归模型的构建是一个迭代过程，在该过程中，需要找出有效的自变量来了解因变量，且需要运行回归工具来确定哪些变量为有效的预测因子，然后需要反复执行变量移除和/或添加操作，直到找出最佳的回归模型。虽然构建模型的过程通常是探索性的，但它绝不是“盲目的搜查”。我们应通过了解相关理论、请教该领域内的专家并凭借一些常识性信息来确定可能的解释变量。在分析之前，我们应该清楚每个可能的解释变量和因变量之间的关系并能够对其正确与否作出判断，而且，对于这些关系不匹配的模型，我们应该表示质疑。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Statistics","slug":"Spatial-Statistics","permalink":"http://www.kikitamap.com/tags/Spatial-Statistics/"}]},{"title":"空间统计（三）聚类分布制图","slug":"MappingCluster","date":"2015-03-17T07:59:35.000Z","updated":"2016-03-07T04:46:02.000Z","comments":true,"path":"2015/03/17/MappingCluster/","link":"","permalink":"http://www.kikitamap.com/2015/03/17/MappingCluster/","excerpt":"","text":"这组工具中包含众所周知的热点分析工具，通过这个工具我们能捕获到大量数据中的热点和冷点，对我们分析问题有很大的帮助。例如，在犯罪分析中，我们可以研究哪些位置犯罪频繁并且聚集，对增设警力有重要的辅助作用。工具集中的其他工具也有类似的作用，都是通过执行聚类分析来识别具有统计显著性的热点、冷点和空间异常值的位置。 依照惯例，我们还是 one by one 来看。 Similarity Search相似搜索工具，顾名思义，工具根据要素属性确定哪些候选要素与输入要素最相似或者最不相似。 举个栗子： 我希望找到与圣地亚哥5岁以下儿童、未成年人、65岁以上老年人人数分布相似的城市： 工具中我做如下配置： 结果在这里，其中 Similarly Rank 为 1 的即为三个年龄属性最相似的城市 Orange： 匹配方法参数中提供了3种算法，分别为：属性值、等级属性值或属性剖面（余弦相似性）。 可能的应用： 人力资源经理可能希望能够证明公司的工资范围。找出在大小、生活成本、市容建筑方面相似的城市后，她便可以查看这些城市的工资范围，从而查看他们是否在此行列。 犯罪分析师希望搜索数据库以查看某罪行是否属于较重犯罪形式或有重罪趋势。 课外健身计划在 A 城极其成功。计划提倡者期望找到与其计划推广的候选城市具有相似特征的其他城市。 执法机构用此方法揭露毒品种植地或生产地。标识具有相似特征的地方可能有助于制定未来的搜索目标。 大型零售商不仅拥有数个成功店铺，也有少数业绩不佳的店铺。找到一些具有相似人口特征和环境特征（交通便利性、知名度以及商业互补性等等）的地方有助于标识新店的最佳位置。 Grouping Analysis我们在学习研究事物时，有事需要对事物进行归类从而帮助理解与分析。在ArcGIS 中，分析分组分析工具就是来进行这个逻辑分类过程，它会执行一个分类过程来查找数据中存在的自然聚类。要素相似性是基于您为分析字段参数指定的一组特性，同时还可以包括空间属性或空间-时间属性。 在这个工具中有个重要的参数—— Spatial Constrains，用于设置分组过程是否受某种空间关系约束，具体可选的方法如下： CONTIGUITY_EDGES_ONLY — 共享一条边的相连的面才属于同一个组。 CONTIGUITY_EDGES_CORNERS — 共享一条边或一个折点的相连面才属于同一个组。 DELAUNAY_TRIANGULATION — 同一个组中的要素至少具有一个与该组中的另一要素共用的自然邻域。自然邻域关系基于 Delaunay 三角测量。从概念上讲，Delaunay 三角测量可以根据要素质心创建不重叠的三角网。每个要素是一个三角形结点，具有公共边的结点被视为邻域。 K_NEAREST_NEIGHBORS — 同一个组中的要素将相互邻近；每个要素至少是该组中某一其他要素的邻域。邻域关系基于最近的 K 要素，您可以在此为“相邻要素的数目”参数指定整型值 K。 GET_SPATIAL_WEIGHTS_FROM_FILE — 空间关系和可选的时态关系通过空间权重文件 (.swm) 进行定义。使用“生成空间权重矩阵”工具创建空间权重矩阵文件。 NO_SPATIAL_CONSTRAINT — 只能使用数据空间邻域法对要素进行分组。要素不是必须在空间或时间上互相接近，才能属于同一个组。 可能的应用： 假设您拥有来自所在州周围农场的沙门氏菌样本，以及包括类型/类别、位置和日期/时间在内的属性。为了更好地了解细菌如何传播和扩散，您可以使用分组分析工具将样本划分为各个“爆发”。您可能决定使用空间-时间约束，因为同一次爆发的样本会在空间和时间上会非常接近，而且也会与相同类型/类别的细菌关联。确定分组之后，可以使用其他空间模式分析工具，比如标准差椭圆、平均中心或近邻来分析每一次爆发。 如果您收集了有关动物观察方面的数据，以便更好地了解它们的领地，分组分析工具可能很有帮助。例如，了解鲑鱼在不同生命阶段的聚集地点和时间，可以帮助您规划保护区，以帮助确保成功繁育。 作为一名农学家，您可能想将研究领域内的不同土壤进行分类。对通过一系列样本发现的土壤特征使用分组分析可以帮助识别出明显的、空间上相邻的土壤类型的聚类。按购买方式、人口统计特征和/或旅行方式对客户进行分组，可以帮助您为公司产品制订有效的营销策略。 城市规则师常常需要将各个城市划分成不同的邻域，以便有效地定位公共设施、促进地方能动性和提高社区参与度。对城市街区的物理和人口统计特征使用分组分析，可以帮助规划师确定具有相似物理和人口统计特征并且在空间上相邻的城市区域。 每当对聚合的数据进行分析时，生态谬误都是一个众所周知的统计推断问题。通常，用于分析的聚合方案对我们想要分析的内容没有任何关系。例如，人口普查数据是根据人口分布而聚合，而人口分布情况可能不是用来进行火灾分析的最佳选择。针对与目前分析问题准确相关的一组属性，将可能的最小聚合单位划分成同质区域，是降低聚合偏差和避免生态谬误的一种有效方法。 Hot Spot Analysis (Getis-Ord Gi*)热点分析工具是个 Most Popular 工具，经常会被用到，通过此工具，我们可以来识别有统计显著性的热点和冷点。例如，警察局会调查哪个区域是刑事案件的高发区？这就是一个典型的热点分析例子。如下图，黑点表示报警位置，其中属性表中包含一个报案次数的字段，得到了犯罪热点。从而警察局可以考虑在热点位置增设警力。 此工具的工作方式为：查看邻近要素环境中的每一个要素。因此，仅仅一个孤立的高值不会构成热点，说白了就是，单个要素以及它的邻居都是高值才算是热点。在热点分析工具中，z 得分和 p 值都是统计显著性的度量，用于逐要素地判断是否拒绝零假设。置信区间（Gi_Bin字段） +3 到 -3 中的要素反映置信度为 99% 的统计显著性，置信区间 +2 到 -2 中的要素反映置信度为 95% 的统计显著性，置信区间 +1 到 -1 中的要素反映置信度为 90% 的统计显著性；而置信区间 0 中要素的聚类则没有统计学意义。 如果要素的 z 得分高且 p 值小，则表示有一个高值的空间聚类。如果 z 得分低并为负数且 p 值小，则表示有一个低值的空间聚类。z 得分越高（或越低），聚类程度就越大。如果 z 得分接近于零，则表示不存在明显的空间聚类。 关于此工具的建议： 输入要素类是否至少包含 30 个要素？如果少于 30 个要素，则结果不可靠。 您选择的空间关系的概念化是否合适？对于此工具，建议使用固定距离范围方法 可能的应用： 应用领域包括：犯罪分析、流行病学、投票模式分析、经济地理学、零售分析、交通事故分析以及人口统计学。其中的一些应用示例包括： 疾病集中爆发在什么位置？ 何处的厨房火灾在所有住宅火灾中所占的比例超出了正常范围？ 紧急疏散区应位于何处？ 峰值密集区出现于何处/何时？ 我们应在哪些位置和什么时间段分配更多的资源？ Optimized Hot Spot Analysis在最近几个版本的 ArcGIS 中多了一个 “优化的热点分析工具”，我们如何理解这个工具呢？帮助文档中有一个比喻，好比“数码相机自动根据光线、拍摄主体与背景对比度的读数，来确定合适的光圈、快门速度和焦点”，优化的热点分析是根据输入数据的特征派生参数，从而获得产生最佳热点结果的设置，然后执行热点分析工具。 简而言之，如果拿到单反，使用“优化的热点分析工具”好比把拍照模式调成了“全自动”，而使用“热点分析工具”好比把拍照模式调成“手动”，热点分析工具允许我们完全控制所有参数选项。运行优化的热点分析工具并记录其使用的参数设置，有助于优化设置热点分析 (Getis-Ord Gi*) 工具的参数。 打开这个工具，我们会发现，这个工具太可爱了，除了输入和输出参数，其他所有参数都是可选的，都可以不填！ 果然是全自动模式，傻瓜相机版热点分析。但是，这几个参数决定了优化热点分析的方式，为了“照片”更美，还是需要了解些东西的，一起来看看： 分析字段：当要分析的数据中存在一个字段存储了采样值，我们想了解这个采样值的高值与低值的聚集区域，那分析字段就需要选择这个字段。 当我们的数据不具有这样的采样值，并且我们希望研究的是点的计数，也就是研究：哪里存在很多点？哪里存在很少点？这时，选择一种聚合方案就变得重要了。 工具中提供了三种聚合方案： 1） COUNT_INCIDENTS_WITHIN_FISHNET_POLYGONS：采用渔网聚合，渔网的网格大小由工具根据点的距离关系决定。 2） COUNT_INCIDENTS_WITHIN_AGGREGATION_POLYGONS：提供聚合面以覆盖事件聚合面参数中的事件点数据。计算每个面内的事件数。例如：计算加州每个城市的消防站的聚集情况。 3）SNAP_NEARBY_INCIDENTS_TO_CREATE_WEIGHTED_POINTS：邻近事件将聚合在一起，从而创建单个加权点。各点的权重值是该位置的聚合事件数。 无论是哪种方法，在工具的日志中会提供一个研究这些数据聚类的最优的距离，类似： Cluster and Outlier Analysis (Anselin Local Moran’s I)给定一组加权要素，使用 Anselin Local Moran’s I 统计量来识别具有统计显著性的热点、冷点和空间异常值。 热点分析(Getis-Ord Gi) 工具也是查找热点和冷点位置的有效工具。但是，*只有聚类和异常值分析(Anselin Local Moran’s I) 工具可以识别具有统计学上的显著性的空间异常值（高值由低值围绕或低值由高围绕的值）。 输出要素类中包含：Local Moran’s I 指数、z 得分、p 值、聚类/异常值类型 (COType)。 如果要素的 z 得分是一个较高的正值，则表示周围的要素拥有相似值（高值或低值）。输出要素类中的 COType 字段会将具有统计显著性的高值聚类表示为 HH，将具有统计显著性的低值聚类表示为 LL。如果要素的 z 得分是一个较低的负值（如，小于 -3.96），则表示有一个具有统计显著性的空间数据异常值。输出要素类中的 COType 字段将指明要素是否是高值要素而四周围绕的是低值要素 (HL)，或者要素是否是低值要素而四周围绕的是高值要素 (LH)。如下图可以帮助理解： COType 字段将始终指明置信度为 95% 的统计显著性聚类和异常值。只有统计显著性要素在 COType 字段中具有值。 可能的应用聚类和异常值分析(Anselin Local Moran’s I) 工具可识别高值密度、低值密度和空间异常值。还可帮助您解决如下问题： 研究区域中的富裕区和贫困区之间的最清晰边界在哪里？ 研究区域中存在可以找到异常消费模式的位置吗？ 研究区域中意想不到的糖尿病高发地在哪里？可在经济学、资源管理、生物地理学、政治地理学和人口统计等许多领域中应用此工具。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Statistics","slug":"Spatial-Statistics","permalink":"http://www.kikitamap.com/tags/Spatial-Statistics/"}]},{"title":"NEW！获取 ArcGIS Pro 与 ArcGIS Desktop 60天试用许可","slug":"ArcGISPro60DayFreetrial","date":"2015-03-06T09:29:22.000Z","updated":"2016-03-07T04:48:38.000Z","comments":true,"path":"2015/03/06/ArcGISPro60DayFreetrial/","link":"","permalink":"http://www.kikitamap.com/2015/03/06/ArcGISPro60DayFreetrial/","excerpt":"","text":"春节之后，美国esri官网给了我们一些小惊喜，千呼万唤的 ArcGIS Pro 的试用许可终于放出来了。与ArcGIS Desktop Advanced 一起提供 60天的试用，同时附赠了 200 个 credit。 ArcGIS Pro 使用了全新的 Named User 方式授权许可，我们可以多个设备同时在线使用。 PS：如果你希望得到 ArcGIS Desktop的使用许可，这篇文章也能帮到你。 下面就说说申请途径和激活方式。 First ，找到Esri官方试用地址http://www.esri.com/software/arcgis/arcgis-for-desktop/free-trial 2 填写姓名、邮箱地址，用于接收验证邮件 3 收取邮件，激活链接 4 创建ArcGISOnline账户 5 设置组织信息，并保存继续 6 获取应用程序 7 下载 ArcGIS Pro 程序 PS： ArcGIS Pro 暂时只有英文版，注意切换语言。 ArcGIS Desktop 的程序也可以在这里下载，授权号码就在右边的位置，与以往授权方式不变。如果需要了解如何授权 ArcGIS Desktop ，还是看我 以前写的一篇，从第6步开始看即可。 8 转到 ArcGIS Online 9 在组织中管理 ArcGIS Pro 的许可 10 分配许可给指定用户（Named User） ↓↓↓ ↓↓↓ Final，开启 ArcGIS Pro 登录账号 ↓↓↓ ↓↓↓ 现在就开始 ArcGIS Pro 之旅喽。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"License","slug":"License","permalink":"http://www.kikitamap.com/tags/License/"},{"name":"ArcGIS Pro","slug":"ArcGIS-Pro","permalink":"http://www.kikitamap.com/tags/ArcGIS-Pro/"}]},{"title":"空间统计（二）分析模式 B","slug":"AnalysisPatternsB","date":"2015-03-05T03:21:40.000Z","updated":"2016-08-08T06:08:37.308Z","comments":true,"path":"2015/03/05/AnalysisPatternsB/","link":"","permalink":"http://www.kikitamap.com/2015/03/05/AnalysisPatternsB/","excerpt":"","text":"这一篇具体看分析模式工具集中的具体工具，整理这一篇的目的，不是要读者了解每个工具的背后使用了多么高级的算法，运用了多么庞大的公式，而是一起了解这些工具究竟可以为我们研究什么样的空间数据分布模式，当需要探索数据的空间性质时，知道应该如何去应用这些分析工具。 Average Nearest Neighbor平均最近邻工具通过计算每个要素与其最邻近要素之间的距离来计算最近邻比率。如果最近邻比率小于 1，则表现的模式为聚类。如果指数大于 1，则表现的模式趋向于扩散。 “平均最近邻”工具将返回五个值：观测的平均距离、期望的平均距离、最近邻指数、z 得分和 p 值。 在HTML报告文件中可以更显见的了解数据的趋势： 可能的应用： 评估竞争或领地：量化并比较固定研究区域中的多种植物种类或动物种类的空间分布；比较城市中不同类型的企业的平均最近邻距离。 监视随时间变化的更改：评估固定研究区域中一种类型的企业的空间聚类中随时间变化的更改。 将观测分布与控制分布进行比较：在木材分析中，如果给定全部可收获木材的分布，则您最好将已收获面积图案与可收获面积图案进行比较，以确定砍伐面积是否比期望面积更为聚类。 Spatial Autocorrelation空间自相关 (Global Moran’s I) 工具同时根据要素位置和要素的属性值来度量空间自相关。在给定一组要素及相关属性的情况下，评估所表达的模式是聚类模式、离散模式还是随机模式。 与平均最近邻工具类似，此工具将返回五个值：Moran’s I 指数、预期指数、方差、z 得分和 p 值。 在使用这个工具的时候，注意以下几点： 输入要素的记录数至少30个，少于30结果不可靠。 选择的适当的概念化空间关系，具体根据自己的数据参考前一篇。 可能的应用 通过查找距离（即空间自相关最强的位置对应的距离），可为各种空间分析方法确定合适的邻近距离。 度量种族或民族分离随时间推移的总体趋势 - 分离程度是逐渐增强还是逐渐减弱？ 总结某种观点、疾病或趋势随空间和时间变化的传播情况 - 观点、疾病或趋势是保持隔离和集中，还是传播开并变得更加分散？ Incremental Spatial Autocorrelation增量自相关工具会去测量一系列的空间自相关，并且可以创建 Z 得分折线图。Z 得分反映空间聚类的程度，峰值 Z 得分表示聚类最明显的距离。这些峰值能做什么呢？我们可以将这些峰值作为其他工具（例如热点分析，将来会说到）的必要参数，例如距离范围，距离半径等等。 以下面的数据为例： 我欲研究下面几个城市的人口分布情况： 第一个峰值位于大约 250000 处。当显示多个具有统计显著性的峰值时（例如，本示例数据中有两个峰值），聚类在这些距离处均很明显。选择与感兴趣的分析比例对应的峰值距离，我们通常选择第一个具有统计显著性的峰值。 High/Low Clustering (Getis-Ord General G)高/低聚类 (General G) 统计的零假设规定被研究的要素值不存在空间聚类。当返回的 p 值较小且在统计学上显著，则可以拒绝零假设。如果零假设被拒绝，则 z 得分的符号将变得十分重要。如果 z 得分值为正数，则观测的 General G 指数会比期望的 General G 指数要大一些，表明属性的高值将在研究区域中聚类。如果 z 得分值为负数，则观测的 General G 指数会比期望的 General G 指数要小一些，表明属性的低值将在研究区域中聚类。 当存在完全均匀分布的值并且要查找高值的异常空间峰值时，首选高/低聚类(Getis-Ord General G)工具。遗憾的是，高值和低值同时聚类时，它们倾向于彼此相互抵消。如果在高值和低值同时聚类时测量空间聚类，则使用空间自相关工具。 “高/低聚类”工具可返回五个值：General G 观测值、General G 期望值、方差、z 得分以及 p 值。 可能的应用： 在访问急症室的次数中查找出现的异常峰值，可能表明在局部或区域的健康问题的爆发。 比较在城市中不同种类零售业的空间模式，利用比较购物的方式来了解哪类行业充满竞争性（如汽车经销商）以及哪类行业拒绝竞争（如健康中心/健身房）。 汇总空间现象聚类的程度以检查不同时期或不同位置的变化。例如，众所周知的城市及其人口聚类。使用高/低聚类分析时，可以随时间来比较某个城市的人口聚类的程度（城镇发展以及密集度的分析）。 Multi-Distance Spatial Cluster Analysis (Ripley’s K Function)基于 Ripley’s K 函数的多距离空间聚类分析工具是另外一种分析事件点数据的空间模式的方法。Ripley’s K 函数可表明要素质心的空间聚集或空间扩散在邻域大小发生变化时是如何变化的。 如果有兴趣研究要素的聚类/扩散如何相对于不同距离（不同的分析规模）进行变化，可以使用此工具。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Statistics","slug":"Spatial-Statistics","permalink":"http://www.kikitamap.com/tags/Spatial-Statistics/"}]},{"title":"空间统计（二）分析模式 A","slug":"AnalysisPatternsA","date":"2015-03-05T03:15:56.000Z","updated":"2016-03-07T04:56:48.000Z","comments":true,"path":"2015/03/05/AnalysisPatternsA/","link":"","permalink":"http://www.kikitamap.com/2015/03/05/AnalysisPatternsA/","excerpt":"","text":"有时对于数据量较大的地理数据，我们希望通过一定的统计方法将空间模式量化，从而获知这些地理数据在空间上是聚合的、还是离散的、还是随机的等。 在了解如上工具之前，有一些空间统计学的基本知识还是要先搞明白，磨刀不误砍柴工，那就开始吧。 零假设、P值、Z得分、置信度 分析模式工具集中的工具都采用“推论统计学”，先确定一个零假设，也就是假设要素或与要素相关的值都表现为空间随机模式—— Complete Spatial Randomness (CSR)；然后再计算一个 p值，用来表示零假设的正确概率。分析模式工具集中的工具都会返回 P值（P-Value）和 Z得分（Z-Score），这是我们拒绝前面的零假设的依据，也就是我们观测的要素表现出显著性聚类或离散模式，而不是随机模式。什么是 P 值？ 什么是 Z 得分？ P值 就是概率值，它表示观测到的空间模式是由某随机过程创建而成的概率，或者我们简单的理解成是观测到的空间模式是随机空间模式的概率。P 值越小，也就是观测到的空间模式是随机空间模式的可能性越小，也就是我们越可以拒绝开始的零假设。 Z得分 表示标准差的倍数。例如，如果工具返回的 z 得分为 +2.5，我们就会说，结果是 2.5 倍标准差。如下所示，z 得分和 p 值都与标准正态分布相关联。 z 得分和 p 值结果是统计显著性的量度，用来判断是否拒绝零假设。在正态分布的两端出现非常高（正值）或非常低（负值）的 z 得分，这些得分与非常小的 p 值关联。当运行要素模式分析工具得到很小的 p 值以及绝对值很大的 z 得分时，就表明观测到的空间模式不太可能反映零假设中假定的随机模式。 那么，P值需要多小？或者说要小到什么程度，才能拒绝零假设呢？这时就需要我们自己主观选择一个 置信度（Confidence Level），典型的置信度有 90%、95%、99%。其中显见，99%的置信度是最保守的。 空间关系的概念化空间统计分析和传统（非空间）统计分析的一个重要区别是空间统计分析将空间关系整合到算法中。在我们执行各种各样的空间统计工具时，需要选择一项“空间关系概念化”，如何选择就主要取决于要测量的对象。如下是常见的选项： 反距离、反距离平方（阻抗） 使用“反距离”选项时，空间关系的概念模型是一种阻抗或距离衰减。距离越远，影响越小。INVERSE_DISTANCE：表示与远处的要素相比，附近的邻近要素对目标要素的计算的影响要大一些；INVERSE_DISTANCE_SQUARED：与 INVERSE_DISTANCE 类似，但它的坡度更明显，因此影响下降得更快，并且只有目标要素的最近邻域会对要素的计算产生重大影响。 例如：反欧氏距离适用于对连续数据（如温度变化）进行建模。再比如测量某种种子植物的聚集程度，使用反距离可能最合适。 距离范围（影响的范围）FIXED_DISTANCE_BAND：将对邻近要素环境中的每个要素进行分析。在指定临界距离内的邻近要素将分配值为 1 的权重，并对目标要素的计算产生重大影响。在指定临界距离外的邻近要素将分配值为零的权重，并且不会对目标要素的计算产生任何影响。 例如：要研究通勤模式并且已知平均上下班路程为 15 英里，则最好使用 15 英里的固定距离进行分析。 无差别的区域ZONE_OF_INDIFFERENCE：将“反距离”模型和“固定距离范围”模型合并为一体，在目标要素的指定临界距离内的要素将分配值为 1 的权重，并且会影响目标要素的计算。一旦超出该临界距离，权重就会随距离的增加而减小。 举个常见的例子，工作日的午饭我们通常会在公司附近解决，选餐馆的时候，可能在500米以内哪家都行，超过500米就可能太过占用时间从而影响中午的休息、娱乐等等，当餐馆距离公司超过500米，随着距离的增加，权重就不断减小。 面邻接（一阶）对于面要素类，可选择 CONTIGUITY_EDGES_ONLY或 CONTIGUITY_EDGES_CORNERS。其中，CONTIGUITY_EDGES_ONLY：只有共用边界的相邻面要素会影响目标面要素的计算，不共享边的面被排除在目标要素计算之外。CONTIGUITY_EDGES_CORNERS：共享边界、结点的面要素会影响目标面要素的计算。如果两个面存在重叠的部分，则将视为相邻要素并包含在彼此的计算中。 例如，研究某些传染病的传染区域时，可以考虑此空间关系概念化。 K最近邻域K表示最近邻域数目。如果 K（邻域数）为 8，则距目标要素最近的 8 个邻域都会包含在该要素的计算中。在要素密度高的位置处，分析的空间范围会比较小。与此类似，要素密度稀的位置，分析的空间范围会比较大。使用生成空间权重矩阵工具时该方法可用。 通过文件获取空间权重（用户定义的空间关系）GET_SPATIAL_WEIGHTS_FROM_FILE：将在空间权重文件(.SWM) 中定义空间关系，文件可以使用空间统计工具箱中其他相关的工具创建，这里先不展开，后面再说。 有了这些先验知识，我们就来看看ArcGIS Desktop 中提供的这些工具，有点长了，再另起一篇看工具吧。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Statistics","slug":"Spatial-Statistics","permalink":"http://www.kikitamap.com/tags/Spatial-Statistics/"}]},{"title":"空间统计（一）度量地理分布","slug":" MeasuringGeographicDistributions","date":"2015-02-26T09:50:36.000Z","updated":"2016-03-07T06:30:12.000Z","comments":true,"path":"2015/02/26/ MeasuringGeographicDistributions/","link":"","permalink":"http://www.kikitamap.com/2015/02/26/ MeasuringGeographicDistributions/","excerpt":"","text":"ArcGIS Desktop 中有一个包含了一系列用于研究空间分布（spatial distribution）、空间模式（spatial pattern）、空间关系（spatial relationship）的统计的工具箱 —— Spatial Statistics Toolbox。这与普通的统计方法不同，空间统计将许多地理空间的概念融入到统计算法逻辑中，例如：邻域（proximity），面积（area），连通性（connectivity）等。 本篇总结一下有关 度量地理分布（ Measuring Geographic Distributions）工具集中提供的功能。这些工具用于研究要素的空间分布特征，下面一个一个来看： Central Feature中心要素（Central Feature）这个工具可用于寻找一组要素中处于最中心位置的要素，这一组要素可以是点、线、面。 可解决的问题例如： 某个区域的仓库中最中心位置的是哪个? 在几个区块中，哪一个具有最中心的位置？ 工具的算法是将每个要素质心与其他各要素质心之间的距离计算并求和，取最小值。那么问题来了…… 距离测量方法是什么？ 有欧式距离与曼哈顿距离可选，区别点这里。并且需牢记，投影坐标系下才有准确的测量值，如果数据是经纬度坐标系，需要投影变换。 要素的质心如何确定？ 对于线和面要素，距离计算中会使用要素的质心。对于多点、折线或由多部件组成的面，将会使用所有要素部件的加权平均中心来计算质心。点要素的加权项是 1，线要素的加权项是长度，而面要素的加权项是面积。 如何求多组要素的各自的中心要素？ 设置分组字段，可以对多个分组的要素分别计算中心要素。 Mean Center平均中心（Mean Center）用于计算输入的要素的质心的平均中心，因此这个工具会计算出一个新的点。 如果输入数据包含 Z 值，那么在平均中心也会计算 Z 值，也就是得到3D点。 这个工具在现实中有什么应用呢？我从帮助中引用几个有意思的应用： ★ 犯罪分析师在对白天事件点与夜间事件点进行对比评估时，可能希望查看盗窃行为的平均中心是否会有所变化。这有助于公安部门更好地分配资源。 ★ 野生生物学家可以计算某个公园若干年内的麋鹿观测值的平均中心，以了解夏季和冬季麋鹿会在何处聚集，从而为公园游客提供更好的信息。 ★ GIS 分析师可以通过将 911 紧急电话的平均中心与紧急响应站的位置进行比较来评估服务水平。此外，该分析师还可以对由超过 65 岁的个人加权所得的平均中心进行评估，从而确定提供老人服务的理想位置。 举个栗子： 2012年西非的马里暴动的位置信息采集后，求取平均中心大致可以了解事件的分布情况。 所有事件： 各类事件的平均中心： Median Center中位数中心（Median Center）工具使用迭代算法来查找可使所有要素间的欧氏距离达到最小的点。 平均中心和中位数中心均是中心趋势度量。但是，比较而言，中位数中心工具的算法受数据异常值的影响较小。 例如，对紧凑性群集点的平均中心进行计算的结果是该群集中心处的某个位置点。如果随后添加一个远离该群集的新点并重新进行计算平均中心，会注意到结果会向新的异常值靠近。而如果要使用中位数中心工具执行相同的测试，会发现新的异常值对结果位置的影响明显减小。 如下图中，向数据中增加两个相隔较远的点， Median Center 看起来要比 Mean Center 偏移的更小。 PS： 尽管中位数中心工具只返回一个点，但实际上,距所有要素的距离最小的位置点可能有多个。 Directional Distribution (Standard Deviational Ellipse)方向分布（标准差椭圆）工具可以查看要素的分布是否是狭长的，是否具有方向性，从而使我们直观的感受数据的趋向。该方法是由平均中心作为起点对 x 坐标和 y 坐标的标准差进行计算，从而定义椭圆的轴，因此该椭圆被称为标准差椭圆。 在工具生成的椭圆面中会包含： 平均中心的 X 和 Y 坐标、两个标准距离（长轴和短轴）及椭圆的方向，这五个值。 如果要素的基础空间模式是中心处集中而朝向外围的要素较少（一种空间正态分布），则一个标准差椭圆面会包含聚类中约 68％ 的要素，两个标准差椭圆面会包含聚类中约 95％ 的要素，三个标准差椭圆面则可包含聚类中约 99％ 的要素。 这个工具可能的应有哪些呢？从帮助文档中摘录过来： 在地图上标示一组犯罪行为的分布趋势可以确定该行为与特定要素（一系列酒吧或餐馆、某条特定街道等）的关系。 在地图上标示地下水井样本的特定污染可以指示毒素的扩散方式，这在部署减灾策略时非常有用。 对各个种族或民族所在区域的椭圆的大小、形状和重叠部分进行比较可以提供与种族隔离或民族隔离相关的深入信息。 绘制一段时间内疾病爆发情况的椭圆可建立疾病传播的模型。 我还使用上面马里的例子，了解各种事件的分布情况： 且不说分布方向，我们可以看出，无论是哪种暴动事件，与之并发导致的无家可归的难民是分布最广的。 Standard Distance标准距离工具可通过绘制一个半径等于标准距离值的圆在地图上体现一组要素的紧密度。 可能的应用： 利用两种或多种分布的值对分布进行比较。例如，犯罪分析家可以对袭击行为和汽车偷窃行为的紧密度进行比较。了解不同犯罪类型的分布情况可能有助于警察制定出应对犯罪行为的策略。如果特定区域内的犯罪行为分布很紧凑，那么在该区域中心附近配置一辆警车也许就足够了。但如果分布较分散，则可能需要几辆警车同时巡查该区域，才能更有效地对犯罪行为做出响应。 可以对同一类型要素在不同时间段内的分布情况进行比较。例如，犯罪分析家可以对白天盗窃行为和夜间盗窃行为进行比较，以了解白天与夜间相比，盗窃行为是更加分散还是更加紧凑。 可将要素分布与静态要素进行比较。例如，可以针对某个区域内各响应消防站在几个月内接到的紧急电话的分布情况进行度量和比较，以了解哪些消防站响应的区域较广。 Linear Directional Mean线性方向平均值工具可以计算一组线要素的趋势的平均角度。 许多具有一个起点和一个终点的线要素，例如飓风路径，我们就可以使用这个工具计算飓风的平均方向。再比如断层线，这种线要素我们一般认为它们有方位（orientation），但是没有方向（direction），我们也可以使用这个工具计算平均方位。 所以，如果要计算平均方向，请确保所有线的方向都是正确的。如果要计算平均方位，则会忽略线的方向。 请牢记，尽管大多数线在起点和终点之间具有多个折点，此工具将只使用起点和终点来确定方向。 输出线要素的为位于要素平均中心，长度为输入要素的平均长度。包含了罗盘角（以正北为基准方向按顺时针旋转）、方向平均值（以正东为基准方向按逆时针旋转）、圆方差（指示方向/方位偏离方向平均值的程度）、平均中心 X 和 Y 坐标及平均长度。 可能的应用： 比较两组或多组线。例如，研究河谷中麋鹿和驼鹿迁移状况的野生生物学家可计算这两个物种迁徙路径的方向趋势。 比较不同时期的要素。例如，鸟类学家可逐月计算猎鹰迁徙的趋势。方向平均值可汇总多个个体的飞行路径并对每日的迁移进行平滑处理。这样便可很容易地了解鸟类在哪个月进得最快，以及迁徙在何时结束。 评估森林中的伐木状况以了解风型和风向。 分析可以指示冰川移动方式的冰擦痕。 标识汽车失窃及被盗车辆追回的大体方向。 再举个栗子： 如下图中绿色的线段表示历年不同日期采集的风向数据，现在根据不同的年份计算每年的平均风向，结果如图，图形总是比表格数据直观的很：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Statistics","slug":"Spatial-Statistics","permalink":"http://www.kikitamap.com/tags/Spatial-Statistics/"}]},{"title":"ArcGIS Desktop 工具的并行处理","slug":"ParallelProcessing","date":"2015-01-12T03:37:49.000Z","updated":"2016-03-07T08:45:40.000Z","comments":true,"path":"2015/01/12/ParallelProcessing/","link":"","permalink":"http://www.kikitamap.com/2015/01/12/ParallelProcessing/","excerpt":"","text":"开始下面正文之前，先说一个旧闻，ArcGIS Desktop 10.1 SP1 之后的版本中， 出现了一个不明觉厉的 新特性 —— 并行处理（Parallel Processing）。 现在机器硬件越来越优，多核CPU的机器比比皆是，ArcGIS Desktop 32位单进程的模式不能充分的利用这些硬件资源，不能满足大数据量的处理要求。因此，Esri 改进了 ArcToolbox 中的部分工具，赋予了这部分工具并行处理的能力，确切地说是一小部分工具。 看到这里，问题可能来了，哪些工具支持并行处理呢？遗憾的是官方没有给出这个清单，这一点体验上确实不是很佳。但是我们还是有办法把它们找出来的，当我们在使用某个工具的时候，可以打开工具的帮助，在环境变量题目下找找有没有叫做 并行处理因子（Parallel Processing Factor）的项目。 也就是说，对于所有工具，只有其文档中环境变量下标明的环境变量参数才有效，而不是全部环境变量参数都有效！ 下面我们来看看这个参数是如何设置和影响工具运行的。做一个简单的小测试，先找到一个支持并行处理的工具，例如 Build Pyramids And Statistics 工具，用其为数据量较大的镶嵌数据集的项目创建金字塔和统计值。在默认设置下，只要工具支持并行处理，工具会自动创建多个进程（ArcSOCP.exe）来执行任务。如下图所示： 在工具支持并行处理的情况下，设置并行处理因子（Parallel Processing Factor）这个参数又能做什么呢？ 这个因子的数值，会决定工具运行使用的进程数量。一般，各工具在各个支持的环境中都有进程数量的内置默认值。我们可根据自己的数据情况、执行任务的类型和机器的可用资源对其进行更改。 一般是这四种设置方法： 在填写的时候，是不是一定进程数越多越好呢？ 引用帮助文档的原文供读者参考： “指定的进程数量大于计算机所具有的核数量，可能导致性能损失。这是因为多进程将在一个核上争夺资源。为避免这样的竞争，可以指定低于 100% 的百分数值或少于计算机核数量的进程数量。” 当然也有例外情况： “当所有进程均是对磁盘或企业级数据库连接的 I/O bound 时，您可通过指定多于核数量的进程以提高性能。例如将镶嵌数据集储存到企业级数据库时，添加栅格至镶嵌数据集 工具是 I/O bound。同样，构建概视图工具对磁盘的主要的 I/O bound。您可通过指定大于 100% 的百分比或大于计算机所含核数量的进程数量，来使用更多进程。例如，如果您有一台四核计算机，则指定 8 或 200%，这会跨八个进程展开操作。” 我做个了小测试，来对比对相同的数据做相同操作的时间消费。 测试环境： Windows 8.1 Enterprise 64bit ；ArcGIS for Desktop 10.3 任务： 为相同的一个镶嵌数据集的栅格项目创建金字塔和统计值，使用工具 Build Pyramids And Statistics ，金字塔重采样方法和压缩方法等参数均相同。 结果： √ 并行处理因子设置为 0，即不跨多进程，用时 39 minutes 3 seconds； √ 并行处理因子设置为 8，即工具跨8个进程并行处理，用时 1 minutes 28 seconds 。 *时间是工具运行的消息提供的时间。 时间相差悬殊，虽然只是一个小测试，我们却能感受到并行处理相比单进程处理体验好了很多。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"无法正常卸载 ArcGIS Desktop时，这样完全清除","slug":"Complete","date":"2014-12-26T02:15:20.000Z","updated":"2016-03-07T08:50:46.000Z","comments":true,"path":"2014/12/26/Complete/","link":"","permalink":"http://www.kikitamap.com/2014/12/26/Complete/","excerpt":"","text":"一般情况下，我们可以直接在“添加删除程序”中，对 ArcGIS Desktop 程序进行卸载，这是推荐的方法。 但是，如果遇到异常，例如：被杀毒程序不完整的删除或手动删除了必要的文件等，导致 ArcGIS 无论如何也卸载不掉，或者即使使用光盘去修复程序也失败，或者使用高版本的ArcGIS程序去覆盖也报错等。 那就需要手动清理一下了，这是最后一招，正常卸载程序失败时再考虑这招…… 我把有可能有的位置列在下面，对照一下，检查是否删除干净了。有些文件夹是隐藏文件夹，设置显示出来然后删除。 文件夹:C:\\Program Files (x86)\\ArcGISC:\\Program Files (x86)\\EsriC:\\Program Files (x86)\\Common Files\\ArcGISC:\\Program Files (x86)\\Common Files\\EsriC:\\Program Files\\ArcGISC:\\Program Files\\EsriC:\\Program Files\\Common Files\\ArcGISC:\\Program Files\\Common Files\\EsriC:\\Program Data\\EsriC:\\Program Data\\ArcGISC:\\Program Data\\FLEXnetC:\\Users\\\\AppData\\Local\\ESRIC:\\Users\\\\AppData\\Local\\ArcGISC:\\Users\\\\AppData\\Roaming\\ESRIC:\\Users\\\\AppData\\Roaming\\ArcGISC:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\ArcGISC:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Esri 注册表：HKEY_LOCAL_MACHINE\\SOFTWARE\\ESRIHKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\ESRIHKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Flex LM License ManagerHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\ArcGIS ServerHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\FLEXnet Licensing ServiceHKEY_CLASSES_ROOT\\Installer\\Products\\HKEY_CLASSES_ROOT\\Installer\\Assemblies\\HKEY_CLASSES_ROOT\\HKEY_CLASSES_ROOT\\Installer\\Assemblies\\Global\\ 安全设置：Security Settings -&gt; Local Policies -&gt; Security OptionsLocate “User Account Control: Run all administrators in Admin Approval” and change the setting from Enabled to DisabledUninstall: C:\\Windows\\assembly\\Esri. (This can be hundreds of files)Uninstall: C:\\Windows\\assembly\\ArcGIS. (This can be hundreds of files)","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"}]},{"title":"我们可能会遇到的距离量算方法","slug":"MeasureDistances","date":"2014-12-25T07:57:46.000Z","updated":"2016-03-07T08:55:34.000Z","comments":true,"path":"2014/12/25/MeasureDistances/","link":"","permalink":"http://www.kikitamap.com/2014/12/25/MeasureDistances/","excerpt":"","text":"在看空间统计相关的文档资料的时候，看到了几个有关距离丈量方法的术语词汇，诸如：欧式距离、曼哈顿距离、切比雪夫距离…… 老外习惯于使用名字来命名算法，可是对于门外汉们，是一种困惑，今天就整理下，一起温故知新。 1. 欧式距离（Euclidean Distance）欧式距离是我们在直角坐标系中最常用的距离量算方法，例如小时候学的“两点之间的最短距离是连接两点的直线距离。”这就是典型的欧式距离量算方法。 通常这这个距离的获取是基于我们熟悉的“勾股定理”，解算三角形斜边得到的。 _看看维基百科：http://en.wikipedia.org/wiki/Euclidean_distance_ 2. 曼哈顿距离（Manhattan Distance）曼哈顿距离是与欧式距离不同的一种丈量方法，两点之间的距离不再是直线距离，而是投影到坐标轴的长度之和。 ![](http://7xospm.com1.z0.glb.clouddn.com/1e2f0997-552d-4f94-9fb6-7b075615a9b2_20141225151215828.png) 还是看图吧，图比文字更显见。 ![](http://7xospm.com1.z0.glb.clouddn.com/1d6a5b0d-e8e1-4916-8cb3-20817b85e24f_20141224135416343.png) 图中绿色的线为欧式距离的丈量长度，红色的线即为曼哈顿距离长度，蓝色和黄色的线是这两点间曼哈顿距离的等价长度。 想想我们下象棋的时候，车炮兵之类的，是不是要走曼哈顿距离？ 如果不会下象棋，没关系，看下面的例子： 在美国道路会像这样是很多的规则的网格状，从A到B通常无法去沿直线行走，而是会避开建筑物，走几个街区到达。 图中蓝色的线即为曼哈顿距离的典型应用场景。 _看看维基百科：http://en.wikipedia.org/wiki/Taxicab_geometry_ 3. 切比雪夫距离（Chebyshev distance）数学上，切比雪夫距离是将2个点之间的距离定义为其各坐标数值差的最大值。 ![](http://7xospm.com1.z0.glb.clouddn.com/5b836ab3-8f5d-4028-8f9b-7a05f6f60ea0_20141225150924640.png) 网上搜索，好多有关这个距离的解释，大多都是采用国际象棋中的王的走步来作为例子，王可以前后左右走，还可以斜前斜后走，一共8个方向可以认为距离均等。 也就是在下面3&amp;times;3邻域内，中心网格的中心点到8个邻域网格中心点的距离相等。 ![](http://7xospm.com1.z0.glb.clouddn.com/dc5d6004-2e66-40ca-838d-abe5136637a7_20141225150721218.png) _看看维基百科：http://en.wikipedia.org/wiki/Chebyshev_distance_","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Statistics","slug":"Spatial-Statistics","permalink":"http://www.kikitamap.com/tags/Spatial-Statistics/"}]},{"title":"镶嵌数据集工具小结（十一）分析、修复、同步镶嵌数据集","slug":"AnalyzeRepairMosaicDataset","date":"2014-12-09T07:40:37.000Z","updated":"2016-03-07T09:05:08.000Z","comments":true,"path":"2014/12/09/AnalyzeRepairMosaicDataset/","link":"","permalink":"http://www.kikitamap.com/2014/12/09/AnalyzeRepairMosaicDataset/","excerpt":"","text":"这是这个专题的最后一篇，将剩下的几个工具放在一起说一说。下面的这些工具在镶嵌数据集正常运行时常常会被忽略，但是一旦出现异常或者故障，这些工具就有了用武之地。 分析镶嵌数据集当我们发现镶嵌数据集不能按照预期运行，或者性能比较差的的时候，可以使用工具 Analyze Mosaic Dataset 来分析检查存在的问题。这个工具可以发现常见问题、发出警告消息，并且给出些解决方法或者建议等。另外，当在 ArcMap 中镶嵌数据集图层的右键菜单也可以调用这个工具。 分析之后，在 Prepare 窗口中列出检查到的 Error，Warning，Message等，在列表的每一行上右键，都会打开相应的解决方法或者建议。 使用分析镶嵌数据集工具，我们可以分析的对象有： FOOTPRINT — 镶嵌数据集的轮廓线FUNCTION—镶嵌数据集的栅格函数RASTER — 栅格数据PATHS— 分析是否存在损坏的路径SOURCE_VALIDITY— 对源数据的潜在问题进行分析。此方法可以有效检测同步工作期间可能发生的问题。STALE — 分析镶嵌数据集项目是否过时PYRAMIDS — 栅格数据金字塔，测试金字塔是否有断开连接的辅助文件。STATISTICS — 栅格统计数据和直方图PERFORMANCE — 对性能相关的问题进行分析。例如，传输期间未压缩，或建议对涉及大量栅格函数的项目进行项目缓存。INFORMATION — 对镶嵌数据集及其项目进行分析，并会为分析结果生成信息日志。 计算脏区Compute Dirty Area 工具用于标识镶嵌数据集中在指定时间点之后发生更改的区域。 工具的输出结果为面要素类，在面要素类区域以内就是发生变化的区域。工具支持较多的时间格式的输入，参考工具内部格式样例填写即可。 镶嵌数据集的路径我们知道镶嵌数据集中存储的是栅格数据源的引用信息，而不是栅格数据源本身。当我们复制或者移动镶嵌数据集到其他位置时，镶嵌数据集中的引用信息并没有发生变化。 有时，在同一台机器上，由于源数据的绝对路径没有变化，因此即使挪了镶嵌数据集的位置，也没有什么影响。但是如果是把镶嵌数据集移动或者复制到另一台机器上，或者其他原因源栅格数据的路径发生了更改，那么我们要做的就是更新或者说修复路径。 如果我们需要知道镶嵌数据集现在使用的数据源，使用 Export Mosaic Dataset Paths 工具可以将镶嵌数据集引用的路径信息导出成一张表。也可以仅将损坏的路径导出。 然后使用工具 Repair **Mosaic Dataset Paths* 对路径进行修复，如果要更改所有路径，可输入星号 () 作为原始路径。 同步镶嵌数据集工具 Synchronize Mosaic Dataset 可以将镶嵌数据集保持为最新状态。要理解同步镶嵌数据集，理解镶嵌数据集内数据的组织方式非常重要。 1）最常见的是直接引用栅格数据的镶嵌数据集。这种镶嵌数据集与源数据有直接关系，可以称之为“源镶嵌数据集”。 2）镶嵌数据集的数据源还可以是另外一个镶嵌数据集，也就是在创建镶嵌数据集后，添加数据的数据源是另外一个镶嵌数据集。这种可以称之为“派生镶嵌数据集”，帮助理解。当源镶嵌数据集发生变化时，为了保持派生镶嵌数据集最新，同步镶嵌数据集就非常重要了。 PS：在第一篇中提到过 “引用镶嵌数据集 / Referenced Mosaic Dataset” ，这是一种特别的镶嵌数据集，与上文要表达的 “派生镶嵌数据集” 不是一种哦。 同步镶嵌数据集是个单向操作，其中源数据中的更改可以同步到镶嵌数据集的属性表，但属性表中的更改将不会影响源数据，同步时所做的更改无法撤消。。应该在同步派生镶嵌数据集之前同步源镶嵌数据集，因为派生镶嵌数据集只能使用源镶嵌数据集中的信息进行更新。 同步镶嵌数据集工具中有一系列的参数可供配置，来细化控制参与同步的想，所见即所得，不再赘述。 更改镶嵌数据集方案Alter Mosaic Dataset Schema 工具通过生成所需的表或字段准备 ArcSDE 中镶嵌数据集的方案。该工具可防止在 ArcSDE 中存储镶嵌数据集时可能发生的方案锁定问题。 只有在 ArcSDE 中创建镶嵌数据集，而且由非数据集所有者编辑镶嵌数据集时，才需要此工具。 在工具中，选择该镶嵌数据集所允许的操作。这将创建所需的必要表。如果非数据集所有者尝试执行不允许的操作，则操作会失败。 操作选项：ANALYSIS，BOUNDARY，CACHE，COLOR_CORRECTION，LEVELS，LOG，OVERVIEW，SEAMLINE，STEREO，VIEW 选择该镶嵌数据集所允许的栅格类型。这将创建所需的必要字段。如果非数据集所有者使用添加栅格至镶嵌数据集工具并尝试使用该工具未指定的栅格类型，则添加栅格至镶嵌数据集的执行将会失败。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"镶嵌数据集工具小结（十）函数链","slug":"FunctionChain","date":"2014-12-04T08:22:10.000Z","updated":"2016-03-07T09:43:10.000Z","comments":true,"path":"2014/12/04/FunctionChain/","link":"","permalink":"http://www.kikitamap.com/2014/12/04/FunctionChain/","excerpt":"","text":"镶嵌数据集中的函数 在下文中会提到的工具有这几个，先摆在这里，有个初步的记忆： 这个主题中，一起来看一下镶嵌数据集的函数。 ★ 不过首先需要额外了解，在 ArcGIS 中，其实除了镶嵌数据集，普通的栅格数据集也可以使用函数，这并不仅仅是镶嵌数据集的特性。在 Image Analyst 窗口中，我们可以点击 fx 按钮给现有数据配置函数。 例如，下面给DEM增加个临时的山影效果，而不需要在硬盘上去存储这个结果： 在栅格数据上使用函数后，我们就可以直接查看函数作用后的结果栅格图层。在镶嵌数据集中创建的函数可以存储在数据库中，并且可以根据自己的需求，给栅格数据指定多个依次进行的函数，下一步的函数会使用上一步的函数的结果作为输入，称之为 函数链（Function Chain），一环扣一环，很形象。 给镶嵌数据集整体进行函数运算好处就是整体连续，如果我们每幅进行各自函数运算然后镶嵌，就会发现数据是不连续的片状。 我们在镶嵌数据集的属性窗口中可以看到 Function 选项卡，这就是配置函数链的主要的位置。 如果我们在建库的时候选择某种 产品定义（Product Defination），在镶嵌数据集内部镶嵌数据集项目的也会存在函数链。 ArcGIS 提供了很多可以用于栅格处理的函数，在 Web Help 文档中有每个函数的详细描述，这里我就不一一整理了。Web Help当工具书用，还是十分便利的，大家自可按需查询，点这里。 镶嵌数据集工具箱中有这样几个工具，涉及到了函数，就联合上面的内容一起说说，从整体的总结来看，正文才刚刚开始…… 前面说过了，我们可以直接在镶嵌数据集上右键，Function 选项卡中增加、删除、修改函数链，我们也可以使用工具 Edit Raster Function 。 如果没有特别的要使用 Model Builder或者脚本等调用这个工具，个人建议可以直接到属性中去修改，操作起来更方便直观。这个工具提供了 Insert、Replace、Remove三种修改选项，可以将 栅格函数模板文件(.rft.xml) 通过操作应用给镶嵌数据集，这种文件可以在 Function Template Editor 中保存获得。 举个最简单的例子，前面用了山影函数，现在我需要换成地貌晕染函数，执行下这个工具，导入现有的函数模板替换掉即可。 接着第二个相关的工具&nbsp;Build Mosaic Dataset Item Cache，这个工具是把 “Cached Raster Function” 函数插入到每个栅格数据函数链的顶部，这样该函数就成为链中最后实现的函数。一般是涉及到运算量较大的处理过程时，这样做可以提高性能。 在这个工具中，我们可以定义、生成缓存、指定缓存的存储位置。默认情况下，会在镶嵌数据集所处位置旁的文件夹中生成和存储缓存。此文件夹的名称与地理数据库的名称相同，但扩展名为 .cache。但是，如果镶嵌数据集创建于 ArcSDE 地理数据库，则将在该地理数据库中创建缓存。 如果我们想得到函数链处理之后镶嵌数据集中的各个栅格数据，就可以使用工具 Export Mosaic Dataset Items。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"镶嵌数据集工具小结（九）计算像元大小范围","slug":"MDCellRange","date":"2014-11-28T07:41:03.000Z","updated":"2016-03-09T01:54:30.000Z","comments":true,"path":"2014/11/28/MDCellRange/","link":"","permalink":"http://www.kikitamap.com/2014/11/28/MDCellRange/","excerpt":"","text":"计算像元大小范围 像元大小范围指的是，镶嵌数据集中的影像参加动态镶嵌的像元大小范围，也就是，动态镶嵌的过程中从栅格数据集中读取的像元大小的范围。 在镶嵌数据集的属性表中，字段 LowPS 列和 HighPS 列定义镶嵌数据集从源栅格数据集中读取的像元大小的 实际范围。当我们向镶嵌数据集中添加栅格时，工具会根据源栅格数据分辨率、金字塔等级、金字塔选项中的设置 来计算属性表中 LowPS 与 HighPS 字段值。例如，下图中的 LowPS = 0.1 表示基础像素值，High = 0.4 表示正在使用的顶级金字塔像素值。对于不包含金字塔的栅格数据集，低像素大小和高像素大小可能为相同的值，例如第一行。 例如，在使用所有金字塔等级的情况下，如果栅格数据集包含 1 米的像元，且包含像元大小为 2、4、8 和 16 米的金字塔，则 LowPS 是 1，HighPS 是 16。如果在栅格金字塔选项中将最大像元大小设置为 8，则 HighPS 将为 8 而不是 16。 属性表中还有两列：MinPS 列和 MaxPS 列，用来定义在什么像元大小范围内请求什么栅格数据。当我们向镶嵌数据集中添加栅格数据时，选中添加栅格至镶嵌数据集对话框上的 Update Cell Size Ranges (optional) 选项，或使用工具 Calculate Cell Size Ranges 时，就会填充两列字段值；也可以手动编辑表中的值。MinPS 和 MaxPS 是根据栅格数据和叠加在上面的概视图来计算的。 用下面一幅图，可以看出默认情况下，MinPS，MaxPS 与 LowPS，HighPS 的关系： 当加入镶嵌数据集的栅格数据源有多种分辨率时，就可以利用像元大小范围来控制不同比例尺下显示不同的栅格数据。 例如，在国家级别查看影像，可以使用 Landsat 影像，约 30 米的像元大小；当放大到更高的比例，镶嵌数据集可以提供 SPOT 图像，像元大小约 5 米；进一步放大时，最终将看到航空正射影像，像元大小更小，分辨率更高。 比例尺和像元大小有很大的关系，如果我们希望求取计算的话，可以参考如下公式： Scale = CellSize * 96 / 0.0254 其中，ArcGIS 中 DPI 的默认值为 96，1 英寸（Inch） = 0.0254米，CellSize是以“米”为单位的。 公式反之，可以通过比例推算像元大小： CellSize = Scale * 0.0254 / 96 如果我们访问镶嵌数据集时，不断的放大地图，最终请求的影像的 Cell Size 小于了全部的 MinPS，那么就会请求失败，不再会返回影像；反之，如果我们不断的缩小地图，最终请求的Cell Size 大于了全部的的 MaxPS，那么也会请求失败，返回黑色和白色的棋盘状图案。也就是说，镶嵌数据集的像元大小范围会直接影响我们在缩放地图时影像数据的可见性。 That’s all …","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"镶嵌数据集工具小结（八）色彩平衡与接缝线 Ⅱ","slug":"MDColorBalance2","date":"2014-11-20T09:26:05.000Z","updated":"2016-03-09T02:45:34.000Z","comments":true,"path":"2014/11/20/MDColorBalance2/","link":"","permalink":"http://www.kikitamap.com/2014/11/20/MDColorBalance2/","excerpt":"","text":"镶嵌数据集的色彩平衡 创建接缝线在对镶嵌数据集进行镶嵌的时候，有时还会用到接缝线（Seamline）。在前面总结过镶嵌数据集的镶嵌方法，其中最后一种是 Seamline 镶嵌方法。在创建接缝线之前，建议先进行色彩平衡，因此就拿到这里一起说。 当我们把镶嵌方法选为了 Seamline 镶嵌方法时，Seamline 就会替代 Footprint 来作为每幅栅格数据的边线。这样会让接缝更自然，镶嵌数据集看起来会更像是无缝的一整张栅格数据。如果为镶嵌数据集创建了接缝线，还有个好处就是，我们可以根据需要去编辑接缝线，例如有的接缝线刚好穿过一个建筑物，我们就可以尽可能让边线绕过建筑物，让影像看起来拼接的自然美观一些。 工具Build Seamlines用来为镶嵌数据集创建接缝线的。Seamline 与 Footprints 类似：每个面表示一个图像。面的形状表示查看镶嵌数据集时将用于生成镶嵌图像的那部分图像。构建了 Seamline 之后，ArcMap 中显示镶嵌数据集时，会又多了一个图层 Seamline。根据镶嵌方法，等级值将存储在属性表的 SOrder 字段中。 下面就一起看看这个工具的使用方法： Computation Method 构建接缝线，有五种计算方法可选：GEOMETRY ,&nbsp;RADIOMETRY , COPY_FOOTPRINT ,&nbsp;COPY_TO_SIBLING ,&nbsp;EDGE_DETECTION&nbsp;。 为了更直观的认识上面构建接缝线的方法，我还是用个简单的数据来说明问题： 数据是按照北西方法镶嵌，加上Footprint是这样的： Geometry / 几何—— 根据当前的排序方法和Footprint来生成接缝线。通过这种方法生成的接缝线一眼就知道了栅格数据之间的压盖关系，并且接缝线（面）之间没有要素压盖。 Radiometry/ 辐射度—— 通过检查相交区域的值和样式来构建接缝线，接缝线是Footprint交点之间的折线。这种方法拼接的影像看起来更自然一些。 Copy_footprint/复制轮廓—— 这种方法的接缝线只是相应轮廓线的副本。 Copy_to_sibling/复制到同类—— 此方法将已有的接缝线复制到与其组名相同的同类要素中。这种方法常常用于全色波段与多光谱波段范围不同的卫星影像，从而确保它们共享相同的接缝线。&nbsp;这里没有合适的数据，不放图了。 Edge_detection/边缘检测—— 对相交区域应用边缘检测过滤器，以确定该区域中要素的边。然后，沿检测到的边创建接缝线。这种方法创建的接缝线也很漂亮和自然。 举个例子，看下面的影像边界是不是扎眼？ 使用边界探测方法创建接缝线后，一条沿着马路的折线（面的边界）产生了。 使用 接缝线方法拼接后就更加自然了。 Sort Method 默认情况下，Seamline 排序是使用 “North-West” 镶嵌方法生成的。还可以选择使用 “CLOSEST_TO_VIEWPOINT&nbsp;” 或 “BY_ATTRIBUTE&nbsp;” 镶嵌方法来创建接缝线。这与前面说的镶嵌方法的理念是一样的，不再啰嗦了。 Cell Size 像元大小用于确定要生成接缝线时的栅格大小。 通常用在镶嵌数据集中存在多种数据分辨率并且只想为一个等级生成接缝线的情况。例如，如果将高分辨率数据源与低分辨率数据源进行混合，则可指定适合其中一个数据源范围的像元大小。如果存在多个 LOWPS（低像素大小）值，或者不确定要指定哪个像元大小，可将此参数留空。该工具将自动在适当的等级上创建接缝线。此参数的单位与镶嵌数据集的空间参照单位相同。 沿接缝线混合（羽化） 可以定义沿接缝线发生的混合的混合值（羽化）和类型，混合发生在接缝线上有重叠栅格的像素之间。 Blend Width Units 定义混合宽度的单位。默认是 PIXELS（像素）；还可选择 GROUND_UNITS，也就是也镶嵌数据集的单位相同。 Blend Width 混合宽度定义要混合的像素数目。 Blend Type BOTH，INSIDE，OUTSIDE 三种混合类型。 例如：如果“混合宽度”值为 10，且使用 BOTH 作为混合类型，则将在接缝线的内部和外部分别混合 5 个像素。如果该值为 10，且混合类型为 INSIDE，则将在接缝线的内部混合 10 个像素。 Request Size Type PIXELS — 将根据像素大小修改请求大小。根据栅格像素大小对最近图像进行重采样。 PIXELSIZE_FACTOR —将根据像素大小因子修改请求大小。通过将像元大小等级表（Level Table）中的 &nbsp;Cell Size 与 Pixel Size Factor 相乘对最近图像进行重采样。 Request Size 此参数决定对栅格进行重采样的大小，用于定义行列数。最大值为 5000。可以基于栅格数据的复杂程度增大或减小该值。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"镶嵌数据集工具小结（七）色彩平衡与接缝线 Ⅰ","slug":"MDColorBalance1","date":"2014-11-17T03:38:05.000Z","updated":"2016-03-09T06:05:00.000Z","comments":true,"path":"2014/11/17/MDColorBalance1/","link":"","permalink":"http://www.kikitamap.com/2014/11/17/MDColorBalance1/","excerpt":"","text":"镶嵌数据集的色彩平衡与接缝线 Ⅰ 色彩平衡 镶嵌数据集一般由多张影像组成的，各幅影像可能由于各种原因存在色彩差异，例如航摄时的天气、光线等原因。为了让整个镶嵌数据集看起来是无缝的一整张，而不是一片一片的，我们需要做的就是色彩校正，或者叫做色彩平衡（均衡）。也就是实现下面的效果： 做色彩校正之前，需要检查原始数据的所有波段是不是满足下面几个条件： 所有波段已经创建统计值（包括直方图）； 所有栅格数据集具有相同的波段数； 所有栅格数据集的像素类型和像素深度都相同（只支持 8 位无符号和 16 位无符号位深度）； 所有栅格数据集都没有关联的色彩映射表。 Color Balance Mosaic Dataset 工具用于实现镶嵌数据集的色彩平衡。Balance Method工具提供了三种匀色的算法： 匀光/Dodging 这是传统的匀光摄影测量方法。 如果选择“匀光/Dodging”，需要同时选择目标颜色表面类型 。此方法会参照目标颜色来更改每个像素值，使图像均匀过渡到目标颜色。多数情况下，匀光平衡效果最佳。 SINGLE_COLOR — 所有像素都参照一个单色点（即，平均值）进行匀光处理。 COLOR_GRID — 所有像素都参照分布在整个镶嵌数据集中的多组点进行匀光处理。 FIRST_ORDER — 所有像素都参照从二维多项式倾斜平面获取的多个点进行匀光处理。与“颜色格网”表面相似。 SECOND_ORDER — 所有像素都参照从二维多项式抛物线/双曲线/椭圆表面获取的一组多点进行匀光处理。与“颜色格网”表面相似。 THIRD_ORDER — 所有像素都参照从三次表面获取的多个点进行匀光处理。 PS： 当栅格数量较少且地物类型较少时，单色表面会取得良好的效果。如果栅格数据较多或者地物类型较多时，这种方法输出颜色可能会变得模糊。 如果有大量的栅格或区域含有大量的地面物体类型，这种方法会产生非常好的输出效果。 First Order，Second Order, Third Oder 这三种方法与“颜色格网”表面相比，多项式阶表面的颜色变化通常更为平滑，并且使用的辅助表存储空间更少，但往往需要花费更长的时间进行处理。 直方图/Histogram 此方法将根据目标直方图更改各像素值。可基于所有栅格自动计算目标直方图，也可以指定一个目标栅格。当镶嵌数据集中的所有栅格的直方图形状都相似时，直方图平衡会取得较好的效果。 标准差/Standard Deviation 此方法将根据标准差计算更改每个像素值。可基于所有栅格或指定的目标栅格自动计算标准差值。当镶嵌数据集中的所有栅格的正态值具有相同的直方图分布时，标准差平衡的效果最好。 Target Raster上面三种方法中所使用到的数值，既可以来源于镶嵌数据集自身，也可以来源于自己指定的目标栅格。 不同的色彩平衡方法： 使用匀光平衡时，得出的目标颜色取决于当时所选择的目标颜色表面类型。 对于 SINGLE_COLOR，将使用参照目标图像的平均值。 对于 COLOR_GRID，会将参照目标图像重采样为适合的格网。 对于 多项式阶表面，通过最小二乘拟合从参照目标图像获得多项式的系数。 使用直方图平衡时，将基于参照目标图像获得目标直方图。 使用标准差平衡时，将基于参照目标图像获得目标标准差。 Block Filed从镶嵌数据集的属性表中指定一个用于“分组”的字段，在执行计算和操作时，用于标识应被视为单一项目的多个项目。 预处理选项 在执行栅格数据集色彩平衡之前，工具会先执行预处理选项。 Exclude Area Raster 用于排除不能或者难于进行色彩校正的区域，例如：水、云和异常区域等。本质上就是创建一个掩膜，从而从镶嵌数据集色彩校正算法中排除一些像素。 PS： 对镶嵌数据集进行色彩校正时，排除区域并不会经常用到。只有当存在较难校正的区域，且不希望因为这些问题区域产生偏差时，可创建排除区域。另外，像素分布中的极值（极低像素值和极高像素值）区域也可能成为色彩校正的问题区域。 那如何生成这个排除区域栅格呢？ 工具箱中提供 Generate Exclude Area 工具，下面就来看看这个工具。 通过输入数据选择 位深 和 生成 方法： Pixel type： 此参数用于选择输入栅格数据集的像素深度。像素深度非常重要，因为需要对所有 8 位以上的像素深度调整色彩掩膜和直方图值。 8_BIT — 0 到 255 之间。这是默认值； 11_BIT — 0 到 2047 之间； 12_BIT — 0 到 4095 之间； 16_BIT — 0 到 65535 之间。 Generate Method： 提供了两种方法：COLOR_MASK ，HISTOGRAM_PERCENTAGE COLOR_MASK — 可以设置要在输出中排除的最大颜色值。这是默认设置。 HISTOGRAM_PERCENTAGE — 可以设置像素的最小和最大直方图百分比。 Stretch Type 如果我们指定的了拉伸类型，那么就意味着在色彩平衡的过程中，使用的是栅格数据拉伸后的值，而不是栅格数据的原始像元值。 NONE — 不应用预拉伸。这是默认设置。 ADAPTIVE — 自适应预拉伸。 MINIMUM_MAXIMUM — 最小值-最大值预拉伸。 STANDARD_DEVIATION — 标准差预拉伸。 Gamma 当选择了标准差拉伸或最小值-最大值拉伸时，可以额外的设置Gamma值。可通过应用 Gamma 拉伸来控制图像的整体亮度。如果 Gamma 系数设置得太低，中间色调将太暗；而如果 Gamma 系数设置得太高，中间色调又会太亮。Gamma 系数不仅会改变图像的亮度，还会改变红绿蓝之间的比率。 如果对色彩校正的不满意，我们也可以移除效果，镶嵌数据集的右键菜单中，Remove – Color Balancing。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"镶嵌数据集工具小结（六）镶嵌数据集的属性 Ⅲ","slug":"MDProperties3","date":"2014-11-11T06:31:11.000Z","updated":"2016-03-09T06:58:58.000Z","comments":true,"path":"2014/11/11/MDProperties3/","link":"","permalink":"http://www.kikitamap.com/2014/11/11/MDProperties3/","excerpt":"","text":"设置镶嵌数据集属性工具 Ⅲ 这一篇接着，再接着，说这个参数无比巨多的工具 Set Mosaic Dataset Properties， 看看其中的 Catalog Item Properties 对应的各个参数的作用 。 元数据级别 Metadata Level 参数用于定义从服务器到客户端的元数据传输量。如果要传输大量元数据，此属性将会影响传输时间，因此可选择对其进行限制。 通过下面三个选项，选择发布镶嵌数据集时从服务器提供给客户端的元数据级别： FULL —所有元数据将被传输，包含基本栅格数据集信息及函数链的详细信息。这是默认设置。 BASIC —将传输栅格数据集级别信息，比如列和行、像元大小和空间参考信息。 NONE —不提供任何元数据给客户端。 允许传输的字段 Allowed Transmission Field 参数列表，定义将镶嵌数据集作为服务提供时属性表中对客户端可见的字段。 默认情况下，此列表包括字段：Name, MinPS, MaxPS, LowPS, HighPS, Tag, GroupName, ProductName, CenterX, CenterY, ZOrder, Shape_Length, Shape_Area。如果镶嵌数据集中包含自定义字段，这个列表中除了上面的字段，还会出现自定字段。 许是否启用时间 如果镶嵌数据集包含定义时间的属性字段，可创建自动具有时间感知性的镶嵌数据集。 如果激活了时间，则需要指定与时间有关的其他参数——起始和结束字段，以及时间格式。建议将时间值存储在日期字段中，但也支持字符串和数值字段。 地理变换方法 如果镶嵌数据集的坐标系统不同于源栅格数据坐标系统，则可能需要指定特定的地理变换方法。通过 Geographic Transformation 参数列表选择地理变换。 可下载的最大项目数 Max Number of Download Items 参数用来限制客户端可从影像服务中下载的栅格数量。该值会影响系统负荷。 如果不希望客户端从镶嵌数据集内下载任何栅格，可将其设置为 0。另外注意，Grid格式数据源的镶嵌数据集不能下载。 返回的最大记录数 以影像服务的形式查看镶嵌数据集时，Max Number of Records Returned 参数用来限制，针对客户端每个请求，服务器返回的记录数。 最小像素作用 只看中文名字让人有点晕，实际上 Minimum Pixel Contribution 参数用于指定镶嵌数据集中的项目需要至少具有多少像素才能在镶嵌数据集中使用。默认值为1个像素。 我们可以设置合理的值，这样镶嵌数据集会跳过所有像素量不够大的栅格项目。跳过这些镶嵌数据集项目将有助于提高镶嵌数据集的计算或显示性能。这在大量叠置栅格只具有少量像素时尤其有用。 但是，同时需要知道，较大的值可能减少重叠项目成为感兴趣区组成部分的可能性；这会导致您的镶嵌数据集的某些区域空白。 特别需要注意的是，镶嵌数据集的属性中有其他两项属性与这个选项可能存在矛盾关系，因此，此属性仅在 始终将栅格裁剪至其轮廓 设置为“是”，并且 轮廓线可能含有 NoData 设置为 否 时有效。否则可能会无视这个选项。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"镶嵌数据集工具小结（五）镶嵌数据集的属性 Ⅱ","slug":"MDProperties2","date":"2014-11-10T07:40:11.000Z","updated":"2016-03-09T07:18:58.000Z","comments":true,"path":"2014/11/10/MDProperties2/","link":"","permalink":"http://www.kikitamap.com/2014/11/10/MDProperties2/","excerpt":"","text":"设置镶嵌数据集属性工具 Ⅱ 这一篇接着说这个参数无比巨多的工具 Set Mosaic Dataset Properties ，镶嵌属性这一组参数会控制多幅影像的拼接方式和顺序等。 如果我们的多幅影像的数据源之间没有重叠，那么拼接顺序就没有什么值得设置的。但是我们一般拿到的航片、卫片等都是有重叠的，不同的镶嵌规则会让数据在拼接出现差异，我们设置这一组参数来控制影像的拼接方式和顺序等。 Mosaic Methods（镶嵌方法）** 在“允许的镶嵌方法”中我们可以选择影像的镶嵌方法，从而控制用户访问镶嵌数据集时可以使用哪些方法。同时，可以设置一种方法作为默认方法。 None 根据镶嵌数据集属性表中的顺序 (ObjectID) 对栅格进行排序。 Center - 根据栅格中心与视图中心的距离对栅格进行排序，与视图中心距离越小，栅格的默认次序越靠前。 NorthWest - 中心越靠近西北的栅格显示的位置越靠上。 LockRaster - 允许用户根据 ObjectID 锁定单个或多个栅格数据的显示。 ByAttribute - 根据已定义的元数据属性及其与基值的差对栅格进行排序。 Nadir - 根据像底点位置和视图中心的距离对栅格进行排序。此方法与“Center”方法类似，但使用的是栅格的像底点，像底点可以不是中心点，尤其是在倾斜的影像中。 Viewpoint - 使用“视点”工具根据用户定义的位置与栅格的像底点位置对栅格进行排序。 Seamline - 使用预定义的接缝线形状分割栅格（可以选择是否沿接缝线使用羽化功能）并根据属性表中的 SOrder 字段对影像进行排序。 假设我现在有这样9幅影像数据源的镶嵌数据集，可以把他们理解成9张卡片。看图比看例子更容易理解，下面通过一个例子来了解各种镶嵌方法，前提是我们都是用升序排序和使用默认的 First 镶嵌运算符。 ★ 选在None方法，默认使用了数据的存储顺序作为镶嵌顺序，也就是 ObjectID 的顺序。图中的数字即使各幅影像的 ObjectID，数字越靠前，镶嵌的也就越靠前。 ★ 选择 Center 方法，中心的影像最优先： ★ 选择 NorthWest 方法，我们看到位于西北角的 7 获得了最优先的镶嵌顺序，反之，东南角的9排在最后： ★ 选择 Lock Raster 方法，允许客户端可以指定某些栅格数据，这样仅对被锁定的栅格进行显示： ★ 选择 ByAttribute 方法，需要指定 Order Field ，例如按照自定义字段 MyOrder 排序： 如果您的字段是数值或日期字段，则可以设置排序基础参数（_OrderBase）。可以根据此值与 Order_Field 中的其他值之间的差异对影像进行排序。 还可以指定排序是升序还是降序。 ★ 选择 Nadir 方法，类似于 Center 方法，只是像底点距离整个视图中心的距离成为镶嵌的标准： 如下图，点A即为像底点（nadir），在垂直摄影测量中，影像中心点和像底点可能是重合的： 此方法与“Center”方法类似，但使用的是栅格的像底点，像底点可以不是中心点，尤其是在倾斜的影像中。 ★ 选择 Viewport 方法，可以使用“ViewPoint”工具根据自定义的位置与栅格的像底点位置对栅格进行排序。 ViewPoint 是个隐藏工具，我们可以在自定义菜单中找到并添加出来： 打开 Viewpoint 窗口之后，我们就可以自定义视点，视点的位置将会影响栅格数据的镶嵌顺序，如下图。 在设置镶嵌数据集属性的时候，参数 View Point Spacing X 与 View Point Spacing Y 会影响 ViewPoint 对话框中的箭头按钮的偏移量，偏移量的长度单位是当前空间参考决定的。 ★ 选择 Seamline 方法，使用预定义的接缝线形状分割栅格，并且可以选择是否沿接边使用羽化功能。在生成接缝线的过程中对排序进行预定义。使用此镶嵌方法时，镶嵌运算符 LAST 无效。 镶嵌数据集的接缝线可以通过 Build Seamlines 工具来创建，这个工具后面会单独的总结一下。这里就不罗嗦了。 Mosaic Operator（镶嵌运算符）镶嵌运算符用于确定如何解析重叠像元。 First 重叠区域中所列出的第一个栅格数据集中的像元。 Last 重叠区域中所列出的最后一个栅格数据集中的像元。 Min 重叠区域中包含所有重叠像元中的最小像元值。 Max 重叠区域中包含所有重叠像元中的最大像元值。 Mean 重叠区域中包含所有重叠像元的平均像元值。 Blend 重叠区域是镶嵌影像中沿各栅格数据集边缘重叠的像元值的混合。默认情况下，各栅格的边由轮廓线或接缝线定义。 Sum 重叠区域中包含所有重叠像元的像元值总和。 Blend Width（混合宽度） 当在上述方法中，定义混合（Blend）镶嵌运算符所使用的像素距离。 跨越边界时此值将分成两半；因此，如果该值为 40，则将在轮廓线内部混合 20 像素，在轮廓线外部混合 20 像素。 如果存在接缝线，可以在接缝线表中定义每个接缝线的混合宽度和类型，从而覆盖此值。 除了镶嵌方法以及有关的这些参数，镶嵌属性的设置参数中还包含了其他一些与镶嵌有关的参数，放在下面以便参考： Max Number Per Mosaic（每个镶嵌图的最大栅格数） 这个参数是为了镶嵌数据集镶嵌过多栅格数据，默认值为 20。 例如，在没有创建概视图时，不希望让机器耗费资源过多的去镶嵌栅格数据。但是这种情况下，很可能20幅图像不足够观看，如果你的机器硬件过硬，这个数字也可以适量调大。这个参数相当于性能与体验的博弈，在没有概视图的时候可以自己尝试设置。 Cell Size Tolerance Factor （像元大小容差系数） 用于控制具有不同像素大小的镶嵌数据集项目在某些操作（例如镶嵌或接缝线生成）中的分组方式。 系数 0.1 表示所有比最低像素大小高百分之十的 LowPS 值都被视为相同的值。此值必须大于或等于 0.0。可在等级表中查看结果。 Output Cell Size（输出像元大小） 镶嵌数据集的像元大小一般是自动计算的，我们也可以进行自定义。这个参数用于自定义指定镶嵌数据集的像元大小，可选择图层作为像元大小模板，也可指定实际像元大小。如果指定像元大小，可以将单个值用于方形像元大小，或者将 X 值和 Y 值用于矩形像元大小。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"镶嵌数据集工具小结（四）镶嵌数据集的属性","slug":"MDProperties","date":"2014-10-29T07:00:24.000Z","updated":"2016-03-09T07:34:48.000Z","comments":true,"path":"2014/10/29/MDProperties/","link":"","permalink":"http://www.kikitamap.com/2014/10/29/MDProperties/","excerpt":"","text":"设置镶嵌数据集属性工具 我们可在镶嵌数据集属性窗口看到 General，Default，Key MetaData 三个选项卡。 General 中包含了类似单个栅格数据集的属性信息，例如像元大小、像元类型、位深、范围等等信息，详情可以戳 这里，不再赘述； Default 选项卡中包含了一些镶嵌数据集所特有的属性，这些属性将会影响客户端查看镶嵌数据集的显示方式和交互方式； 如果为镶嵌数据集定义了产品定义，则 Key Metadata 将来自产品定义，Key Metadata 包含了用于渲染和一些处理过程的波段和波长信息。 ★ 需要注意的是，如果我们在图层列表中去修改镶嵌数据集的默认属性，这种修改不会存储到镶嵌数据集内部，因此当移除图层，这些设置就失效了。图层上的修改，一般用于临时查看修改效果，或者多个用户访问镶嵌数据集，并且希望自己的修改不影响到其他人。 而我们在Catalog中，镶嵌数据集的属性中设置的属性是存储在镶嵌数据集中。 需要了解Default 选显卡中各个属性项的作用和对镶嵌数据集的影响，非常详细的说明就戳 这里，注意其中部分参数仅适用于镶嵌数据集作为 Image Service 发布和访问的情形。 在工具箱中提供了一个可以设置这些属性的工具 Set Mosaic Dataset Properties 关于这个工具，我就结合镶嵌数据集属性来说明各个参数的作用和适用情况。由于这是一个很多很多参数的工具，这一篇先说说影像属性部分的参数吧。 影像属性 Maximum Size Of Requests： 控制每次生成镶嵌影像时的最大行数和列数。仅当将镶嵌数据集作为影像服务而发布和访问时，此属性才适用。 Allowed Compression Methods： 定义将镶嵌影像从服务器传输到客户端时所使用的压缩方法。如果通过 LAN 访问影像服务，即使数据量很大也不会引发问题。但通过速度较慢的 Internet 连接访问时，最好在传输前对影像进行压缩。压缩会减小传输影像的大小，但服务器需要先对数据进行压缩，因而增添了额外负荷。如下是几种压缩方法的整理： None —— 不压缩影像，这可以提供最高质量的影像，但是在网络中需要传输的数据量最大。 LZ77 —— 一种高效的无损压缩方法，推荐用于具有相似像素值（离散数据）的影像，例如扫描的地图或分类后的影像。 JPEG —— 一种高效的压缩方法，它通常可将影像压缩三至八倍，但在影像质量上有轻微损失。如果选择 JPEG 方法，也可通过输入 0 至 100 之间的任意值来编辑质量。值 80 提供大约 8 倍的压缩，通常能够保证影像质量。 LERC —— 一种高效的有损压缩方法，推荐用于具有较大像素深度的数据（如浮点型、32 位、16 位或 12 位数据）。选择此方法时，需要指定代表每个像素所适用的最大错误值的质量值。该值以镶嵌数据集的单位指定。例如，如果误差为 10 厘米而镶嵌数据集的单位为米，则输入 0.1。对于浮点型数据，LERC 比 LZ77 的压缩效果好 5 到 10 倍，压缩速度快 5 到 10 倍；对于整型数据，LERC 的压缩效果和压缩速度更优于 LZ77。使用整型数据并且指定的错误限制为 0.99 或更低时，LERC 相当于无损压缩。 Default Resampling Method： NEAREST —— 使用最邻近采样法可获得较精确的辐射度值。这种方法通常速度较快，但会导致要素的边呈锯齿状。 BILINEAR —— 双线性插值法可提供较平滑的影像，但会导致某些影像被滤除掉。对于连续栅格数据，建议使用双线性插值法。 CUBIC—— 与双线性插值相比，三次卷积插值法生成的几何更加精确，但速度较之稍慢。 MAJORITY —— 众数法最适用于离散数据。 Clip to Footprint： 许多情况下，栅格和轮廓线是相同的，但当它们不同时，您可以指定是否裁剪栅格。 Footprints May Contain NoData： 指定镶嵌数据集的轮廓线是否包含 NoData 的像素。如果选择包含，可以确保footprint中不包含洞。 Clip To Boundary： 指定是否要裁剪镶嵌数据集的影像到边界，或显示整个镶嵌影像。 Color Correction： 设置是否启用为镶嵌数据集设置的色彩校正 Allowed Mensuration Capabilities： None — 不使用任何测量功能； Basic — 允许计算距离、点、质心和面积； Base-Top Height — 允许测量底部至顶层高度。要执行底部至顶层高度测量，需要有理多项式系数 (RPC) 信息. Base-Top Shadow Height — 允许测量底部至顶层阴影高度。要执行底部至顶层阴影高度测量，需要太阳方位角和太阳高程信息。 Top-Top Shadow Height — 允许测量顶部至顶部阴影高度。要执行此测量，需要太阳方位角、太阳高程和有理多项式系数 (RPC) 信息。 3D — DEM 可用时，可进行 3D 测量。 具体对应的测量工具，我们可以在 Image Analysis 窗口中使用。 有关影像测量这一块将来如果有时间会单独整理一下，这里不再插入了，不然篇幅过长了。_ Data Source Type： Generic - 通用类型，镶嵌数据集没有指定的数据类型。 Thematic - 镶嵌数据集为专题型，专题数据具有离散值。 Processed -镶嵌数据集已得到处理。镶嵌数据集的颜色已经过调整。 Evelation -镶嵌数据集包含高程数据。 琳琅满目的影像属性参数就说到这里，下一篇接着说设置镶嵌数据集属性中的镶嵌属性参数。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"镶嵌数据集工具小结（三）概视图/Overviews","slug":"MDOverviews","date":"2014-10-28T09:26:31.000Z","updated":"2016-03-09T07:57:10.000Z","comments":true,"path":"2014/10/28/MDOverviews/","link":"","permalink":"http://www.kikitamap.com/2014/10/28/MDOverviews/","excerpt":"","text":"定义/创建概视图类工具 这一贴，接着说镶嵌数据集的概视图（Overview），如果你对栅格数据集的金字塔有所了解，那就能立即理解概视图的作用。概视图实际上是对镶嵌数据集显示上的”抽稀“，通过重采样生成多层低分辨率的栅格，用与不同比例尺下显示镶嵌数据集。无论是金字塔还是概视图，它们的目的都是为了提高栅格数据的显示速度和减少CPU的运算，从而提升体验。 ArcGIS的帮助文档中有这样一幅图，可以很好的说明数据源、金字塔、概视图之间的关系： 如果不创建概视图，那么在显示镶嵌数据集的时候，ArcMap会以动态方式对整个数据集进行处理，这样可想而知，一个庞大的镶嵌数据集，会消耗大量系统资源，甚至可能使资源消耗殆尽。没有概视图，每缩放或者挪动镶嵌数据集，ArcMap都动态运算显示的区域，这是个效率很低的事情。有时有朋友遇到，加入的镶嵌数据集是漆黑一片，那么很可能是没有创建概视图。 如果我们尚未对栅格数据构建金字塔和统计数据，可以使用工具 Build Pyramids And Statistics 对镶嵌数据集内的栅格数据批量创建金字塔和概视图，然后再创建概视图。栅格数据的金字塔会减少镶嵌数据集需要创建的概视图数据量。如果加入镶嵌数据集的栅格数据是下面的两种情形，推荐优先创建栅格金字塔再创建镶嵌数据集概视图：（1）可以接合没有重叠区的，也就是可以不受镶嵌方法影像的（2）参数和镶嵌方法不需要更改的，需要动态处理的栅格数据。 用于生成概视图的工具有两种： Define Overviews 和 Build Overviews。 除了上面的两个工具之外，我们在向镶嵌数据集中添加栅格数据时，也可以勾选创建概视图，这样会使用默认设置构建概视图。如果我们不需要对Footprint做修改的时候，可以在添加栅格数据时勾选这个选项直接创建概视图。 Build Overviews这个工具可以定义缺失的概视图、更新及生成概视图。此工具支持镶嵌数据集的默认设置（也就是在Catalog中打开镶嵌数据集属性，在Default页签上的设置），但是在 ArcMap 中基于图层的设置对于这个工具是无效的。概视图的第一个级别在镶嵌数据集的全分辨率下创建，后续各个级别均在上一次生成的概视图级别基础上构建。工具中还有几个参数可以配置，用来满足不同构建概视图的需求。 工具默认会创建缺失的概视图，更新过期的概视图，如果有特别要求，可以按照下面的依据配置： -（1）如果我们向镶嵌数据集添加了新数据集，而没有定义新增的概视图时，需要勾选 Define Missing Overview Tiles。如果个别情况下，不希望为新增的数据定义和新建概视图，取消勾选这一项。-（2）如果我们已经定义了概视图，但是尚未生成，则需要勾选 Generate Missing Overview Images Only。-（3）如果基础栅格数据集发生更改或其属性进行过修改，会将概视图识别为过期的概视图（Stale Overview），最后一个选项就是来控制是否更新过期的概视图。例如，我们从当前数据集移除了一些栅格数据，或者修改了轮廓线，那么原来创建的概视图就标识为了过期的概视图，这时候如果需要更新，应该勾选这一项的。 Define Overviews如果创建概视图的默认设置不能满足我们的需要，我们还可以使用 Define Overviews 预先自定义配置： 定义Overview的写入位置： 默认情况下，会在镶嵌数据集所处位置旁的文件夹中生成和存储概视图。此文件夹的名称与地理数据库的名称相同，具有 .overview 扩展名。 如果镶嵌数据集创建于 ArcSDE 地理数据库，默认将在该地理数据库中创建概视图。 以Oracle为例，有关镶嵌数据集的信息存储在GDB_ITEMS 和 GDB_ITEMTYPES系统表中。创建该镶嵌数据集的用户的方案中可能还存储着 12 个其他的表。其中 ART、BND、CAT和LOG这四个表在使用创建的镶嵌数据集时创建；其他表则在首次执行要用到对应表的操作时生成。 AMD_NAME_OVR，这张表默认用来存储概视图。默认情况下，为镶嵌数据集创建的金字塔栅格存储在此表中。如果使用“定义概视图”工具更改概视图的存储位置，将不会填充此表。而是将指向概视图位置的指针存储在 AMD_&lt;NAME&gt;_CAT 表的 urihash 字段中。 定义Overview的边界范围： 默认情况下，在镶嵌数据集边界内的区域创建金字塔。 我们也可以根据一些特定的需要，来指定生成概视图的范围，范围可以来自栅格数据集的范围，矢量要素数据的外接矩形，或者手工指定四边的坐标范围。 定义Overview块参数： 像元大小：默认情况下，工具会自动计算用于生成概视图的基础像素大小。我们也可以从某一特定分辨率开始创建概视图。例如，数据量巨大的高分辨率栅格数据添加到镶嵌数据集中，实际上仅需要分辨率一般的整体拼接效果，那调整至合适的像元大小即可。 等级数目：此参数决定生成的金字塔等级数。例如，3 表示将生成三个Overview 等级。如果值留空或为 -1，则系统会生成最佳数量的概视图。 行、列数：可以通过定义最佳的行数和列数的方式来限制概视图的物理尺寸。我们需要考虑到：值越大，文件（块）尺寸也就越大，Overview区域对应的任意栅格数据发生变化时需要重新生成Overview的可能性也越大。该数值还会影响栅格数据集创建的概视图的数目。如果是一个较大的数值，则将生成较小数量的概视图文件（块）；如果是一个较小的数值，则会生成较多的概视图文件（块）。 概视图采样系数：可以通过概视图采样系数来控制栅格数据集创建的概视图的数目。此系数可以确定后续概视图的大小。例如，如果第一个等级的像元大小为 x，概视图采样系数为 3，则下一等级的概视图像元大小将为 3x。也就是，系数越大，生成的概视图就越少，但同时，这会影响镶嵌图像的显示速度。通常，概视图等级越多，显示的速度就越快，因为这减少了重采样的次数。您还可以控制是否在概视图生成中考虑栅格的金字塔。可能使用您不喜欢的重采样方法生成了原始金字塔，也可能由于某种其他原因而不需要使用任何金字塔。您可以选中定义概视图工具对话框中的“强制概视图切片参数”选项，这样将忽略所有栅格金字塔，并从大于栅格基础像素大小的系数开始定义概视图。例如，如果系数为 3，而基础像素大小或栅格为 1 米，则将以 3 米开始生成概视图。此外，您的镶嵌数据集可能由数据源大量混合而成，并且由于某种原因，您需要使用最开始的金字塔的一部分，而不是全部。您可以定义概视图开始位置的像素大小。 强制概视图切片参数：这个参数用于控制在概视图生成中是否考虑栅格数据的金字塔。我们可能由于某种原因而不需要使用原始数据的金字塔，那么就勾选此选项，这样将忽略所有栅格金字塔，并从大于栅格基础像素大小的系数开始定义概视图。例如，如果镶嵌数据集系数为 3，而原始栅格数据的像素大小为 1 米，则将以 3 米的像元大小开始生成概视图。 定义Overview图像参数： 我们可以根据数据的实际情况定义：重采样方法、压缩方法和压缩质量。例如，对于专题数据，一般可选择最邻近法；而对于航空摄影或卫星影像，一般可使用双线性插值法或三次卷积插值法。我们可以选择不进行压缩、进行无损压缩或进行可定义总体图像质量的压缩。不同的压缩方法会影响生成Overview的大小。例如，质量为 75 的 JPEG 压缩一般可提供最佳的数据质量及文件大小。 定义镶嵌数据集的参数繁多，但是总结起来，都是对镶嵌数据集概视图大小和质量的控制，几个参数可以单独使用，也可以组合使用。 如果平时遇到概视图相关的问题，还是一定要结合自己的数据对比这些参数，考虑是否有排除错误和优化性能的好方法。 您还可以控制是否在概视图生成中考虑栅格的金字塔。可能使用您不喜欢的重采样方法生成了原始金字塔，也可能由于某种其他原因而不需要使用任何金字塔。您可以选中定义概视图工具对话框中的“强制概视图切片参数”选项，这样将忽略所有栅格金字塔，并从大于栅格基础像素大小的系数开始定义概视图。例如，如果系数为 3，而基础像素大小或栅格为 1 米，则将以 3 米开始生成概视图。 此外，您的镶嵌数据集可能由数据源大量混合而成，并且由于某种原因，您需要使用最开始的金字塔的一部分，而不是全部。您可以定义概视图开始位置的像素大小。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"镶嵌数据集工具小结（二）镶嵌数据轮廓线与边界","slug":"MDFootprint","date":"2014-10-17T06:57:34.000Z","updated":"2016-03-09T08:16:52.000Z","comments":true,"path":"2014/10/17/MDFootprint/","link":"","permalink":"http://www.kikitamap.com/2014/10/17/MDFootprint/","excerpt":"","text":"上一篇帖子说明了如何创建镶嵌数据集、添加栅格数据，以及相关的常用参数配置。 下面再接着说如何根据自己的各种需要来修改镶嵌数据集，这一贴的主题主要是如何创建、修改镶嵌数据集的轮廓线和边界。 修改镶嵌数据轮廓线、边界类工具 当镶嵌数据集创建好之后，我们将其加入到 &nbsp;ArcMap 中后发现，镶嵌数据集是以类似图层组的形式加入的，包含了至少三个图层，分别为：Boundary、Footprint 和 Image。 在使用开头列出的那些工具之前，我们需要对上图的几个图层有所了解，了解的过程中自然会发现这些工具的用武之地。 Image（影像） 影像图层用于控制镶嵌数据集的动态镶嵌影像的渲染。如果你在ArcMap中显示过单张影像，那会发现这个图层其实看起来和单张影像差别不大。也就是镶嵌数据集将散列在磁盘上的多张栅格数据，动态拼接成了一整张栅格。对影像图层属性做出的修改不会影响镶嵌数据集，仅影响镶嵌数据集在显示时的渲染方式。 Footprint（轮廓线） 轮廓线是按照镶嵌数据集的坐标系统创建的，有可能有原始栅格数据的坐标系不一致。还记得上一篇中提到过创建镶嵌数据集时指定的坐标系可以与原始栅格数据不同吗？轮廓线包含镶嵌数据集内每个栅格的轮廓，但是不一定是每个栅格数据集的范围，而应该是栅格数据集内有效栅格数据的范围。NoData 区域是轮廓线形状所排除内容的典型示例。 当然，我们也可以根据自己的需求，进一步定义和裁剪栅格数据。方法通常是三种： 1）自动计算方法： 使用 Build Footprint 工具执行系统计算得到新的轮廓线。 重新定义轮廓线的方法有： RADIOMETRY：根据像素值范围来重新定义轮廓线的形状，从而排除无效数据（*辐射法重新计算轮廓线这个小专题可以展开，以后有时间可以详细整理。） GEOMETRY：将轮廓线的形状重新定义为其原始几何形状 COPY_FROM_SIBLING：在使用全色锐化的栅格类型时，轮廓线将被替换为多光谱项的轮廓线。 在这之前，还可以使用 Define Mosaic Dataset NoData 工具将栅格中不希望显示的值置为Nodata，这个工具允许同时将多个值置为Nodata。然后再执行 Build Footprint 可以一次性排除全部Nodata值。 2）手工编辑方法： 通过编辑工具条，手工编辑修改 Footprint 面要素得到新的轮廓线。这种方法和我们平时编辑矢量面没有什么区别。 3）导入已有多边形的方法： 可以使用工具Import Mosaic Dataset Geometry ，将面要素导入，按照指定的关联字段替换轮廓线。另外，此工具也可用于替换边界或接缝线多边形。 Boundary（边界） Boundary层，我们可以理解成镶嵌数据集所引用的所有栅格数据的外边界，实际它是一个储存在地理数据库（GDB）内部的面要素类。我们可以使用 Build Boundary 工具来创建这个层，也可以在一开始添加栅格工具中勾选&nbsp;Build Boundary 参数。 那这个Boundary 层是基于什么计算得到的呢？ 本质上，是将许许多多的 Footprint 层进行融合得到的。 也就是我们可以理解成，Footprint是每个栅格数据的边界，而Boundary是全部栅格的Footprint融合之后的总外边界。边界用于确定镶嵌数据集的空间范围。 如下图，说明 Footprint 与 Boundary： 创建边界可以指定简化方法，可以是实际数据边界，也就是不进行简化（None），可以是凸多边形（Convex Hull），还可以是外接矩形（Envelope）。 如下图一目了然： 如果镶嵌数据集中所包含的栅格数据超出了边界，那超出的数据在镶嵌图像中就不可见了。因此，我们可以通过修改边界来限制镶嵌数据集的可见内容。 类似操作 Footprint，我们可以通过手工编辑，或者使用工具&nbsp;Import Mosaic Dataset Geometry 制作自定义边界。 当然与&nbsp;Import Mosaic Dataset Geometry&nbsp;工具相应，我们还可以使用工具 Export Mosaic Dataset Geometry导出镶嵌数据集的轮廓线、边界等要素类。 有关轮廓线、边界、镶嵌数据集图层就到这里了，对于初学者来说，上面这些足够用了。 下一篇我会接着整理有关概视图创建等增强优化镶嵌数据集的工具。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"镶嵌数据集工具小结（一）创建/删除镶嵌数据集","slug":"MDCreateMD","date":"2014-10-14T09:40:56.000Z","updated":"2016-03-09T08:31:38.000Z","comments":true,"path":"2014/10/14/MDCreateMD/","link":"","permalink":"http://www.kikitamap.com/2014/10/14/MDCreateMD/","excerpt":"","text":"在 ArcGIS 中，镶嵌数据集是用来批量管理、动态镶嵌大量栅格数据的推荐数据模型，在工具箱中有一系列用于操作镶嵌数据集的工具。如果希望了解什么是镶嵌数据集，可以预先看&nbsp;帮助文档。平时接触到的问题可能散落在使用镶嵌数据集的各个环节，最近就以镶嵌数据集工具为索引，顺藤摸瓜。 镶嵌数据集的工具箱位于： Data Management Tools\\ Raster\\ Mosaic dataset 目录下，其中绝大部分工具在镶嵌数据集的右键菜单中也可以调用，下面就分类整理小结一下。 创建/删除镶嵌数据集类工具 首先，我们可以使用 Create Mosaic Dataset 工具创建一个新的镶嵌数据集，这是所有与镶嵌数据集有关的操作的起点。 也就是，先要做出一个空的盒子来容纳下面要加入的栅格数据。 创建镶嵌数据集要了解下面几点： 需要ArcGIS 标准版或者高级版的许可。 可以在有写权限的文件地理数据库、个人地理数据库或 ArcSDE 地理数据库中，创建镶嵌数据集。 为镶嵌数据集命名，名称需要满足数据库规范。 必须设置空间参考，这里也就是坐标系统。当我们访问镶嵌数据集的时候，这个空间参考就是整个镶嵌数据集的默认空间参考，镶嵌数据集的其他附加部分会依据这个空间参考创建，有关附加部分后面再说。如果将来往里添加的栅格数据的空间参考与镶嵌数据集默认空间参考不一致，也没有关系，数据会进行动态投影。这时你可能会问，什么是动态投影？举个例子来回答问题，例如创建了一个坐标系统为WGS1984的镶嵌数据集，但是后面添加的影像坐标系是Beijing1954的，那么在查看镶嵌数据集时，我们会看到影像数据自动变换到WGS1984坐标系中进行镶嵌显示。 创建镶嵌数据集工具中还有几个可选参数可以根据需要配置，例如：波段数、位深等。如果没有要求，可以跳过，镶嵌数据集会按照默认设置创建。 盒子有了，然后我们就可以往里放东西了。 接着使用工具 Add Rasters To Mosaic Dataset ，向镶嵌数据集加入内容。 ★ 这里需要了解，栅格数据本身实际是没有入库的，而是以非托管的形式在镶嵌数据集中进行管理。也就是，执行添加栅格数据操作之后，镶嵌数据集中存储了指向栅格数据位置的指针，而不是将实际的栅格数据存储在镶嵌数据集内。也因此，不要在添加栅格数据之后，就把原始数据删除或者移动了，否则镶嵌数据集就受到了影响。 添加栅格数据有几个参数需要理解其意义： 1）Raster Type 向镶嵌数据集添加栅格数据时，我们需要指定“栅格类型”。默认的栅格类型是“栅格数据集（Raster Dataset）”，是指ArcGIS支持的任何栅格格式。其他栅格类型则特定于产品（传感器、数据提供商或供应商）或关联的元数据信息。通过指定除了“栅格数据集”之外的栅格类型添加栅格数据时，元数据信息和栅格处理信息会被读取。 举个例子说明下它们之间的区别：例如， 添加 QuickBird 标准场景时，.imd文件定义了一个场景，它包含了栅格数据的元数据信息，指向了一个或者多个.tif 文件。如果希望正确添加&nbsp;QuickBird 标准场景数据，那么需要选择&nbsp;QuickBird &nbsp;栅格类型，这种栅格类型会搜索 .imd 和 .tif 的组合从而保证数据信息的完整。如果我们以默认的“Raster Dataset”栅格类型添加这个数据，那就只能添加和识别 .tif 文件，这样 .imd 中所定义的元数据信息就丢失了。 如果需要了解自己的栅格数据是否能被ArcGIS支持，那需要查看如下两个主题的帮助文档列表： √ 支持的栅格和影像数据格式列表 √ 受支持的栅格数据集文件格式 2）Input Data 镶嵌数据集支持通过如下几种方式的输入方法来添加栅格数据： 数据集 — 可以输入ArcGIS支持的任何栅格、栅格目录或镶嵌数据集 工作空间 — 用于选择一个包含多个栅格数据集的文件夹。该文件夹可包含子文件夹。它受“是否包括子文件”和“输入数据过滤器”参数的影响。 文件 — 用于选择文件列表文件、影像服务定义 (.ISDef) 文件和栅格处理定义 (.RPDef) 文件。 文件列表检索器还将忽略与添加的栅格类型不对应的任何文件。 服务 — 用于选择 WCS、地图、影像服务或 Web 服务图层文件。 3）Update Cell Size Ranges/Update Boundary/Update Overviews 如果要多次使用“添加栅格至镶嵌数据集”工具将数据添加到镶嵌数据集中，建议取消选中“Update Cell Size Ranges”和“Update Boundary”，直到所有栅格数据全部添加完成。 如果将栅格数据添加到已生成概视图（Overview）的镶嵌数据集中，则可以选择勾选“Update Overviews”，这样可在添加栅格数据的同时完成更新概视图。也可以稍后利用“构建金字塔（Build Overviews）”工具来完成。有关概视图后面的优化镶嵌数据集中再详细说明。 4）其他几个可选参数（栅格金字塔、坐标系统、数据过滤、操作描述等等）不再啰嗦了，看看帮助都比较好理解，如下链接： http://resources.arcgis.com/zh-cn/help/main/10.2/index.html#//001700000085000000 如果发现盒子里的东西不需要了，或者放错了，需要丢出去呢。 如果需要从镶嵌数据集移除栅格数据，就可以使用 Remove Raster From Mosaic Dataset 工具 。同样需要了解的是，这个工具并没有真正的删除原始栅格数据，而仅是从镶嵌数据集中移除存储的栅格数据的指针，或者叫链接。 移除栅格的操作是通过内部执行SQL语句实现的，在工具中，我们可以自行来写SQL语句中的 Where 语句。例如如果希望全部移除已添加的栅格数据，可以写成&nbsp;“OBJECTID&gt;=0”。 在移除栅格数据的同时，可以选择配置是否移除Overview、Item Cache，以及是否更新像元大小范围、边界,是否标记受影响的概视图等。 如果我们仅需要移除概视图，而不移除栅格数据，这个工具也可以满足，取消勾选“Remove Mosaic Dataset Items”选项即可。 如果连盒子都不想要了，希望和里面的东西一起全部扔掉。 我们可以使用工具Delete Mosaic Dataset工具，默认会全部删除镶嵌数据集、概视图和项目缓存。如果不希望删除概视图或缓存时，也可以取消勾选相关参数。 另外， 可以使用工具 Create Referenced Mosaic Dataset ，基于一个现有的镶嵌数据创建新的镶嵌数据集。 Referenced Mosaic Dataset&nbsp;有一些自己的特点，可以解决一些实际问题。举几个例子，帮助理解为什么会有创建这种镶嵌数据集的需求。 例如希望别人访问自己做好的镶嵌数据集，但是不希望别人更改已经定义好的一些属性和函数。也就是控制了修改数据的权限。 例如现有包含了全部数据的主镶嵌数据集，但是希望根据需要筛选出部分感兴趣的特定栅格，同时又不更改主镶嵌数据集。也就是为了感兴趣对象的过滤。 同样，如果现有包含了全部数据的主镶嵌数据集，但是希望使用不同的函数创建出多种输出，例如根据红色波段和近红外波段的 NDVI 或全色锐化的镶嵌。 再比如，现有覆盖范围广大的全国的镶嵌数据集，但是希望按省提供小范围的镶嵌数据集给相应人员。 在地理数据库内外，均可创建&nbsp;Referenced Mosaic Dataset。而不像普通镶嵌数据集仅能在数据库中创建。 在文件夹下而不是在地理数据库中创建，这种地理数据库的文件扩展名为 .amd，但是不会创建边界。加入ArcMap中，类似下面的样子： 另外，需要了解，我们无法对&nbsp;Referenced Mosaic Dataset&nbsp;构建概视图、计算像素大小范围、在栅格级别添加函数或添加新栅格数据。 就到这里了，下一篇打算抽时间总结下镶嵌数据集的修改方面知识点。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"ArcGIS 系统要求知多少","slug":"ArcGISSystemRequirment","date":"2014-09-24T02:23:18.000Z","updated":"2016-03-09T08:39:00.000Z","comments":true,"path":"2014/09/24/ArcGISSystemRequirment/","link":"","permalink":"http://www.kikitamap.com/2014/09/24/ArcGISSystemRequirment/","excerpt":"","text":"安装 ArcGIS 软件之前，一定要注意自己的操作系统，硬件（包括型号和驱动），甚至一些软件的版本是否能满足系统要求。只有出现在各个版本的列表中的操作系统和其他软硬件版本才算是真正的支持。否则可能会出现诸如不稳定，崩溃等等各种异常现象。 时常会被问到：“ArcGIS 9.3还能安装在 Windows XP SP1 中吗？ArcGIS 10.0能安装在 windows 8 中吗？”答案都是不能。但是前者安装时系统会主动报错，不支持安装，后者貌似没有任何提示，也安装上了。用户就会问，你不是说安装不上米？ “能不能安装”在官方和“民间”，是两个完全不同层面的问题。为什么这么说呢？我们一起脑补下。从个人学习角度，只要安装成功，没有收到致命报错，似乎就是支持安装；但是，从官方角度，我们可以理解成，这个操作系统的发布和ArcGIS某个版本软件开发测试不是同期的，例如10.0早在2010年就发布了，而win8在2013年才发布，没有经过严格测试证明可以全面支持的，不能称为支持。因此如果强行安装了，出于个人研究探索并无大碍，但只能后果自负了。 下面是各个版本的系统要求列表： ArcGIS 10.0 http://help.arcgis.com/en/systemrequirements/index.html ArcGIS 10.1 http://resources.arcgis.com/en/help/system-requirements/10.1/index.html ArcGIS 10.2.x http://resources.arcgis.com/en/help/system-requirements/10.2/index.html 过气版本 ArcGIS 9.3 Desktop：http://downloads.esri.com/support/systemrequirements/ArcGIS_Desktop_93_SystemRequirements.pdf Server：http://downloads.esri.com/support/systemrequirements/arcgis_server.pdf ArcGIS 9.2 甚至更早的版本就不说了，太久远了，现在的操作系统没有几个能支持的了，如果还在使用这8年前的版本，算了，丢了吧，反正你不爱ArcGIS。 以前整理过各个版本的补丁下载链接，点击 跳转另一篇博客。 另外，从10.2版本之后，不再提供像上面链接中一样的单独的补丁下载，而是做成完整的安装包，例如，截至到这篇博客的时间，最新的版本 10.2.1，10.2.2 这些版本既是如此。这样就可以在空白机器上直接安装最新版本，而不需要像以前一样，先安装旧版本再打补丁，避免重复劳动多次；对于已经安装10.1，10.2的机器，可以直接覆盖安装 10.2.1等新版本，也节省了卸载的时间。 产品的生命周期最可以说明问题，有图有真相：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"}]},{"title":"ArcGIS中的影像分类","slug":"ArcGISImageClassification","date":"2014-09-18T02:52:05.000Z","updated":"2016-03-09T08:51:18.000Z","comments":true,"path":"2014/09/18/ArcGISImageClassification/","link":"","permalink":"http://www.kikitamap.com/2014/09/18/ArcGISImageClassification/","excerpt":"","text":"影像分类的目的就为了将图像中的像元划分成不同的类别，过程就是根据像元在不同波段的波普亮度、空间结构特征或者其他信息，按照某种规则或算法实现分类。遥感图像分类处理就是是为了提取遥感图像中的目标信息，遥感图像分类主要用于地物类别的区分。 影像分类分为监督分类和非监督分类，很多遥感书籍中都有这两种分类方法的比较。这里我结合ArcGIS软件简单整理一下： 监督分类监督分类是使用被确认类别的样本像元去识别其他未知类别像元的过程。其中这些已被确认类别的像元就是训练样本。也就是说，在监督分类中，必须事先提取出代表总体特征的训练数据以及事先知道影像中有几种类别。这样就可以学习这些样本类别的先验知识，然后对整体数据进行分类。 在 ArcGIS 中，首先使用 Image Classification 工具条中的训练样本管理器，创建训练样本。 在创建样本之后，我们可以评估训练样本，使用直方图、散点图、统计数据。 （1）直方图 打开直方图，每个波段对应一个直方图。不同类的直方图不应重叠。如果发生重叠，则需要删除或合并其中一些类。 直方图按钮仅用于整型影像，不适用于浮点型。 （2）散点图 散点图是参加分类的影像数据的波段的两两组合，如果有N个波段，就有1 + 2 + … + (N – 1) 个散点图。 对于所有波段组合，散点图和统计数据不应彼此重叠。 （3）统计数据 统计数据包括最小值、最大值、平均值、标准差和协方差矩阵。 创建训练样本后，可以使用交互式监督分类工具，探索性的直接查看分类结果。这个工具不需要事先创建特征文件，工具后台使用的是最大似然法分类方法。 在ArcGIS 中，监督分类的主要GP工具是&nbsp;最大似然法分类工具（Maximum Likelihood Classification）。 （1）需要使用&nbsp;特征文件（Signature File），既可以是通过训练样本制作的，也可以是ISO聚类工具求取，*.gsg文件。 （2）可以根据需要设置&nbsp;剔除分数（Reject Fraction&nbsp;），例如0.01。这样表示，正确分类的几率不到 1% 的像元就会成为 NoData。 （3）先验概率（priori probability），工具默认使用 Equal 先验概率，会给像元分配可能性最大的分类。但是，如果某些类出现的可能性大于（或小于）平均值，则应将 FILE 先验选项与输入先验概率文件结合使用。输入先验概率文件必须是包含两列的 ASCII 文件。左列中的值表示类 ID。右列中的值表示相应类的先验概率。类别先验概率的有效值必须大于或等于零。如果指定零作为概率，则类无法显示在输出栅格中。指定先验概率的总和必须小于或等于1。 （4）最大似然法分类工具还可以附带可选生成&nbsp;置信栅格（confidence raster），这样可以了解每个像元的正确分类的概率。 非监督分类非监督分类不预先确定类别，而是直接对相似的像元进行归类，根据归类的结果来确定类别。也就是在事先没有任何先验知识的情况下对未知类别的样本进行分类。当我们没有训练区，有对研究区不熟悉时，或者对图像中包含的目标物不明确的时候，采用此方法。 在 ArcGIS 中进行非监督分类，主要使用工具&nbsp;ISO聚类非监督分类工具（Iso Cluster Unsupervised Classification）。 需要指定希望分出来的类别的数量，并且根据需要调整迭代的次数、类的最小尺寸、采样间隔。 ISO 是&nbsp;iterative self-organizing 的缩写，也就是迭代自组织方法。此工具的工作原理从帮助中扒出来，供参考： iso 聚类算法是一种迭代过程，用于在将各个候选像元指定给聚类时计算最小欧氏距离。该过程从处理软件指定的任意平均值开始，每个聚类一个任意平均值（您指定聚类数量）。将每个像元指定给最接近的平均值（多维属性空间中的所有平均值）。基于首次迭代后从属于每个聚类的像元的属性距离，重新计算各个聚类的新平均值。重复执行此过程：将各个像元指定给多维属性空间中最接近的平均值，然后基于迭代中像元的成员资格计算各个聚类的新平均值。您可通过迭代次数指定该过程的迭代次数。该值应该足够大，才能确保执行指定次数的迭代后，像元从一个聚类迁移至另一个聚类的次数最少；从而，使所有聚类变为稳定状态。迭代次数应该随着聚类数的增加而增加。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"}]},{"title":"ArcGIS 构建3D动画方法","slug":"Building3DAnimation","date":"2014-09-16T07:43:44.000Z","updated":"2016-03-09T12:42:32.000Z","comments":true,"path":"2014/09/16/Building3DAnimation/","link":"","permalink":"http://www.kikitamap.com/2014/09/16/Building3DAnimation/","excerpt":"","text":"Ⅰ 以动画表现视图（View）1 捕获透视图（Capturing perspective views） 使用“动画”工具条中的“捕获视图”工具 捕获视图 可以捕获照相机视图，这些视图作为关键帧，保存在某个照相机轨迹或地图视图轨迹中。 生成的轨迹将成为关键帧之间的连续插值，从而创建平滑的动画。 2 录制导航（Recording Navigation） 简单录制功能是通过使用与动画控制对话框中的视频播放器类似的控件来实现的。单击录制按钮录制导航。 录制导航时，可使用 ArcScene 或 ArcGlobe 中的飞行工具飞行 来创建照相机轨迹。 3 创建关键帧（Creat KeyFrames） 这种方法与捕获透视图相似，可以为当前视图进行快照，作为一个关键帧，可以插入到已有的轨迹中。 在创建动画关键帧对话框上，使用相同的属性（如相同的照相机位置）创建多个关键帧，然后在动画管理器的“关键帧”选项卡上修改关键帧属性，细化动画创建。 如下例子，中通过创建两个相同的关键帧，控制照相机在某处的停留时间。 4 使用书签创建动画（Using Bookmark） 将已经创建的书签作为关键帧也是个很好的方法，如果地图或者场景中以前做过书签，并且想把他们利用起来连贯的展现出来，就可以使用这种方法。 5 沿路径移动照相机或视图（Moving the Camera or View along a Path） 我们还可以根据路径创建照相机轨迹或地图视图轨迹。所选线要素或图形可以用来定义路径，这样就将照相机的移动轨迹就约束在这个路径上。 例如下图所示： 照相机的方向可由观察点和目标点这两个 3D 点定义。使用“根据路径设置照相机飞行路线”对话框上的“路径目标”选项可修改照相机的移动方式。有三个选项可用于沿路径移动照相机： （1）沿飞行路径同时移动观察点和目标。 （2）保持当前目标沿路径移动观察点。 （3）保持当前观察点沿路径移动目标。 Ⅱ 以动画形表现图层属性创建图层轨迹的几种方式： （1）图层透明度动画 使某些图层变得透明，以便其他图层能够随着动画的发展而可见； 方法：在创建关键帧的时候，设置图层的透明度百分比。 （2）图层可见性动画 关闭图层使之不可见。例如在某个时间，指定图层不需要显示；操作类似上面的，只不过截取关键帧的时候，打开/关闭图层即可，不赘述。 （3）ArcScene 中沿路径移动某个图层（例如汽车） （4）图层组动画 使用现有图层组，按照顺序播放一系列的图层，这个动画效果也比较常用，如果一个组中是相关的主题的一系列数据，通过播放，可以看到图层之间的演进关系。 Ⅲ 以动画表现场景属性（ArcScene）这种动画类型是仅用于 ArcScene 的场景属性配置的。最常用的就是一天从日出到日落不同太阳位置的场景效果的连续播放。 我们要做的仅仅是在每个太阳位置时间点创建关键帧。 场景属性设置： Ⅳ 以动画表现时态数据如果数据是含有时间字段的，我们还可以进行按照时间序列的播放时态数据的动画。 首先在图层属性中时间选项卡 激活时态。 然后创建时间动画。 关于最后一个时间动画不想说很多，ArcGIS 有个关于时态的扩展模块，Tracking Analyst，这个扩展对于时态数据有更多的控制。 配置出的时间图层有更好的展现力，因此，这里就不再多说时间动画了。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"深入路径距离分析（三）","slug":"DiveinPathDistanceAnalyst3","date":"2014-09-15T04:56:17.000Z","updated":"2016-03-09T12:41:34.000Z","comments":true,"path":"2014/09/15/DiveinPathDistanceAnalyst3/","link":"","permalink":"http://www.kikitamap.com/2014/09/15/DiveinPathDistanceAnalyst3/","excerpt":"","text":"路径分析不仅可以考虑到水平方向的影响因子，而且可以考虑到垂直方向的影响因子，例如前面开车的例子中，水平方向的影响因子是风向，垂直方向的影响因子就是路面的起伏状况。 垂直系数 垂直系数越大，移动的难度也就越大。确定从一个像元行进到另一个像元时遇到的垂直系数（VF）与确定水平系数（HF）相似。这里需要引入一个概念，垂直相对移动角度（VRMA），垂直相对移动角度（VRMA）是“起始”像元与“目标”像元形成的斜率的角度，斜率=垂直增量/水平增量。VRMA 以度为单位进行指定。VRMA 的值范围为 -90 到 +90 度。 路径距离分析工具中，提供了几种算法，BINARY、LINEAR、SYM_LINEAR、INVERSE_LINEAR、SYM_INVERSE_LINEAR、COS、SEC、COS_SEC、SEC_COS、TABLE： （1）Binary——二元垂直系数 当 VRMA 大于切削角下限且小于切削角上限时，在两个像元之间移动的 VF 设置为与零系数相关联的值。如果 VRMA 大于切削角上限或者小于切削角下限，则 VF 设置为无穷大。工具默认的切削角为正负30度。 （2）Linear——线性垂直系数 VF 由 VRMA-VF 坐标系中的一条直线确定。这条线在 y 轴上与零系数相关联的值处进行截取。线的斜率可以使用 SLOPE 属性进行指定。如果未确定斜率，则默认值为 1/90（指定为 0.01111）。默认的切削角下限为 -90 度，而默认的切削角上限为 90 度。 （3）Inverse Linear——逆线性垂直系数 这个与线性垂直系数类似，VF 由 VRMA-VF 坐标系中的一条直线的逆向值确定。这条线在 y 轴（表示 VF 系数）上与零系数相关联的值处进行截取。线的斜率可以确定（如果使用 SLOPE 修饰属性指定）。如果未确定斜率，则默认值为 -1/45（指定为 0.02222）。默认的切削角下限为 -45 度，而默认的切削角上限为 45 度。 注意：这个算法的图表，在ArcGIS的帮助中绘制错误了，画成了二次曲线的样子，如下是改正后正确图表。_ _ （4）Symmetric Linear——对称线性垂直系数 SYM_LINEAR 由两个与 VRMA 相关的线性函数组成，这两个函数关于 VF (y) 轴对称。两条线都在与零系数相关联的 VF 值处截取 y 轴。使用 SLOPE 垂直系数修饰属性相对于正 VRMA 定义线的斜率，然后将针对负 VRMA 生成一个镜像。默认斜率为 1/90（指定为 0.01111）。默认的切削角下限为 -90，而默认的切削角上限为 90。 （5）Symmetric Inverse Linear——对称线性垂直系数 顾名思义，SYM_INVERSE_LINEAR 与 SYM_LINEAR 垂直系数关键字正相反。它由两个与 VRMA 相关的线性函数组成，这两个函数关于 VF (y) 轴相对称。两条线都在 VF 值为 1 处截取 y 轴。使用 SLOPE 垂直系数修饰属性相对于与正 VRMA 定义线的斜率，然后将针对负 VRMA 生成一个镜像。默认斜率为 -1/45（指定为 .02222）。默认的切削角下限为 -45，而默认的切削角上限为 45。 注意：这个算法的图表，在ArcGIS的帮助中也绘制错误了，也画成了二次曲线的样子，如下是改正后正确图表。 （6）Cos——余弦垂直系数 VF 由 VRMA 的余弦函数确定。默认的切削角下限为 -90 度，而默认的切削角上限为 90 度。默认的 COSPOWER 为 1.0。 （7）Sec——正割垂直系数 VF 由 VRMA 的正割函数确定。默认的切削角下限为 -90 度，而默认的切削角上限为 90 度。默认的 SECPOWER 为 1.0。 （8）Cos-Sec——余弦正割垂直系数 当 VRMA 度数为负值时，VF 由 VRMA 的余弦函数确定。如 VRMA 度数为正值，VF 则由 VRMA 的正割函数确定。默认的切削角下限为 -90 度，而默认的切削角上限为 90 度。默认的 COSPOWER 和 SECPOWER 均为 1.0。 （9）Sec-Cos——正割余弦垂直系数 当 VRMA 度数为负值时，VF 由 VRMA 的正割函数确定。如 VRMA 度数为正值，VF 则由 VRMA 的余弦函数确定。默认的切削角下限为 -90 度，而默认的切削角上限为 90 度。默认的 COSPOWER 和 SECPOWER 均为 1.0。 （10）Table——自定义表格垂直系数 与 HRMA 图一样，VRMA 图中的字符可由修饰属性进行进一步的控制，从而细化垂直系数。这个就不再赘述了。 好了，到这里路径距离分析就说完了，也就是说，当需要计算最短路径的时候，需要考虑和前进方向有关的水平阻力因子和垂直阻力因子的时候，可以使用 ArcGIS 的路径距离分析工具，可以使用工具中的既定算法模型，通过配置参数达到目的，或者自定义表格自定义细化水平或垂直系数。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"深入路径距离分析（二）","slug":"DiveinPathDistanceAnalyst2","date":"2014-09-15T03:42:57.000Z","updated":"2016-03-09T12:59:04.000Z","comments":true,"path":"2014/09/15/DiveinPathDistanceAnalyst2/","link":"","permalink":"http://www.kikitamap.com/2014/09/15/DiveinPathDistanceAnalyst2/","excerpt":"","text":"接着上一篇文章，继续说说水平影响因子： 水平系数水平系数 (HF) 从像元移动时所遇到的水平阻力因素的角度出发，确定从一个像元移到另一个像元的成本，或者说是困难。 在路径距离分析中，提供了确定水平方向成本的参数，如下图： 水平栅格中存储了各个像元位置指定的水平角度，例如在上面开车的例子中，指的就是风向。 水平方向以度为单位进行定义，0 表示位于待处理像元的上方（或北方），值沿顺时针方向增加，形成一个圆并在 360 度时回到原始位置。 另外引入的一个概念是，水平相对移动角度 (HRMA)，这是水平角度和前进角度的夹角，对于上面的例子，就是汽车的行驶角度和风向的夹角。 HRMA 值的范围介于 -180 到 180 度之间。但是，在水平系数图中，x 轴上的值介于 0 到 180 之间，也就是工具中使用的是HRMA的绝对值。确定了 HRMA 后，会使用一个图表来确定实际的水平系数。y 轴表示 HF，而 x 轴表示 HRMA。 水平系数关键字，允许我们通过选择工具中提供的适合的算法，工具中提供了：&nbsp;BINARY、FORWARD、LINEAR、INVERSE_LINEAR、TABLE 五种方法。 （1）Binary——二元水平系数： 当 HRMA 小于切削角时，通过像元部分的 HF 设置为与零系数（Zero Factor）相关联的值。如果 HRMA 大于切削角，则此部分的 HF 设置为无穷大。默认切削角（Cut Angle）为 45 度。默认零系数为 1.0。 （2）Forward——前向水平系数： 如果某段行程的 HRMA 小于 45 度，则 HF 设置为与零系数（Zero Factor）相关联的值。当 HRMA 大于或等于 45 度且小于 90 度时，HF 设置为边值（Side Value）。如果未指定边值，则默认边值为 1。如果 HRMA 大于或等于 90 度，则 HF 设置为无穷大。默认零系数为0 .5。 （3）LINEAR——线性水平系数 HF 由 HRMA-HF 坐标系中的一条直线确定。这条线在 y 轴（表示 HF 系数）上与零系数（Zero Factor）相关联的值处进行截取。线的斜率（Slop）可以使用 SLOPE参数指定。如果未确定斜率，则默认值为 0.5/45 或 1/90（指定为 0.01111）。默认切削角为 181 度，这相当于无切削。默认零系数为 0.5。 （4）INVERSE_LINEAR——逆线性水平系数 HF 由 HRMA-HF 坐标系中的一条直线的逆向值确定。这条线在 y 轴（表示 HF 系数）上与零系数相关联的值处进行截取。线的斜率可以使用 SLOPE 修饰属性进行指定。如果未确定斜率，则默认值为 -2/180 或 -1/90（指定为 0.01111）。默认切削角为 181 度，这相当于无切削。默认零系数为 2.0。 （5）Table——自定义表格 如果前面四种既定算法不能满足要求，我们还可以自定表格，方法就是，在任意文本编辑器中创建的 ASCII 文件来定义图表。 该文件的每一行有两列值与之对应。第一列值用于识别 HRMA（以度为单位表示），第二列值为 HF。文件中的每行指定图表中的一个点。 两个连续的点定义 HRMA-HF 坐标系中的一条线段。HRMA 角度必须按升序输入。对于所有小于第一个（最低）输入值或大于最后一个（最大）输入值的 HRMA 角度，其 HF 系数将设置为无穷大。 在 ASCII 文件中，无穷大的 HF 表示为 -1。 示例： 有关水平影响因子的总结就到这里，下一篇继续整理和讲解垂直因子……","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"深入路径距离分析（一）","slug":"DiveinPathDistanceAnalyst1","date":"2014-09-15T01:10:07.000Z","updated":"2016-03-09T13:06:42.000Z","comments":true,"path":"2014/09/15/DiveinPathDistanceAnalyst1/","link":"","permalink":"http://www.kikitamap.com/2014/09/15/DiveinPathDistanceAnalyst1/","excerpt":"","text":"写这篇之前，整理过空间分析中的距离分析工具箱，今天继续深入的说说路径距离分析。 开始路径距离分析之前，先回忆下最基本的欧式距离分析和成本距离分析。欧氏距离分析遵循的就是我们小学都知道的“两点之间直线最短”的原则，两点之间的最短路径就是两点之间的线段的距离。但是实际情况并不是很完美，有时我们无法完全沿直线前往某个位置，例如遇到河流、陡坡、悬崖等障碍。这时，我们就应该考虑使用成本距离工具获得更现实的结果。 如下图，举个简单的例子说明成本距离分析和欧式距离分析。按照欧式距离在问号位置求得的应该是绿色的路径，表示最近源，但是考虑到成本，黄色的曲线确是成本最低的最优路径。并且“曲线救国”比盲目直行，成本更低。 回顾就到这里，继续看更加复杂的路径距离分析： 路径距离工具与成本距离相似，两者都用于确定从源到栅格上各像元位置的最小累积行进成本。但是，路径距离不仅可计算成本表面的累积成本，而且可以考虑到从一个位置到另一个位置的总移动成本的水平和垂直因子补偿。这些工具生成的累积成本表面可用于扩散建模、流向运动和最低成本路径分析。路径距离工具既考虑水平和垂直成本要素，又考虑真实表面距离。 举个简单的例子，了解路径距离分析，假设我们开车从位置A到位置B，路况复杂，还有点起风，这时风向和风速就成了水平影响因子，道路的起伏程度就行了垂直因子。如下图，说明这个问题： 水平影响因子： 垂直影响因子： 理解了路径距离分析工具的用途，在下一篇文章中，我们一起来看看水平系数和垂直系数对路径距离的影响。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"栅格数据中的 Zone 与 Region","slug":"RasterZoneRegion","date":"2014-09-01T09:22:00.000Z","updated":"2016-03-09T13:15:34.000Z","comments":true,"path":"2014/09/01/RasterZoneRegion/","link":"","permalink":"http://www.kikitamap.com/2014/09/01/RasterZoneRegion/","excerpt":"","text":"Zone 与 Region 在字面上都是区域的意思，但是在做分析与统计的时候二者却是有区别的。 什么是Zone？ 简而言之，具有相同值的像元就属于一个Zone。也就是，Zone由栅格中所有具有相同值的像元组成，分区可以由相邻像元和/或不相连像元组成。如下图一目了然： 什么是Region？ 一个Zone内的每组相连像元都可视为一个Region。ArcGIS 中提供了从 Zone 获得 Region 的工具 Group Region。 &nbsp;&nbsp; 工具的工作顺序： 扫描的第一个区域接收值 1，第二个区域接收值 2，依此类推，直到所有区域都已赋值。扫描将按从左至右、从上至下的顺序进行。赋给输出区域的值，取决于系统在扫描过程中是在什么时候遇到它们的。 与原始Zone的关系： 默认，生成的数据的属性表中会有 LINK 字段，记录Region从Zone的来源：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"}]},{"title":"ArcGlobe 缓存管理","slug":"ArcGlobeCacheManagement","date":"2014-08-05T03:26:08.000Z","updated":"2016-03-09T13:28:14.000Z","comments":true,"path":"2014/08/05/ArcGlobeCacheManagement/","link":"","permalink":"http://www.kikitamap.com/2014/08/05/ArcGlobeCacheManagement/","excerpt":"","text":"ArcGlobe拥有缓存机制，因此可以应对大量3D数据的可视化，下面就总结下有关缓存的知识点。 首先，需要了解，ArcGlobe具有两种缓存机制：内存缓存，硬盘缓存。 内存缓存&nbsp;指的是分配可供 ArcGlobe 使用的物理内存 (RAM) 大小。要获得最佳性能，可设置对每个所使用的数据类型所分配的内存大小。ArcGlobe 通过设置内存缓存来改善 3D 视图的交互性能，可针对每个 ArcGlobe 文档（.3dd 文件）配置特定的内存值。 磁盘缓存&nbsp;会为 ArcGlobe 中的每个图层创建临时文件或缓存，从而有助于高效地显示和导航数据。每个图层，而不是数据源，对应一“套”缓存文件，以文件夹的形式保存。文件夹通常以图层名+GUID命名。例如下图： 保存 ArcGlobe 文档（.3dd）或创建图层文件（.lyr）可确保不会无意中删除磁盘缓存，以及保留缓存的链接以供以后使用。如果图层的显示发生更改，则会自动删除它的磁盘缓存并重新进行计算。 默认缓存是按需进行创建，也可以进行手动创建图层的部分缓存、全部缓存。 磁盘缓存的格式可以根据需要选择，ArcGlobe 支持两种磁盘缓存格式：JPEG 和 DXT。一般来说，JPEG 磁盘缓存格式占用的磁盘空间较少，而 DXT 缓存可提高渲染速度。 下面的问题引自帮助，稍加整理，放在这里辅助这两种格式的选择： JPEG 和 DXT 格式的区别是什么？ 在显卡较新的计算机上，DXT 缓存不必在渲染前解压缩。但 JPEG 缓存却需要在渲染前解压缩，因此存在性能开销。 具有 16 位色彩格式的 JPEG 缓存数据要求每像素占 2 个字节内存，而 DXT 缓存数据则要求每像素仅占 1 个字节内存。这意味着，DXT 数据所占用的图形内存只占 JPEG 16 位色彩数据所占用图形内存的一半。但 DXT 缓存所占用的磁盘空间通常比 JPEG 缓存大 8 到 12 倍。 JPEG 与 DXT 分别应于何时使用？ 1）显卡硬件的版本 如果计算机的显卡版本较低，有可能不支持 DXT 格式。在此类情况下，ArcGlobe 将使用仿真软件代替硬件，使计算机支持 DXT 缓存，但这样的话，使用 DXT 磁盘缓存选项并不会提高性能。版本较新的计算机则可以实现 DXT 格式的硬件支持，因此适合使用 DXT 缓存选项。如果注重应用程序的性能，则建议使用该格式。 2）数据范围 决定 JPEG 和 DXT 缓存性能差异的一个关键性因素是数据范围。对于本地区域范围内的图像数据，DXT 缓存的渲染速度比 JPEG 缓存最多可快 40%（以每秒的帧数衡量）。但是，如果数据是全球范围的，则两种格式之间几乎没有差异。但是，无论数据范围如何，DXT 磁盘缓存格式与 JPEG 磁盘缓存格式的缓存生成时间相同。 3）物理内存的大小 决定选择哪种格式的另一个关键性因素是计算机的物理内存大小。使用 DXT 缓存而非 JPEG 缓存时，ArcGlobe 将节省 10% 到 30% 的整体内存，从而在渲染大型数据集而计算机内存（RAM 和图形卡纹理内存）却有限的情况下可以提高性能。 4）磁盘空间 最后一个值得考虑的因素是磁盘空间。尽管 DXT 缓存的交互性能通常比 JPEG 缓存要好，但是它所占据的磁盘存储空间却会多出很多。根据数据的不同，DXT 缓存所占用的磁盘空间比 JPEG 缓存大 8 到 12 倍。因此，应考虑是需要更好的性能还是更大的磁盘空间。 使用 DXT 缓存时有哪些特殊注意事项？ 能否使用 DXT 取决于 OpenGL 图形卡驱动程序和图形卡硬件。有时，一些 OpenGL 工具可能无法支持或无法正常支持 DXT 压缩。这可能导致 DXT 缓存中产生失真。要解决此类问题，可以更新显卡驱动程序版本或使用其他显卡。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"使用矢量面裁剪栅格数据的对齐问题","slug":"AboutClippingRaster","date":"2014-07-29T03:19:31.000Z","updated":"2016-03-10T14:03:22.000Z","comments":true,"path":"2014/07/29/AboutClippingRaster/","link":"","permalink":"http://www.kikitamap.com/2014/07/29/AboutClippingRaster/","excerpt":"","text":"最近凑巧有几个比较多的栅格裁剪问题，整理如下： 我们只有由于栅格与矢量数据的存储模型不相同，这就导致栅格数据的像元无法与矢量数据的点等同，从而导致裁切后的对齐问题，放大数据我们就能发现，如下图可以说明：（其中黑白色为栅格数据，每个正方形代表一个像元，红色区域为矢量面数据。） 我们按照默认设置运行 Raster工具箱中的 Clip 工具，看看结果，蓝色的栅格部分： 发现，栅格数据裁剪完，并不是需要的矢量数据范围，而是矢量数据压盖的最小栅格数据范围。 如果我们需要得到的栅格，是矢量数据的范围，该如何做呢？ 【旧版本】如果正在使用的是10.1以及更早期的版本： 首先将作为裁剪范围的矢量面（Feature）转为图形（Graphic），在ArcMap中，在面图层上右键，使用 Convert &nbsp;Features to Graphics… 菜单，如下图： （Graphic 被选中状态下，周围是有几个小方块的，与 Feature 被选中的亮蓝色不同哦…） 2.在 ArcMap 中，使用图层的右键菜单中的Export功能，导出选中Graphic 范围内的数据： 看看结果，为了清楚，我将Graphic的填充色去掉，栅格数据左边与上边界是与矢量数据一致的，这样就尽最大范围保持了结果栅格与矢量数据范围的最大一致性： PS：有人会问，为什么下边和右边边界没有完全贴合？ 需要知晓，栅格数据的行列数是矢量数据长度整除像元大小（导出的像元大小默认与源数据相同，也可以根据需要修改）得出的，而通常有余数的存在，因此没有那么严丝合缝，归根结底还是两种数据的存储模型不同导致的。 【新版本】如果正在使用的是10.2以及更新期的版本： 新版本中 Clip 工具提供了额外的参数，可以简单的勾选就完成了上面的需求： PS：一定要注意右边的帮助哇，为了尽可能满足矢量数据边界范围，行列数是通过计算调整，也就是像元大小相比原始数据会变化，像元值会进行重采样获取。 看看结果吧，影线区域是矢量，玫红色区域是生成的栅格： 最后来张全家福，对比下，哪种结果是你想要的，决定对应的选择哪种方法 ，（左侧图层顺序，即为右侧图层显示顺序）。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"}]},{"title":"吧啦下 Background Geoprocessing","slug":"BackgroundGeoprocessing","date":"2014-06-25T01:32:12.000Z","updated":"2016-03-10T14:50:16.000Z","comments":true,"path":"2014/06/25/BackgroundGeoprocessing/","link":"","permalink":"http://www.kikitamap.com/2014/06/25/BackgroundGeoprocessing/","excerpt":"","text":"今天和大家说一下后台地理处理（GP），说到后台，自然会想到前台。 其实在 ArcGIS Desktop 9.X 以及更早的年代，ArcToolbox 中的工具运行的模式只有前台模式，也就是大家熟悉的情景：运行某个工具，然后工具运行窗口挡在 ArcMap的前面，窗口中的Log不停的滚动，直至工具运行完毕，ArcMap 才能使用。 并且，由于 ArcMap 和 ArcCatalog 是 32 的程序，单进程使用的系统资源是有限的。 为了解决这些问题，后台地理处理就产生了，从 ArcGIS 10.0 之后的版本，后台地理处理一直存在着。如果我们现在使用的操作系统是64bit的，那还可以安装后台地理处理64位程序包，在安装光盘中可以找到 ArcGIS for Desktop Background Geoprocessing （64bit）。 为什么安装&nbsp;ArcGIS for Desktop Background Geoprocessing（64 位）？ 因为，后台执行一个工具时，在后台会启动一个新的进程，我们可以理解成开了一个新的 ArcMap，只是没有界面的ArcMap。安装 ArcGIS for Desktop—Background Geoprocessing（64 位）之后，就替代了原先的常规 32 位后台处理。在 RAM 容量较大的系统中，使用 64 位后台处理，有助于处理在 32 位环境中无法处理的大数据。由于所有执行工作都在原生 64 位空间中完成，因此可使用更多系统资源。 由于新开进程，所以，在打开 ArcMap 之后的第一次执行后台GP，会发现很慢有延迟，之后的几次会很快出现进度条和消息。实际上，后台处理会启动两个进程，两个 RuntimeLocalServer.exe 进程。在工具执行期间不要随便结束这两个进程，否则可能会导致结果异常。 如何选择前台与后台GP处理？ 实际上，如果我们只是在做一些日常的小测试，做些小数据量的处理，可能除了结果之外，响应速度是我们关心的，那还是完全可以选择前台的，毕竟省去了新开进程的时间。但是如果仅仅因为在某些情况下的不稳定放弃后台运行，不是很明智，毕竟后台执行GP可以完全不耽误你手头的工作，还能更好的利用系统的资源。 后台运行从10.0版本开始产生，早期bug缠身，但是随着版本的更新，日趋稳定，10.2之后也开始支持并行运算，后台处理GP还是个不错的选择。 还是需要注意，什么情况下，后台GP不适用？ 后台64GP不支持的数据类型 个人地理数据库(.mdb)，Excel表（.xls、.xlsx） 不在后台运行的工具包括： 元数据转换工具集（Metadata conversion&nbsp;）中的工具 地理数据库管理工具集（Geodatabase administration）中的工具 所有 Coverage 工具 用于创建包（Packages）的工具 绘图工具（Graphing tools）（仅针对 64 位地理处理；这些工具在传统的 32 位后台处理中运行） 作者禁用后台处理的自定义脚本、模型或功能工具","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"安装 PythonWin","slug":"SetupPythonWin","date":"2014-05-29T08:20:12.000Z","updated":"2016-03-11T03:30:46.000Z","comments":true,"path":"2014/05/29/SetupPythonWin/","link":"","permalink":"http://www.kikitamap.com/2014/05/29/SetupPythonWin/","excerpt":"","text":"确定已安装Python的版本 在 ArcGIS Desktop 中打开命令行，输入如下命令： `import sys print(sys.version)` PythonWin下载 Python IDE 有很多，采用最常用的 PythonWin。 PythonWin 下载地址：http://sourceforge.net/projects/pywin32/files/pywin32/ 在链接中选择最新的 PythonWin 可用版本。 ArcGIS for Desktop 和 ArcGIS Engine 产品使用 32 位 Python 可执行文件； ArcGIS for Server 和 ArcGIS for Desktop—Background Geoprocessing 产品使用 64 位 Python 可执行文件。 Arcmap Python Window 与 PythonWin 的选择与对比：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Python","slug":"Python","permalink":"http://www.kikitamap.com/tags/Python/"}]},{"title":"地图投影类型","slug":"MapProjectionType","date":"2014-03-19T09:32:03.000Z","updated":"2016-03-21T07:24:28.084Z","comments":true,"path":"2014/03/19/MapProjectionType/","link":"","permalink":"http://www.kikitamap.com/2014/03/19/MapProjectionType/","excerpt":"","text":"投影坐标系在二维平面中进行定义，投影坐标系是基于地理坐标系创建的，也就是在地理坐标系的基础上加上投影算法。 坐标原点位于网格的中心，（x，y）=（0，0） Ⅰ 变形地球表面是一个曲面，从曲面至平面的数学换算即为地图投影的过程，不同投影会引起不同类型的变形，例如，导致数据的形状、面积、距离或方向发生变形。 等角投影： 等角投影保留局部形状。要保留描述空间关系的各个角，等角投影必须在地图上显示以 90 度角相交的垂直经纬网线。地图投影通过保持所有角不变来加以实现。缺点是由一些弧线围起来的区域将在此过程中发生巨大变形。地图投影无法保留较大区域的形状。 等积投影： 保留所显示要素的面积。为此，形状、角和比例等其他属性将发生变形。在等积投影中，经线和纬线可能不垂直相交。有些情况下，尤其是较小区域的地图，形状不会明显变形，且很难区分等积投影和等角投影，除非加以说明或进行测量。 等距投影： 保留某些点间的距离。任何投影都无法在整幅地图中正确保持比例不变。不过，多数情况下，地图上总会存在一条或多条这样的线：比例沿着这些线将正确地保持不变。多数等距投影都具有一条或多条这样的线：在此类线中，地图上线的长度（按地图比例尺计算）与地球上同一条线的长度相同，无论它是大圆还是小圆，是直线还是曲线。此类距离被视为真实距离。例如，在正弦投影中，赤道和所有纬线就是其真实长度。在其他等距投影中，赤道和所有经线具有真实长度。而其他投影（例如，两点等距离）仍会显示地图上一点或两点与相隔点间的真实比例。请记住，任何投影都不能实现地图上的所有点是等距离的。 Ⅱ 投影方法地图投影使用数学公式将地球上的球面坐标与平面坐标关联起来。 圆锥投影： 最简单的圆锥投影是沿一条纬线与地球相切获得的投影。这条纬线称作标准纬线。所有的经线都投影到圆锥面上，并在圆锥的顶点或某一点处相交。纬线在圆锥面上的投影是一个个环。将圆锥沿任意一条经线“剪开”后即可获得最终的圆锥投影，投影中的经线显示为汇聚到一点的直线，而纬线显示为许多的同心圆弧。与剪开线相对的经线成为中央子午线。 通常距标准纬线越远，变形就越严重。因此去掉圆锥的顶部会产生更精确的投影。此过程可以通过不使用极点区域的投影数据来实现。圆锥投影用于沿东西方向延伸的中纬度地区。 较复杂的圆锥投影会与地球表面的两处位置相接触。这类投影被称作割投影，并带有两条标准纬线。也可以使用一条标准纬线和一个比例尺因子来定义割投影。在割投影中，标准纬线之间与标准纬线之外的部分变形模式是不同的。通常，割线投影的整体变形程度小于切线投影。在更复杂的圆锥投影中，圆锥的轴并不与地球的极轴重合。此类投影称作斜轴投影。 地理要素的制图表达取决于纬线的间距。等间距排列纬线时，投影在南北方向是等距的，但不是等角或等积的。此类投影的一个示例是等距圆锥投影。对于小面积区域，整体变形是最小的。在兰勃特等角圆锥投影中，中央的纬线比靠近边缘的纬线排列得更紧密，在小比例尺和大比例尺地图中都可以保持小地理区域的形状。在阿尔伯斯等积圆锥投影中，靠近北部和南部边缘的纬线比中间的纬线更加紧密，且投影的面积不变。 圆柱投影： 与圆锥投影类似，圆柱投影也存在相切或相割两种情况。 墨卡托投影是最常用的圆柱投影之一，并且通常以赤道为切线。经线以几何方式投影到圆柱面上，而纬线以数学方式进行投影。这种投影方式产生成 90 度的经纬网格。将圆柱沿任意一条经线“剪开”可以获得最终的圆柱投影。经线等间距排列，而纬线间的间距越靠近极点越大。此投影是等角投影，并沿直线显示真实的方向。在墨卡托投影中，恒向线、等方位角线是直线，但大多数的大圆都不是直线。 对于更复杂的圆柱投影，圆柱发生了旋转，因此切线和割线的位置发生了变化。横轴圆柱投影，例如横轴墨卡托投影，使用经线作为相切的接触线，或使用平行于经线的线作为割线。这样标准线即为南北方向的线，且其上的比例是真实的。斜轴圆柱是围绕赤道和经线间的任意大圆线旋转而成的圆柱。在此类更加复杂的投影中，大多数经线和纬线都不再是直线。 在所有的圆柱投影中，切线和割线都不发生变形，因此它们是等距离线。其他的地理属性因具体的投影方式而异。 平面投影： 平面投影将地图数据投影到与地球接触的平面。平面投影也称为方位投影或天顶投影。 此类型的投影通常在一点与地球相切，但也可能相割。接触点可以是北极、南极、赤道上的某点或者赤道与两极之间的任意点。此点会指定投影中心，并将作为投影的焦点。焦点由中央经度和中央纬度标识。可能的投影方法包括极方位投影、赤道投影和斜轴投影。极方位投影是最简单的形式。纬线是以极点为中心的同心圆，经线是在极点处与其真实的方向角相交的直线。在其他投影方法中，平面投影在焦点处将具有 90 度的经纬网格角度。由焦点确定的方向是精确的。 穿过焦点的大圆由直线表示；因此从中心到地图上其他任意点的最短距离是直线。面积和形状变形后的图案是以焦点为中心的圆。由于这个原因，方位投影更适合圆形区域，而不太适合矩形区域。平面投影最常用于绘制两极地区的地图。 某些平面投影会在空间中从特定点来观测表面数据。观测点将确定球面数据如何投影到平面。在不同的方位投影中，用于观测所有位置的透视图也有所不同。透视点可以是地球的中心、与焦点正对的表面点或者地球外部的某点，就如同从卫星或其他星球上遥看一样。 有部分方位投影是按焦点和透视点（如果适用）分类的。球心投影从地心来观测表面数据，而立体投影是在两极之间进行观测。正射投影从无穷远点（如同从外太空）观察地球。注意观察透视图之间的差异如何决定与赤道相对的变形程度。 详情参见：http://resources.arcgis.com/zh-cn/help/main/10.2/index.html#//003r0000000p000000 ArcGIS 支持的全部投影的列表： http://resources.arcgis.com/zh-cn/help/main/10.2/index.html#/na/003r00000017000000/","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Coordinate System","slug":"Coordinate-System","permalink":"http://www.kikitamap.com/tags/Coordinate-System/"}]},{"title":"Landset 8 与 ArcGIS","slug":"Landset-8-与-ArcGIS","date":"2014-03-03T09:24:14.000Z","updated":"2016-03-12T13:07:42.000Z","comments":true,"path":"2014/03/03/Landset-8-与-ArcGIS/","link":"","permalink":"http://www.kikitamap.com/2014/03/03/Landset-8-与-ArcGIS/","excerpt":"","text":"如果现在使用的 ArcGIS 10.2 版本，如果需要向镶嵌数据集中添加 Landset 8 的数据，需要安装一个补丁：ArcGIS 10.2 for (Desktop, Engine, Server) Landsat 8 Patch。 下载地址：http://support.esri.com/en/downloads/patches-servicepacks/view/productid/66/metaid/2012 如果使用的是，ArcGIS 10.2.1，无需任何补丁，可以直接向镶嵌数据集中添加 Landset 8 的数据。 Landsset 8 常用的波段合成应用： Natural Color4 3 2False Color (urban)7 6 4Color Infrared (vegetation)5 4 3Agriculture6 5 2Atmospheric Penetration7 6 5Healthy Vegetation5 6 2Land/Water5 6 4Natural With Atmospheric Removal7 5 3Shortwave Infrared7 5 4Vegetation Analysis6 5 4 Landset 7 与 landset 8 对比新增波段： Landsat 7Landsat 8Band NameBandwidth (µm)Resolution (m)Band NameBandwidth&nbsp;(µm)Resolution (m)&nbsp;&nbsp;&nbsp;Band 1 Coastal0.43 – 0.4530Band 1 Blue0.45 – 0.5230Band 2 Blue0.45 – 0.5130Band 2 Green0.52 – 0.6030Band 3 Green0.53 – 0.5930Band 3 Red0.63 – 0.6930Band 4 Red0.64 – 0.6730Band 4 NIR0.77 – 0.9030Band 5 NIR0.85 – 0.8830Band 5 SWIR 11.55 – 1.7530Band 6 SWIR 11.57 – 1.6530Band 7 SWIR 22.09 – 2.3530Band 7 SWIR 22.11 – 2.2930Band 8 Pan0.52 – 0.9015Band 8 Pan0.50 – 0.6815&nbsp;&nbsp;&nbsp;Band 9 Cirrus1.36 – 1.3830Band 6 TIR10.40 – 12.5030/60Band 10 TIRS 110.6 – 11.19100Band 11 TIRS 211.5 – 12.51100","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"}]},{"title":"Shapefile 的局限性","slug":"LimitsofShapefile","date":"2014-02-27T03:10:06.000Z","updated":"2016-03-12T13:50:34.000Z","comments":true,"path":"2014/02/27/LimitsofShapefile/","link":"","permalink":"http://www.kikitamap.com/2014/02/27/LimitsofShapefile/","excerpt":"","text":"Shapefile 是一种开放的非拓扑的简单几何数据类型，深受数据处理人员的喜爱。 Shapefile 利用 dBASE 文件格式（.dbf 文件）来存储属性，dBase这种上世纪80年代的数据格式，现在基本淡出舞台。 虽然Shapefile有万般好，但是，今天还是要来说说shapefile的局限性，也就是使用限制有什么，以便合理的选择使用Shapefile数据。 1. 文件容量限制：Shapefile 每个子文件都有大小最大不能超过 2 GB ，以点要素为例，最多约能存储 7000 万个。 2. 不支持高级对象：Shapefile不支持注记要素类、关系类、拓扑关系、属性域和子类、坐标精度和分辨率等。 不支持通过参数定义的曲线（也称为圆弧曲线）。 3. 字段存储限制：Shapefile无法存储：空值，无法向上舍入数字，对 Unicode 字符串的支持不足，字段名称最长只能为 10 个字符，且在同一字段中无法同时存储日期和时间。 Shapefile支持的最大字段数为 255。若超出此上限，当转换为 shapefile 时只会转换前 255 个字段。 dBASE 文件不支持类型 blob、guid、全局 ID、坐标 ID 或栅格字段类型。 包含空值的数据类型 空值替换 数字 - 当工具需要输出“空”、无穷大或 NaN（非数字）时 -1.7976931348623158e+308（最大负值的 IEEE 标准） 数字（所有其他地理处理工具） 0 文本 “ ”（空白 - 无空格） Date 存储为零，但显示为“&lt;空&gt;” 4. 字段宽度限制： 地理数据库数据类型 dBASE 字段类型 dBASE 字段宽度（字符数） 对象 ID 数值 9 短整型 数值 4 长整型 数值 9 浮点型 浮点型 13 双精度 浮点型 13 文本 字符 254 Date Date 8 5. 性能限制&nbsp;由于形状压缩方法的不同，shapefile 所占用的空间可能为文件地理数据库或 SDE 的三到五倍。 Shapefile 的空间索引效率较数据库低。这就意味着，同地理数据库要素类相比，空间查询耗时更长。当处理大量要素时，效率低。 dBASE 文件不支持 WHERE 子句，也不支持 SQL。 当保存所做编辑时属性索引会被删除，因此必须重新创建属性索引。 6. 多面体存储限制Shapefiles 支持多面体，但不支持以下多面体的高级功能：纹理坐标、纹理及部分色带、光线法向量。 详情参考：http://resources.arcgis.com/en/help/main/10.2/index.html#/Geoprocessing_considerations_for_shapefile_output/005600000013000000/","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"shapefile与字符集编码设置","slug":"shapefileCodePage","date":"2014-02-13T05:38:36.000Z","updated":"2016-03-12T14:38:32.000Z","comments":true,"path":"2014/02/13/shapefileCodePage/","link":"","permalink":"http://www.kikitamap.com/2014/02/13/shapefileCodePage/","excerpt":"","text":"在 ArcGIS Desktop&nbsp;(ArcMap, ArcCatalog, and ArcToolbox)中，有编码页转换功能（CODE PAGE CONVERSION），可以读写多种字符编码的 shapefile 和 dBASE 表。 在系统注册表中，编码页转换功能（CODE PAGE CONVERSION）命名为 ‘dbfDefault’，可以修改这个值。 在&nbsp;ArcGIS 10.2.1 之前，可以直接按照 ‘dbfDefault’ 设置方法 到注册表中修改。 在&nbsp;ArcGIS Desktop 10.2.1 以及以后的版本，shapefile (.DBF) 的编码页的默认设置为&nbsp;UTF-8 (UNICODE) 。 更新内容（2014.8.1） ArcGIS Desktop 10.2.1 和 10.2.2 版本下需要修改编码行为，先打补丁，然后再按照 ‘dbfDefault’ 设置方法 到注册表中修改。** 10.2.1： http://support.esri.com/en/downloads/patches-servicepacks/view/productid/160/metaid/2090 10.2.2： http://support.esri.com/en/downloads/patches-servicepacks/view/productid/67/metaid/2089 ‘dbfDefault’ 的作用使用 ArcGIS for Desktop 打开 dBase 表文件时，程序先去读头文件中的 &nbsp;Language Driver ID (LDID) 或者是同名 *.CPG文件。前面二者都是用来在读文件之前，决定用什么编码类型来正确读出文件。如果有必要， ArcGIS for Desktop 会进行编码转换来显示字符串。 如果文件缺失&nbsp;LDID 或者 &nbsp;.CPG 文件，编码就会被假定为 Windows (ANSI/Multi-byte)。也是因为这个原因，如果文件是 OEM 编码的，并且没有写入 LDID 或者 .CPG，字符就会出现乱码。 也就说 ArcGIS 把 OEM 文件当成 ANSI 文件来处理了。 多数情况下， shapefiles 和 dBASE 文件都会存储编码页信息。 但是有些程序的 OEM 文件没有包含编码页信息，例如 Microsoft Access 2000 and Excel 2000，所以这些文件读取时，就会乱码。为了避免这个问题，用户可以给没有编码页信息的文件设置dbfDefault。 写 在注册表中设置 ‘dbfDefault’ ，可以决定导出的 shapefile 和 dBASE 的编码类型。例如，把 ‘dbfDefault’ 设置为 OEM ，那么用 ArcMap, ArcCatalog, ArcToolbox 生成出来的 shapefile 和 dBASE 文件就是以 OEM编码的，设置成 ANSI ，那 shapefile 和 dBASE 文件就是 ANSI 编码的。 读 读 shapefile 和 dBASE 文件的逻辑与写是相同的，如果缺失编码信息，ArcGIS 读取文件的编码类型由 dbfDefault决定。 不适用’dbfDefault’ 的情况‘dbfDefault’ 这项设置仅对 ArcGIS Desktop 生效，对于一些很老版本的ArcGIS 产品不适用；仅对 shapefile 生效，Personal GDB等不生效。 无视 ‘dbfDefault’ 设置的包括： In ArcInfo Workstation: ARCSHAPE with &amp;CODEPAGE OEM creates a shapefile in OEM&nbsp; ARCSHAPE with &amp;CODEPAGE ANSI creates a shapefile in ANSI&nbsp; INFODBASE with &amp;CODEPAGE OEM creates a dBASE file in OEM&nbsp; INFODBASE with &amp;CODEPAGE ANSI creates a dBASE file in ANSI&nbsp; In ArcView 3.x,&nbsp; Shapefile and dBASE files are saved in the ANSI code page.&nbsp; In ArcGIS for Desktop (regardless of the dbfDefault setting),&nbsp; Personal geodatabases are saved in Unicode&nbsp; Personal geodatabase tables are saved in Unicode&nbsp; Coverages are saved in the ISO code page&nbsp; INFO files are saved in the ISO code page&nbsp; Interchange files are saved in the ANSI code page&nbsp; Text files are saved in the ANSI code page ‘dbfDefault’ 设置方法 开始 – 运行，输入”Regedit“，打开&nbsp;注册表。 如是用的是 10.x 版本 ArcGIS Desktop，定位到 ‘My Computer\\HKEY_CURRENT_USER\\Software\\ESRI\\Desktop 10.x. 如果是9.3.1之前的版本，定位到 ‘My Computer\\HKEY_CURRENT_USER\\Software\\ESRI’。 创建项 Common， 接着在其下创建 CodePage 项， 添加 字符串 ，名称： dbfDefault ，健值： oem（或者936）。 如下为支持的编码值： OEM Code Page Values: OEM, 437, 708, 720, 737, 775, 850, 852, 855, 857, 860, 861, 862, 863, 864, 865, 866, 869, 932, 936, 950 ANSI Code Page Values: ANSI, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, Big5, SJIS&nbsp; ISO Code Page Values: ISO, 88591, 88592, 88593, 88594, 88595, 88596, 88597, 88598, 88599, 885910, 885913, 885915, EUC Unicode Values: UTF-8 现在，Shapefiles 可以以 UTF-8 存储，但是，只有在 ArcGIS Desktop 中才能被识别。 相关技术文章： http://support.esri.com/en/knowledgebase/techarticles/detail/21106","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"3D分析之可见性分析工具","slug":"3DVisibility","date":"2014-02-11T03:41:38.000Z","updated":"2016-03-12T15:13:58.000Z","comments":true,"path":"2014/02/11/3DVisibility/","link":"","permalink":"http://www.kikitamap.com/2014/02/11/3DVisibility/","excerpt":"","text":"ArcGIS 通过分析功能面的视域来确定不同区域中的可见性。 视域的计算：如果仅有一个观测点，则为可从观测点看到的单元赋值 1，为无法从观测点看到的所有单元赋值 0。 1. Construct Sight Lines（构造视线）创建表示视线（从一个或多个视点到目标要素类的要素）的线要素。 注意，关于高度字段的认定： 观察点和目标要素的高度源默认为以下列表中遇到的第一个字段名称： Shape.Z（只对启用 Z 值的要素可用） Spot Z Z_Value Height Elev Elevation Contour 使用连接字段为给定观察点指定一个或多个目标。如果未使用连接字段，则将所有点连接到所有目标。 2. Line of Sight（通视分析）确定由多面体、栅格、TIN、terrain 或 LAS 数据集定义的表面上视线的可见性。 理想的视线应是简单的直线，包括两个折点，分别代表用于确定可见性的观测点和目标位置。 视线可以用前面的构造视线工具生成。 可以可选生成，阻挡每个线的目标可见性的第一个障碍物的位置。 输出线要素的属性表包含以下字段： SourceOID - 用于计算可见性的线要素的唯一 ID。 VisCode - 沿线的可见性。值为 1 表示可见，值为 2 表示不可见。该字段仅在输出几何是线的情况下存在。 TarIsVis - 沿线的目标可见性。值为 1 表示可见，值为 0 表示不可见。该字段仅在输出几何是线的情况下存在。 OBSTR_MPID - 阻碍通视线的多面体的唯一 OID。如果不存在阻碍通视线的多面体，则该字段含有一个为 -1 或 -9999 的值。如果目标被表面所阻碍，则该值为 -1。如果目标可见，则值为 -9999。 3. Observer Points（视点分析）识别从各栅格表面位置进行观察时可见的观察点。 确定观察点是信息密集型处理。处理时间取决于分辨率。 Skyline（天际线）生成一个包含天际线轮廓分析结果的线要素类或多面体要素类。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"LAS Dataset 概览","slug":"LASDatasetOverview","date":"2014-02-11T03:40:11.000Z","updated":"2016-03-12T15:24:04.000Z","comments":true,"path":"2014/02/11/LASDatasetOverview/","link":"","permalink":"http://www.kikitamap.com/2014/02/11/LASDatasetOverview/","excerpt":"","text":"一、了解激光雷达Lidar(Light Detection And Ranging)：激光探测及测距，是一种光学遥感技术，使用激光对地球表面的密集采样，产生高精度X、Y、Z测量值。 激光雷达系统的主要硬件组成部分包括一组车辆（飞机、直升机、车辆以及三脚架）、激光扫描系统、GPS（全球定位系统）和 INS（惯性导航系统）。INS 系统测量激光雷达系统的滚动角、俯仰角与前进方向。 激光雷达是一个主动光学传感器，它在沿着特定的测量路径移动时向一个目标发射激光束。激光雷达传感器中的接收器会对从目标反射回来的激光进行检测和分析。这些接收器会记录激光脉冲从离开系统到返回系统的精确时间，以此计算传感器与目标之间的范围距离。这些距离测量值会与位置信息（GPS 和 INS）一起转换为对象空间中反射目标实际三维点的测量值。完成激光雷达数据采集测量之后，将通过分析激光的时间范围、激光的扫描角度、GPS 位置和 INS 信息将点数据后处理成高度精确的地理配准 x,y,z 坐标。 采集到的激光雷达点的附加信息与 x、y 和 z 位置值存储在一起。为每个记录的激光脉冲保留以下激光雷达点属性：强度、回波编号、回波数、点分类值、在飞行航线边缘的点、RGB（红、绿和蓝）值、GPS 时间、扫描角度和扫描方向。 二、激光雷达的类型：i &nbsp; 机载激光雷达（Airborne） A）地形探测激光雷达（Topographic lidar） 应用如如林业、水文、地貌、城市计划、景观生态、海岸工程、调查评估和体积计算等。 B）深海探测激光雷达（Bathymetric lidar） ii &nbsp;陆地激光雷达（Terrestrial lidar）A）移动（Mobile）： 可安装在车辆、火车甚至轮船上。 B） 固定（Static）： 三脚架等。 三、激光雷达的存储：LAS 是美国摄影测量与遥感协会 (ASPRS) 所创建和维护的行业格式。每个 LAS 文件都在页眉块中包含激光雷达测量的元数据，然后是所记录的每个激光雷达脉冲的所有记录。每个 LAS 文件的页眉部分都保留有激光雷达测量本身的属性信息：数据范围、飞行日期、飞行时间、点记录数、返回的点数、使用的所有数据偏移以及使用的所有比例因子。为 LAS 文件的每个激光雷达脉冲保留以下激光雷达点属性：x,y,z 位置信息、GPS 时间戳、强度、回波编号、回波数目、点分类值、扫描角度、附加 RGB 值、扫描方向、飞行航线的边缘、用户数据、点源 ID 和波形信息。 最初，激光雷达数据以 ASCII 格式交付。由于激光雷达数据集合非常庞大，所以不久之后，开始采用一种称为 LAS 的二进制格式来管理和标准化激光雷达数据的组织和传播方式。现在，以 LAS 表示的激光雷达数据十分常见。LAS 是一种可接受性更强的文件格式，因为 LAS 文件包含的信息更多，而且由于采用二进制，所以导入程序可以更高效地读取。 ArcGIS 支持以 ASCII 或 LAS 文件格式提供的激光雷达数据。ArcGIS支持LAS版本1.0，1.1，1.2和1.3。使用 LAS 版本 1.3 时可用的波形信息不受支持。此外，支持与 1.3 版兼容的 1.4 版 LAS 文件，包含 0-5 的点记录格式。不支持包含 6-10 点记录格式的 1.4 版 LAS 文件。 四、激光雷达点分类：每个激光雷达点都可分配一种分类，用于定义反射激光雷达脉冲的对象的类型。可将激光雷达点分成很多个类别，包括地面、裸露地表、冠层顶部和水域。使用 LAS 文件中数字整数代码可定义不同的类。对于 LAS 格式 1.1、1.2 或 1.3，分类代码由美国摄影测量与遥感协会 (ASPRS) 定义。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"ArcGIS Desktop 与 Excel","slug":"ArcGIS-DesktopVSExcel","date":"2014-02-11T03:35:40.000Z","updated":"2016-03-12T15:41:58.000Z","comments":true,"path":"2014/02/11/ArcGIS-DesktopVSExcel/","link":"","permalink":"http://www.kikitamap.com/2014/02/11/ArcGIS-DesktopVSExcel/","excerpt":"","text":"微软 OFFICE 产品中，Excel是很强大，并且平民化的表格制作工具。ArcGIS 用户会经常需要在两种软件中做交互，今天就来说一说&nbsp;ArcGIS Desktop 与 Excel。 ArcGIS Desktop 中访问 Excel 数据Excel 表可直接在 ArcGIS 中打开，使用方法与其他表格数据源类似。例如，可以向 ArcMap 中添加这种表、在 ArcCatalog 中预览这种表，并可将这种表作为地理处理工具的输入数据。 通过 ArcGIS 进行访问Excel表时，每个工作表在 ArcGIS 中都是一个单独的表，名称末尾带有美元符号 $ 标识，但是这个$并不是表名的一部分。如果工作表的表名中包含空格，那表名称周围会括有单引号。 对于ArcGIS Desktop 对 office 版本的支持情况ArcGIS 支持 ： Excel 2003 以及更早版本的 .xls 文件； Excel 2007 的 .xlsx 文件。 为什么要分开说呢？ *.xls 文件可以直接在ArcGIS中以只读的形式打开，例如直接在ArcMap中添加数据、在ArcMap中添加XY数据显示为点、在ArcCatalog中进行查看等等。 而 .xlsx 文件打开时，需要有一个数据驱动。如果我们遇到这个错误：“ *Failed to connect to ddatabase. An underlying database error occured. 没有注册类”，那就是缺少驱动的结果。 一般如果我们安装了 MS Office 2010 或者 2013，或者根本就没有安装 Office，这个错误必然会遇到了。 需要安装 &nbsp;2007 Office System 驱动程序（AccessDatabaseEngine.exe），下载英文版点这里，中文版点这里，这个包的官方说明如下： 这个程序安装之后，上述错误即可解决。 ArcGIS访问Excel表时，字段类型的确定ArcGIS 访问 Excel 时，字段名称从工作表各列的首行中获取。 在 Excel 中指定的字段类型对 ArcGIS 中显示的字段类型不起任何决定作用。ArcGIS 中的字段类型是由该字段的头八行值扫描决定的。 如果在单个字段中扫描到混合数据类型，则该字段将以字符串字段的形式返回，并且其中的值将被转换为字符串。 在 ArcGIS 中，数值字段将被转换为双精度数据类型。 其他问题 如果不想安装前面的驱动，最快的办法使得ArcGIS能够访问2007以后版本的表格文档，那就另存为97-2003版本的 *.xls了。 想把要素类的属性表导出来以供Excel使用，那就将属性表导出为 *.dbf 格式，然后打开方式使用 Excel 即可。 使用工具 Export to Excel 也可以将表导出为 Excel 表。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"DEM渲染洼地淹没图","slug":"DEMRendering","date":"2014-01-23T03:13:31.000Z","updated":"2016-03-12T15:49:14.000Z","comments":true,"path":"2014/01/23/DEMRendering/","link":"","permalink":"http://www.kikitamap.com/2014/01/23/DEMRendering/","excerpt":"","text":"首先要准备基础数据，一张DEM栅格图。 然后将掩膜水位以下的数据提取出来以备后用。这里我提取了高程1000以下的像元。 对这个图层设置分类渲染，并设置半透明： 效果： 生成DEM山影图，使用空间分析工具箱中的 Hillshade 叠在一起就很漂亮了，可以表示，某个高度下水淹没的情况。 3D效果：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"ArcGIS中的地理坐标系转换方法参数（二）","slug":"GeographicTransformation2","date":"2014-01-19T02:37:38.000Z","updated":"2016-03-21T07:24:15.331Z","comments":true,"path":"2014/01/19/GeographicTransformation2/","link":"","permalink":"http://www.kikitamap.com/2014/01/19/GeographicTransformation2/","excerpt":"","text":"&nbsp; &nbsp; 上篇博客说的是 Project 工具中 Geographic Transformation 参数什么情况下是必填的。 &nbsp; &nbsp; &nbsp;另外，Project 是矢量数据的坐标系变换工具，如果数据源是栅格数据，需要使用 Project Rater 工具。 &nbsp; &nbsp; &nbsp;这篇博客主要写一下，有关自定义地理变换方法。 &nbsp; &nbsp; &nbsp;ArcGIS 中提供地理变换方法主要有这几种：Geocentric_Translation、Molodensky、Molodensky_Abridged、Position_Vector、Coordinate_Frame、Molodensky_Badekas、NADCON、HARN、NTV2、Longitude_Rotation、Unit_Change 和 Geographic_2D_Offset。可使用“创建自定义地理变换（Creat Custom Geographic Transformation）”工具来创建转换方法。地理坐标系包含了基于椭圆体的基准面，因此地理变换会更改基础椭圆体。在基准面间进行变换的方法很多，这些方法具有不同的精度和范围。 &nbsp; &nbsp; &nbsp;地理变换是针对地理坐标系的，也就是经纬度坐标进行转换，如果输入数据的坐标系中还包含了平面坐标系（投影），在使用 Project 工具的过程中会自动做相应的投影变换，转到地理坐标系，地理变换后，如果需要再转为相应的投影坐标系。 PS：&nbsp; &nbsp; 所有的自定义地理变换文件都将存储为扩展名为 .gtf 的文件，并存储在用户 Application Data 文件夹下的 ESRI\\&lt;ArcGIS product&gt;\\ArcToolbox\\CustomTransformations 文件夹中。自定义变换文件不能进行编辑。它们为二进制文件，用来储存版本和字符串长度信息，如果在ArcGIS之外进行自行编辑，可能会被损坏。 下面我们来看看常用的转换方法吧，帮助中有介绍，我下面来个精简整理版的： _1）GeocentricTranslation 地心变换，也就是我们常说的三参数变换，是最简单的基准面变换方法。地心变换在 XYZ 或 3D 直角坐标系中对两个基准面间的差异情况进行建模。定义一个基准面使其中心为 0,0,0。相距一定距离定义另一个基准面（dx,dy,dz 或 ΔX,ΔY,ΔZ，单位为米）。 &nbsp; 图示：&nbsp; &nbsp;&nbsp;&nbsp; 方程：&nbsp; 2）Coordinate Frame，Position&nbsp;Vector 这两种方法是我们常说的七参数变换，或者布尔沙模型。通过对三参数变换再增加四个参数可实现更复杂和精确的基准面变换。七个参数是指三个线性平移量 (dx,dy,dz)、绕各轴的三个角度旋转值 (rx,ry,rz) 和一个比例尺因子。旋转值以十进制秒为单位给定，而比例尺因子采用百万分率 (ppm)。 &nbsp;图示：&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;方程： 为什么七参数有上面两种方法？其实可以认为是一种模型，只是不同的国家对旋转量的正负号定义标准不同而已。 坐标框架旋转变换（coordinate frame），美国和澳大利亚的定义，逆时针旋转为正； 位置矢量变换（position vector），欧洲的定义，逆时针旋转为负。 另外，_莫洛金斯基–巴德卡斯（MolodenskyBadekas）方法是七参数方法的变型。它具有三个附加参数，用于定义旋转点的 XYZ 原点。 _3）Molodensky，MolodenskyAbridged 莫洛金斯基方法直接在两种地理坐标系之间转换，实际上无需转换到 XYZ 系统。莫洛金斯基方法需要三个平移量 (dx,dy,dz) 以及两个旋转椭球体的长半轴 (Δa) 和扁率 (Δf) 的差。 这种方法，相对用的少，方程我就不粘了，详见帮助： http://resources.arcgis.com/en/help/main/10.2/index.html#/na/003r00000012000000/ OK，今天就到这里了~","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Coordinate System","slug":"Coordinate-System","permalink":"http://www.kikitamap.com/tags/Coordinate-System/"}]},{"title":"ArcGIS中的地理坐标系转换方法参数（一）","slug":"GeographicTransformation1","date":"2014-01-17T10:00:00.000Z","updated":"2016-03-21T07:24:08.154Z","comments":true,"path":"2014/01/17/GeographicTransformation1/","link":"","permalink":"http://www.kikitamap.com/2014/01/17/GeographicTransformation1/","excerpt":"","text":"地理坐标系变换是数据处理过程中常遇到的问题，今天就说下这方面的问题。 如果遇到这种情景：两份数据有不同的坐标系，想叠加在一起显示，作图或显示精度要求不高。 这种情况使用 ArcMap 的动态投影即可，ArcMap 的内部动投影机制会解决地理坐标系变换的问题。数据在显示的过程中，会实时的被转换，但不改变数据本身。 如果我们需要进行地理坐标系转换，我们知道 ArcGIS Desktop 中提供了 Project 工具。 此工具界面上有个至关重要的参数：Geographic Transformation。我们发现它的后面赫然写着。依照使用其他工具的经验，这种打了 Optional 标志的参数，不就是可填可不填的意思吗？ 但是，它真的让你随便的可填可不填吗？ Naive！ 图样图森破！ 这个参数的填写与否，完全是受前面两个参数决定的，主要三种情景吧。 情景1： 不涉及到地理坐标系变换的坐标变换，这个参数完全不需要，而不是 optional 哦。 例如：从 GCS_Xian_1980 进行投影变换，转换为 Xian_1980_3_Degree_GK_CM_120E 投影坐标系。 整过转换中，仅使用了高斯克吕格投影变换，没有涉及到地理坐标变换。 情景2： 涉及到地理坐标系变换的坐标变换，并且ArcGIS 已知二者之间的变换方法，这个参数是必须的，在已知列表中做选择或者自定义。（自定义见：情景3） 例如：从&nbsp;GCS_Beijing_1954，转换为&nbsp;GCS_WGS_1984坐标系。 转换过程中涉及到地理坐标系变换，也就是进行了椭球体变换。 ArcGIS 中提供了6种已知转换方法，可以根据适用范围选择之。其中如何选择，此文不做介绍，请查看我的另一篇博客：http://blog.csdn.net/kikitamoon/article/details/12914477 情景3： 涉及到地理坐标系变换的坐标变换，并且ArcGIS 未知二者之间的变换方法，也就是ArcGIS没有提供转换方法，但是这个参数是必须的，需要自定义，这个参数前会亮绿灯，告诉用户，必须要填写。另外，上面情景2中，ArcGIS给出的方法，如果都不是自己需要的，也需要自定义。 例如：从&nbsp;GCS_Beijing_1954，转换为&nbsp;GCS_Xian_1980坐标系。 需要使用工具 Creat Custom Geographic transformation，创建一种转换方法，辅助 Project 工具。 这个工具的帮助如下，就不赘述了。 http://resources.arcgis.com/zh-cn/help/main/10.2/index.html#//001700000076000000 补充： 讲到这里全部的情形都涵盖了。有的同学会问，为什么会这样呢？ArcGIS为啥就不能都知道转换方法呢？为啥偏要我们自定义呢？好麻烦的耶%￥#@…… 有些坐标系转换的参数是不公开的，属于涉密的内容，所以ArcGIS是没有权利知道变换方法的。例如与 Xian 80 有关的变换。原文：Some geographic coordinate systems do not have any publicly known transformations because that information is considered to have strategic importance to a government or company.&nbsp; 好了，至此，大致就知道这个参数什么时候不需要，什么时候需要，如果没有如何得到，这几个问题。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Coordinate System","slug":"Coordinate-System","permalink":"http://www.kikitamap.com/tags/Coordinate-System/"}]},{"title":"CityEngine支持多少种栅格数据？","slug":"RasterSupportinCityEngine","date":"2014-01-06T03:11:29.000Z","updated":"2016-03-12T16:06:18.000Z","comments":true,"path":"2014/01/06/RasterSupportinCityEngine/","link":"","permalink":"http://www.kikitamap.com/2014/01/06/RasterSupportinCityEngine/","excerpt":"","text":"&nbsp; &nbsp; 许多用户会问 CityEinge 到底支持多少种栅格数据作为底图数据？ &nbsp; &nbsp; CityEngine目前的帮助文档略显单薄，作为工具书查看是很好的，但是作为知识类资料就不如ArcGIS Desktop的帮助文档完整饱满。因此像“栅格数据支持列表”这种归纳性的文档当然现在还是没有…… &nbsp; &nbsp; 只能从软件界面自身去寻找了，就把这页贴出来，方便大家参考。从以下这个长长的下列表中可以了解CityEngine支持的类型： （png，jpg，tif，jpeg，img，data，ico，xpm，dds，tga，psp，tiff，vbs，sid，mpeg，jsl，xbm，sit，bmp，mpg，dat，com，hqx，cur，dll，bin，emf，exe，gif，xyz，sgi） &nbsp; &nbsp;CityEngine在显示栅格数据时，对数据有一定的要求，不满足要求时可能会出现不显示等情况。 &nbsp; &nbsp;CityEngine使用了OpenGL技术用于3D模型/场景的显示，当显示模型的时候，会将所有的texture数据输入到显存（不是内存哦！）显存的大小在机器中通常是不大的（256M~1.5G，或者更大一点吧），因此CE对输入的栅格数据是要求的。 &nbsp; &nbsp; 为了获取最佳的效果，如下几点要注意哦~ （1）显卡驱动一定要安装至最新版本！ （2）Texture图层尽量选择 8-bit 的，terrain 图层中的Heightmap也可以是32-bit的。 （3）栅格数据的行列数会影响显示，过多的行列数会导致显示失败，这个具体的数目与硬件也是相关的。通常如果发现不能正常显示时，可以考虑通过ArcGIS Desktop 中的重采样将数据的降低分辨率。 附上esri美国论坛上工程师发的一个帖子： http://forums.arcgis.com/threads/54072-textures-raster-files-concepts-in-CityEngine-ArcGIS 以及，添加 Terrain 图层的帮助文档： http://cehelp.esri.com/help/index.jsp","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"},{"name":"CityEngine","slug":"CityEngine","permalink":"http://www.kikitamap.com/tags/CityEngine/"}]},{"title":"shapefile与GDB中不能允许存在的几何错误","slug":"GeometryErrorinshapefileGDB","date":"2013-12-05T03:36:17.000Z","updated":"2016-03-15T09:56:50.000Z","comments":true,"path":"2013/12/05/GeometryErrorinshapefileGDB/","link":"","permalink":"http://www.kikitamap.com/2013/12/05/GeometryErrorinshapefileGDB/","excerpt":"","text":"每种软件都有自己的数据规范，ArcGIS也不例外，当数据不满足ArcGIS的规范时，就会遇到各种无响应和崩溃。 有关数据几何错误总是问题相对较多的部分。其中，shapefile作为一种开放的格式，除了ArcGIS程序可以读写，也可以按照数据规范在非ArcGIS环境中生产。后者生产的数据通常包含这样那样的问题，这些问题都是几何错误的范畴。 帮助原文说的精辟： The shapefile is an open format to which many software packages write. Unfortunately, some of these software packages—sometimes due to bugs, sometimes due to lack of knowledge—do not follow the documented specification of the shapefile format. 简单罗列下ArcGIS中不能允许的几何错误类型： 短线段/Short segmentSome segments are shorter than allowed by the system units of the spatial reference associated with the geometry. 空几何/Null geometryThe feature has no geometry or nothing in the SHAPE field. 不正确的环顺序/Incorrect ring orderingThe polygon is topologically simple, but its rings may not be oriented correctly (outer rings—clockwise, inner rings—counterclockwise). 不正确的线段方向/Incorrect segment orientationIndividual segments are not consistently oriented. The “to” point of seg i should be incident on the “from” point of seg i+1. 自相交/Self intersectionsA polygon must not intersect itself. 非封闭环/Unclosed ringsThe last segment in a ring must have its “to” point incident on the “from” point of the first segment. 空部分/Empty partsThe geometry has multiple parts and one of them is empty (has no geometry). 重复折点/Duplicate vertexThe geometry has two or more vertices with identical coordinates. 属性不匹配/Mismatched attributesThe Z or M coordinate of a line segment’s endpoint does not match the Z or M coordinate of the coincident endpoint on the next segment. 不连续部分/Discontinuous partsOne of the geometry’s part is made up of disconnected or discontinuous parts. 空Z值/Empty Z valuesThe geometry has one or more vertex with empty Z value (NaN, for example). 以上的错误，可以用使用工具 Check Geometry 进行检查，工具会生成有关几何错误的报表。使用 Repaired Geometry 工具进行修复。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"Sans Serif 和 Serif 字体","slug":"SansSerifVSSerif","date":"2013-12-02T04:03:03.000Z","updated":"2016-03-16T08:03:54.000Z","comments":true,"path":"2013/12/02/SansSerifVSSerif/","link":"","permalink":"http://www.kikitamap.com/2013/12/02/SansSerifVSSerif/","excerpt":"","text":"在西方国家罗马字母阵营中，字体分为两大种类：Sans Serif和Serif，打字机体虽然也属于Sans Serif，但由于是等宽字体，所以另外独立出 Monospace 这一种类，例如在Web中，表示代码时常常要使用等宽字体。 Serif的意思是，在字的笔画开始及結束的地方有额外的装饰，而且笔画的粗细会因直橫的不同而有不同。相反的，Sans Serif则沒有这些额外的装饰，笔画粗细大致差不多。如下图： 可以看出，我们平时所用的Georgia、Times New Roman等就属于Serif字体，而Arial、Tahoma、Verdana等则属于Sans Serif字体。对中文而言，同样存在这两大种类，很明显，宋体、细明体（繁体中常用）等就属于Serif，而黑体、幼圆等则属于Sans Serif。 Serif 和 Sans Serif 的一般比较： Serif的字体容易辨认，因此易读性较高。反之Sans Serif 则较醒目，但在行文阅读的情況下，Sans Serif 容易造成字母辨认的困扰，常会有来回重读及上下行错乱的情形。 Serif 强调了字母笔画的开始及结束，因此较易前后连续性的辨识。 Serif 强调一个word，而非单一的字母，反之Sans Serif则强调个别字母。 在小字体的场合，通常 Sans Serif 比 Serif 更清晰。 适用用途： 通常文章的內文、正文使用的是易读性较佳的 Serif 字体，这可增加易读性，而且长时间阅读下因为会以word为单位来阅读，较不容易疲倦。而标题、表格內用字则采用较醒目的Sans Serif字体，它需要显著、醒目，但不必长时间盯著这些字来阅读。 像宣传品、海报类，为求醒目，它的短篇的段落也会采用Sans Serif字体。但在书籍、报刊杂志，正文有相当篇幅的情形下，则应采用Serif字体来减轻读者阅读上的负担。在Web设计及浏览器设置中也应遵循此原则为是。 相关链接： http://www.w3.org/TR/CSS21/fonts.html#propdef-font-family","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Mapping","slug":"Mapping","permalink":"http://www.kikitamap.com/tags/Mapping/"}]},{"title":"Beijing_1954_To_WGS_1984","slug":"Beijing1954ToWGS1984","date":"2013-10-21T09:49:49.000Z","updated":"2016-03-21T07:27:10.905Z","comments":true,"path":"2013/10/21/Beijing1954ToWGS1984/","link":"","permalink":"http://www.kikitamap.com/2013/10/21/Beijing1954ToWGS1984/","excerpt":"","text":"Table 1: Geographic (datum) transformations: well-known IDs, accuracies and areas of use","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Coordinate System","slug":"Coordinate-System","permalink":"http://www.kikitamap.com/tags/Coordinate-System/"}]},{"title":"CityEngine Web Viewer IIS 部署","slug":"CityEngineWebViewerIIS","date":"2013-09-11T06:43:49.000Z","updated":"2016-03-16T08:53:16.000Z","comments":true,"path":"2013/09/11/CityEngineWebViewerIIS/","link":"","permalink":"http://www.kikitamap.com/2013/09/11/CityEngineWebViewerIIS/","excerpt":"","text":"中文原文链接： http://blog.csdn.net/arcgis_all/article/details/8363728 esri原文链接： http://www.arcgis.com/home/item.html?id=38fede3935a440e49cf316dcae6aae47 重点提出来，方便配置： （1）先找到 webviewer 文件夹，在CE工作空间下ce.lib 文件夹下； （2）将 webviewer 文件夹丢到 wwwroot 文件夹下； （3）计算机管理中，webviewer目录中，双击打开右边的窗口中选中MIME类型，添加类型，如下图： 参数项： 文件扩展名： .3ws MIME类型：application/octet-stream 访问地址：http://localhost/webviewer/ceviewer_offline.html","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"},{"name":"CityEngine","slug":"CityEngine","permalink":"http://www.kikitamap.com/tags/CityEngine/"}]},{"title":"ArcGIS License Manager 静默授权命令摘录","slug":"ArcGISLMSilentAuthorization","date":"2013-08-06T09:31:21.000Z","updated":"2016-03-16T09:10:02.000Z","comments":true,"path":"2013/08/06/ArcGISLMSilentAuthorization/","link":"","permalink":"http://www.kikitamap.com/2013/08/06/ArcGISLMSilentAuthorization/","excerpt":"","text":"在命令行中，将目录更改为许可管理器安装位置。Windows 上的默认位置是 C:\\Program Files (x86)\\ArcGIS\\License10.1\\bin。 在命令的末尾添加 -verbose，可以在命令窗口中显示进度和错误消息。 以静默方式授权： softwareauthorizationls.exe -s -lif -ver10.1 &quot;c:\\temp\\&lt;*.prvs&gt;&quot; 当离线授权时，此命令还可以与 *.resps 文件结合使用。当授权单机版 Desktop 或 Engine 许可时，可使用 .prvc 和 .respc。 为离线授权创建一个 .txt 授权文件： softwareauthorizationls.exe -s -lif -ver 10.1 &quot;C:\\Temp\\&lt;.prvs&gt;&quot; -out &quot;C:\\Temp\\authorize.txt&quot; 以静默方式取消授权： 要从机器中取消所有许可的授权，请运行 softwareauthorizationls.exe -s -return all。 要从机器中取消特定许可的授权，您需要输入要取消授权的具体授权码。运行 softwareauthorizationls.exe -s -return EFLxxxxxxxxx,EFLxxxxxxxxx。 以静默方式升级许可： 要在机器中升级所有许可，请运行 softwareauthorization.exe -s -upgrade all。 要在机器中升级特定许可，您需要输入具体的授权码。运行 softwareauthorization.exe -s -upgrade EFLxxxxxxxxx,EFLxxxxxxxxx。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"License","slug":"License","permalink":"http://www.kikitamap.com/tags/License/"}]},{"title":"将度-分-秒值转换为十进制度","slug":"ConvertDMS","date":"2013-07-22T02:21:29.000Z","updated":"2016-03-16T09:49:56.000Z","comments":true,"path":"2013/07/22/ConvertDMS/","link":"","permalink":"http://www.kikitamap.com/2013/07/22/ConvertDMS/","excerpt":"","text":"在ArcMap中，在表中新建一个字段，用于存储新的十进制度值，使用字段计算器和 VB 脚本实现。 如下示例，其中，假设 Latitude 是表中存储 DMS 纬度值字段的名称，经纬度数据中的度分秒三个数据是以空格分隔。 123456789101112131415Dim DegreesDim MinutesDim SecondsDim DMSDim DDDMS = Split([Latitude])Degrees = CDbl(DMS(0))Minutes = CDbl(DMS(1))Seconds = CDbl(DMS(2))If Degrees &lt; 0 Then DD = -(Seconds/3600) - (Minutes/60) + DegreesElse DD = (Seconds/3600) + (Minutes/60) + DegreesEnd If PS：使用到的VBScript 函数： （1）Split： Split(expression[,delimiter[,count[,compare]]]) （2）CDbl： CDbl 函数可把表达式转换为双精度（Double）类型。 结果示例：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"聚焦等值面的创建","slug":"BuildingCountor","date":"2013-07-12T04:28:36.000Z","updated":"2016-03-16T09:57:48.000Z","comments":true,"path":"2013/07/12/BuildingCountor/","link":"","permalink":"http://www.kikitamap.com/2013/07/12/BuildingCountor/","excerpt":"","text":"&nbsp; &nbsp; 日常我们会碰到有很多根据已知采样点生成等值面、等值线的需求，。由散点采样值估算相应区域，我们一般会想到插值，这样就获得了这个区域的连续表面。 &nbsp; &nbsp; 在ArcGIS中，插值的方法较多，主要有两个扩展模块的功能可以选用。一般情况下可以选择 Spatial Analyst 工具箱中，IDW，Kriging等方法进行插值。如果有更加复杂的参数设置和更加专业深入的插值分析，可以使用 Geostatistical Analyst，这里暂不赘述。 &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; 这里以IDW插值为例，简述等值面、等值线的生成。 一、采样点插值例如获取了如下一组点的臭氧浓度的采样值： 使用 IDW 工具，设置输入数据，插值使用的字段，搜索半径等参数，获得栅格表面。 二、等值线的获取Spatial Analyst 中提供了从栅格表面提取等值线的工具，Contour，设置等值线间隔，以及选择设置起算线。 &nbsp;&nbsp; 得到结果： &nbsp; &nbsp; &nbsp;&nbsp; 三、等值面提取在做等值面之前，我们需要思考下，等值面是指什么？等值面是否是两条等值线之间的闭合区域？等值面的划分依据是什么？ 先说一种比较常用的场景，得到等值线后，为了美化制图，等值线之间的间隔也需要用渐变色予以填充，通常想到的方案是使用工具 Feature to Polygon。这样就得到了与等值线无缝贴合的等值面。如下图： 从而获得等值面，这个类似于等间距分类或者等值面的方法。 如果抛开等值线而言，比较准确的获取等值面的方法是什么呢？ 答案是对栅格表面进行重分类，用一定的数学算法将数据进行数值的重新划分与赋予。 下面来总结一下方案： （1）使用工具 Reclassify 进行栅格数据重分类： 如下是一个由高程采样点获得的DEM，然后进行重分类，分类方法是等间距法： PS：分类是有很多方法可以选择的，具体在分类面板中可以设置： （2）然后将栅格数据转为矢量面: 使用转换工具， Raster to Polygon，得到矢量等值面： （3）等值面，等值线的后期平滑处理 由栅格数据得到的矢量数据，通常边界会出现很多方格子或者锯齿，后面要做的工作就是对面进行平滑和美化，当然这步是选做工作了。 前两步是数据的真实提取，这一步就是对地图画个妆，把最佳的效果展示出来。 为了防止直接平滑面出现边界不重合的问题，建议对面转线（Feature to line），平滑线后再转回面。做了个模型，把这个思路完整的展现出来，如下图： 这样就会得到相对漂亮平滑的等值线和等值面。 细节对比图： 以上就是制作等值面的方法。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"在ArcGIS Desktop 中导入 Arcpy","slug":"ImportArcpy","date":"2013-07-02T08:01:37.000Z","updated":"2016-03-16T10:05:42.000Z","comments":true,"path":"2013/07/02/ImportArcpy/","link":"","permalink":"http://www.kikitamap.com/2013/07/02/ImportArcpy/","excerpt":"","text":"在导入 ArcPy 之后，可以运行随 ArcGIS 安装的标准工具箱中的所有地理处理工具。 import arcpy 1.导入整个模块模块通常是一个包含函数和类的 Python 文件。 ArcPy 包括数据访问模块 (arcpy.da)、制图模块 (arcpy.mapping)、ArcGIS Spatial Analyst 扩展模块模块 (arcpy.sa) 和 ArcGIS Network Analyst 扩展模块模块 (arcpy.na)。 1import arcpy.mapping Python 的核心 os 和 sys 模块，也可使用此命令。例如： 12import osimport sys 2.导入模块的一部分如果只导入某一模块的一部分，可以使用 from-import 语句。 12from arcpy import envenv.workspace = \"c:/data\" 使用from-import-as 的形式，为其制定名称。 12from arcpy import env as ENVENV.workspace = \"c:/data\" 再来个例子： 12from arcpy import mapping as MAPmxd = MAP.MapDocument(\"C:/maps/basemap.mxd\") 3. 导入模块全部内容模块的内容将被直接导入到命名空间中，随后无需添加前缀。在某些情况下，from-import-* 可以简化代码。 1234567891011# Import arcpy and the sa module as *import arcpyfrom arcpy.sa import *arcpy.CheckOutExtension(\"spatial\")# Get input parameters#inRaster1 = arcpy.GetParameterAsText(0)inRaster2 = arcpy.GetParameterAsText(1)inRaster3 = arcpy.GetParameterAsText(2)outRaster = (Raster(inRaster1) + (Raster(inRaster2) - Raster(inRaster3)))","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Python","slug":"Python","permalink":"http://www.kikitamap.com/tags/Python/"}]},{"title":"ArcGIS Data Driven Page","slug":"ArcGISDataDrivenPage","date":"2013-06-26T02:08:20.000Z","updated":"2016-03-16T10:13:46.000Z","comments":true,"path":"2013/06/26/ArcGISDataDrivenPage/","link":"","permalink":"http://www.kikitamap.com/2013/06/26/ArcGISDataDrivenPage/","excerpt":"","text":"通过 “Data Driven Page” 可以基于单个地图文档，快速创建一系列布局页面。按照图层中的各个索引要素，将地图分割为多个部分，分别生成相应的地图。 可见，索引要素是决定地图出图的重要部分，常见的索引方式，例如：网格索引，带状索引等等。 Data Driven Page 工具条上的设置，主要也是来配置索引图层，那索引图层如何制作？ &nbsp; ArcGIS 提供了一系列制作和准备 Data Driven Page 的 GP工具。 此工具可以创建可用作索引的矩形格网面，如下图所示，其中格网的标注表示了PageName： 索引网格面的属性表： 格网索引在于给有数据的位置创建期望网格大小的矩形要素，不仅适用于面要素，点，线也同样的，如下： &nbsp;&nbsp; &nbsp;&nbsp; 2. Strip Map Index Feature该工具可根据单个线状要素或一组线状要素，创建一系列矩形面索引要素。用于根据线状要素定义一幅带状地图或一组地图中的页面。 对应生成的索引数据中，属性表中很好的记录了各幅地图的对应关系，Angle 记录了数据框需要旋转的角度，如下图： 3. Calculate Adjacent Fields此工具最常用于填充地图册中相邻页面的标注字段。此工具将向输入要素类追加八个新字段（每个字段表示八个罗盘点中的一个：北、东北、东、东南、南、西南、西和西北）。 例如 Field Name 选择为“PageName”，创建的新字段名： “PageName_N”、“PageName_NE”、“PageName_E”、“PageName_SE”、“PageName_S”、“PageName_SW”、“PageName_W”和“PageName_NW”。 4. Calculate Central Meridian and Parallel此工具基于要素范围的中心点计算中央经线和标准纬线。这个工具又几个注意事项： （1）直接对没有投影的要素类运行此工具将会产生错误。要素类必须进行投影。 （2）坐标系字段必须是文本字段，并且字段长度应大于或等于 600 个字符。 在新字段中添加了文本坐标信息，格式类似如下： 1&lt;span style=\"background-color:rgb(204,204,204)\"&gt;PROJCS[&amp;quot;World_Mercator&amp;quot;,GEOGCS[&amp;quot;GCS_WGS_1984&amp;quot;,DATUM[&amp;quot;D_WGS_1984&amp;quot;,SPHEROID[&amp;quot;WGS_1984&amp;quot;,6378137.0,298.257223563]],PRIMEM[&amp;quot;Greenwich&amp;quot;,0.0],UNIT[&amp;quot;Degree&amp;quot;,0.0174532925199433]],PROJECTION[&amp;quot;Mercator&amp;quot;],PARAMETER[&amp;quot;False_Easting&amp;quot;,0.0],PARAMETER[&amp;quot;False_Northing&amp;quot;,0.0],PARAMETER[&amp;quot;Central_Meridian&amp;quot;,-118.525225741025],PARAMETER[&amp;quot;Standard_Parallel_1&amp;quot;,46.76032322895251],UNIT[&amp;quot;Meter&amp;quot;,1.0],AUTHORITY[&amp;quot;ESRI&amp;quot;,54004]] 5. Calculate&nbsp;Grid Convergence Angle此工具根据要素类中各要素的中心点计算偏离正北方向的旋转角度（网格收敛角），并将所得值填充到指定字段中。这样就方便了，将地图旋转到正北方向。 此工具替代了&nbsp;Calculate Geodesic Angle（计算大地线角度）。输入数据需要指定有效的投影坐标系。 计算角度的算法提供了三种： GEOGRAPHIC — 以正北方向作为起点，顺时针旋转的角度。这是默认设置。 ARITHMETIC — 以正东方向作为起点，逆时针旋转的角度。 GRAPHIC — 以正北方向作为起点，逆时针旋转的角度。 了解网格收敛角，放图一张： 6. Calculate UTM Zone根据中心点计算每个要素的 UTM 带，并在指定字段中存储该空间参考字符串。 （1）需要一个足够长（&gt; 600 个字符）的新的文本字段。 （2）为了得到最佳结果，输入要素的基准面应与数据框使用的基准面相同。 （3）该工具不执行任何地理变换。 在新字段中的复制内容，类似如下： 1&lt;span style=\"background-color:rgb(204,204,204)\"&gt;PROJCS[&amp;quot;GCS Beijing 1954 UTM Zone 51R (Calculated)&amp;quot;,GEOGCS[&amp;quot;GCS_Beijing_1954&amp;quot;,DATUM[&amp;quot;D_Beijing_1954&amp;quot;,SPHEROID[&amp;quot;Krasovsky_1940&amp;quot;,6378245.0,298.3]],PRIMEM[&amp;quot;Greenwich&amp;quot;,0.0],UNIT[&amp;quot;Degree&amp;quot;,0.0174532925199433]],PROJECTION[&amp;quot;Transverse_Mercator&amp;quot;],PARAMETER[&amp;quot;False_Easting&amp;quot;,500000.0],PARAMETER[&amp;quot;False_Northing&amp;quot;,0.0],PARAMETER[&amp;quot;Central_Meridian&amp;quot;,123.0],PARAMETER[&amp;quot;Scale_Factor&amp;quot;,0.9996],PARAMETER[&amp;quot;Latitude_Of_Origin&amp;quot;,0.0],UNIT[&amp;quot;Meter&amp;quot;,1.0]] 关于数据驱动制图就说这么多了，主要是整理了帮助中的关键点，配以了实例截图做说明，帮助理解。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Mapping","slug":"Mapping","permalink":"http://www.kikitamap.com/tags/Mapping/"}]},{"title":"sketchup 与 ArcGIS 10 的交互","slug":"sketchupVSArcGIS10","date":"2013-06-06T03:29:15.000Z","updated":"2016-03-16T10:21:46.000Z","comments":true,"path":"2013/06/06/sketchupVSArcGIS10/","link":"","permalink":"http://www.kikitamap.com/2013/06/06/sketchupVSArcGIS10/","excerpt":"","text":"许多用户在 ArcGIS 9.2 时代习惯于使用 Sketchup 插件，但是，9.2版本已经结束了他的使命，进入了退休列表，已往的交互方法不再推荐。 在 ArcGIS 10 之后不再使用这个插件，而且给了其他的思路。 如下是官方说明中的原文： What is the recommended workflow between SketchUp and ArcGIS? The ArcGIS SketchUp plug-in is no longer supported at ArcGIS 10. The recommended workflow is now as follows: Digitize in your polygon. Extrude it by an attribute in 3D. Convert it to a multipatch using Layer 3D to Feature Class. Export it to COLLADA using MPatch to COLLADA. Import/Edit in SketchUp (e.g., textures, pitched roof, etc.). Then use the edit environment to replace the mpatch feature with the new SKP model. 链接：http://www.esri.com/software/arcgis/extensions/3danalyst/technical-information/common-questions 翻译整理下，也就是说，先在ArcGIS Desktop（ArcScene 或 ArcGlobe） 环境中，将2D数据经过拉伸。 拉伸在图层属性中进行设置，可以根据固定值拉伸，也可以根据某一属性字段进行拉伸。 主要在于拉伸表达式的写法。 使用工具 Layer 3D to Feature Class 转出，转到 GBD 中，以 Multipatch 的形式存储。 结果从外观看起来是没有区别的，但是数据由内存中的图层，转为了数据库中的数据。 为了与Sketchup交互，将其转为 COLLADA 格式，一种开放式的3D标准数据。点这里了解COLLADA，点这里是官网。 然后将这些数据，在Sketchup中导入，进行后面的编辑。Sketchup中的操作和建模方法请参阅它的帮助文档。 将来做好的模型，ArcGIS 仍然可以再用，使用 导入工具即可。 以上就是一个大致的流程。 如果还是习惯于老产品的用户，也仍然可以参阅已往老版本的资料，但是提醒 9.2 版本已经不支持在 Windows 7上安装了，意味着Windows也要降级。 并且使用9.2及之前的版本，在 Esri 是得不到技术支持的。强烈建议迁移到新版本。 ArcGIS for SketchUp 6 (beta) 安装指南： http://download.csdn.net/detail/kikitamoon/5529723 工作流程： http://download.csdn.net/detail/kikitamoon/5529733 官方说明： http://sketchup.google.de/intl/en/download/plugins.html","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"查看端口号占用情况","slug":"ViewPortNo","date":"2013-06-03T09:35:07.000Z","updated":"2016-03-16T10:28:30.000Z","comments":true,"path":"2013/06/03/ViewPortNo/","link":"","permalink":"http://www.kikitamap.com/2013/06/03/ViewPortNo/","excerpt":"","text":"1.查看端口占用情况使用命令 netstat -ano ，检查所有在使用的端口。 如果查询指定端口，使用：netstat -aon|findstr &quot;Port No.&quot;，如下： 例如，查看49506端口号对应的进程，进程号976： 2. 查看PID 对应的程序查看具体哪个程序在占用某个端口，使用命令： netstat -aon|findstr &quot;Port No.&quot; 接着上面的例子，976对应的程序。 好了，找到他了，可以换端口号，可以杀掉当前进程，随你…… PS： 在输命令时，可能会遇到报错：“nestat -ano不是内部或外部命令……blabla……” 需要查看下&nbsp;C:\\Windows\\System32 下是否有 netstat.exe。 如果有，再检查下环境变量中Path项中有没有这项：C:\\Windows\\System32 ,没有的话就添加上。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"License","slug":"License","permalink":"http://www.kikitamap.com/tags/License/"}]},{"title":"ArcGIS Desktop 各版本产品补丁荟萃","slug":"AllPackages","date":"2013-05-29T07:52:07.000Z","updated":"2016-03-18T01:10:06.000Z","comments":true,"path":"2013/05/29/AllPackages/","link":"","permalink":"http://www.kikitamap.com/2013/05/29/AllPackages/","excerpt":"","text":"ArcGIS 的补丁都是可以覆盖安装的，并且可以直接打最新补丁，最新补丁中修复了同版本前面所有补丁修复的问题。 ArcGIS 10.1最新补丁： SP1 中文http://downloads.esri.com/support/downloads/other_/Install101_SP1_Chinese_OSC.htm 英文http://support.esri.com/en/downloads/patches-servicepacks/view/productid/189/metaid/1913 ArcGIS 10.0最新补丁： SP5 英文 http://support.esri.com/zh-cn/downloads/patches-servicepacks/view/productid/160/metaid/1876 ArcGIS 9.3.1最新补丁： SP2 http://support.esri.com/en/downloads/patches-servicepacks/view/productid/43/metaid/1620 ArcGIS 9.3最新补丁： SP1 http://resources.arcgis.com/zh-cn/content/patches-and-service-packs?fa=viewPatch&amp;PID=43&amp;MetaID=1457 ArcGIS 9.2最新补丁：SP6http://resources.arcgis.com/zh-cn/content/patches-and-service-packs?fa=viewPatch&amp;PID=43&amp;MetaID=1409","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"}]},{"title":"如何从 ArcView 3.3 版本的工程迁移到 ArcGIS Desktop 10 ？","slug":"TransferArcView33to10","date":"2013-05-24T05:38:10.000Z","updated":"2016-03-18T01:03:26.000Z","comments":true,"path":"2013/05/24/TransferArcView33to10/","link":"","permalink":"http://www.kikitamap.com/2013/05/24/TransferArcView33to10/","excerpt":"","text":"ArcGIS大家族中还有很多老古董，例如 ArcView 3.3，如果需要直接跳跃式的迁移到 ArcGIS Desktop 10，需要怎样做呢？ 1 找到这个功能：菜单栏 –&gt; Customize–&gt; Customize Mode， Commands选项卡，搜索【ArcView】 2 将菜单 Import from ArcView Project… 拖拽到菜单栏任意位置。 3 点击这个新菜单 ， Import from ArcView Project… ，弹出窗口，按照提示选择 apr 工程文件即可。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"}]},{"title":"要素外接矩形的四个角点坐标、长度、宽度、面积如何计算到要素属性表中?","slug":"FeatureEnvelopPython","date":"2013-05-21T03:48:38.000Z","updated":"2016-03-18T01:09:34.000Z","comments":true,"path":"2013/05/21/FeatureEnvelopPython/","link":"","permalink":"http://www.kikitamap.com/2013/05/21/FeatureEnvelopPython/","excerpt":"","text":"title: 要素外接矩形的四个角点坐标、长度、宽度、面积如何计算到要素属性表中？ 使用工具 Calculate Field。 9.3以上版本可按下图的方法分别求出envelope的x、y坐标的最大、最小值，由此可得出你要的那些值，需注意的的是求长度、面积等要在投影坐标系下进行。 X的最大值：!shape.extent.XMax! X的最小值：!shape.extent.XMin! Y的最大值：!shape.extent.YMax! Y的最大值：!shape.extent.YMin! 面积：!shape.area! 周长：!shape.length!","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Python","slug":"Python","permalink":"http://www.kikitamap.com/tags/Python/"},{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"CityEngine 中的 Annotation","slug":"CityEgnineAnnotation","date":"2013-05-13T08:29:40.000Z","updated":"2016-03-18T07:40:30.000Z","comments":true,"path":"2013/05/13/CityEgnineAnnotation/","link":"","permalink":"http://www.kikitamap.com/2013/05/13/CityEgnineAnnotation/","excerpt":"","text":"CityEngine中的 Annotation 可以给规则和属性添加额外的信息，Annotation不会影响到规则本身的语法以及模型的产生，它主要影响的是用户界面的显示，例如：在Inspector 上，如何显示属性和规则。 @StartRule: 在起始规则选择器中标记起始规则，通常会变成粗体。 12@StartRuleStart--&gt;NIL @Hidden: 标记一个属性或者规则隐藏，在 Inspector 中或者起始规则选择器中不显示。 12@Hiddenattr hide_me = 0 @Group(“level_1-group”, …, “level_n-group”): 设置属性的在 Inspector 中的分组显示。 12@Group(\"First\", \"Second\")attr grouped = 0 @Range(min, max): 设置某个属性的最大、最小值，控制属性的范围。 12@Range(5, 50)attr height = 20 @Range(item_1 = value, …, item_n = value): 设置某个属性的指定选择项，值可以是数值型或者文本型。 1234@Range(Low=0, Mid=1, High=2)attr lod = 0@Range(Red=\"#ff0000\", Green=\"#00ff00\", Blue=\"#0000ff\")attr color = \"#000000\" @Color: 在 Inspector 中显示某个色彩属性使用色彩选择器。 12@Colorattr userColor = \"#000000\" @File: 将某个属性标记为一个文件名，在 Inspector 中以文件选择器显示。 12@Fileattr asset = \"myfile.obj\" @File(“ext_1”, … , “ext_n”): 将某个属性标记为一个文件名，在 Inspector 中以文件选择器显示，规定指定的扩展名(“ext_1”, … , “ext_n”)。 12@File(\"tif\", \"tiff\")attr texture = \"tex0.tiff\" @Directory: 将一个属性标记为路径名，在 inspector 中，会显示路径选择器。 12@Directoryattr assets = \"/assets/lod\" + lod @Location(x, y): 为可视化 CGA 编辑器设置某个属性或者规则 2D 位置。 12@Location(0, 0)Init--&gt;NIL @Order(order): 设置在 Inspector 中属性的显示顺序。 123456@Order(1)attr i_m_1st = 0@Order(2)attr i_m_2nd = 0@Order(3)attr i_m_3rd = 0 @Description(“description”): 为某个属性或者规则添加描述，这些描述会在 Inspector 中产生工具提示，或者在起始规则选择器中，或者样式管理器中作为描述显示。 12@Description(\"The building width\")attr width = 40","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"CityEngine","slug":"CityEngine","permalink":"http://www.kikitamap.com/tags/CityEngine/"}]},{"title":"CityEngine与ArcGIS对栅格数据的要求情况","slug":"CityEngineRasterReqirement","date":"2013-05-13T02:47:28.000Z","updated":"2016-03-18T07:48:08.000Z","comments":true,"path":"2013/05/13/CityEngineRasterReqirement/","link":"","permalink":"http://www.kikitamap.com/2013/05/13/CityEngineRasterReqirement/","excerpt":"","text":"在论坛上看到一篇很好的讲述如题主题的文章，很有价值，可以为CityEngine选择合适的栅格数据或者纹理，提供一些帮助，原文如下： textures / raster files : concepts in CityEngine / ArcGIS Hi, Quite a few new customers and people evaluating CityEngine who are working in the field of GIS ask about how CityEngine handles ‘raster files’ or ‘basemaps’ and what the best practices are concerning file resolutions. Since CityEngine works ( from a technology-POV ) very similar as many other pure 3d applications (CityEngine is a 3d Modelling Application), I wanted to point out a few differences between CityEngine and ArcGIS : ArcGIS-users call bitmap files ‘raster files’ due to their grid-based nature. People usually working with 3d applications call them ‘textures’. It’s the same thing. ArcGIS has technologies embedded which ‘dynamically’ load only the part of a dataset which is currently visible on screen. Thus, with this technology HUGE raster datasets (&gt; 1GB) can easily be displayed.CityEngine does NOT have such a streaming service, thus raster files / textures should be prepared with some basic knowledge how they shall be used in a CityEngine project. Important things to know : 1] Arc GIS’ basemaps can not directly be loaded in CityEngine as a layer. The user must export the specific ‘area of interest’ (extent) as a texture to be used within CityEngine.2] To be able to work with textures, all the textures must reside within the opened project, usually in the ‘assets’ folder general textures, respectively the ‘maps’ folder for map-/basemap - textures (or a subdirectory).3] CityEngine is a 3d application which uses a technology called ‘OpenGL’ to display the 3d models (and the scene). Displaying 3d graphics this way uses the computer’s graphics card . For this, all textures are fully loaded in thatgraphics card’s memory. [Please note that the computer has ‘main memory’, which is usually called RAM. A graphics card has it’s own RAM, often called ‘Video RAM’. ]4] Since the amount of memory on graphics cards is usually quite small (~ 256 MegaBytes - 1.5 GigaBytes), one can imagine that the resources should be handled carefully !5] Please note that when importing raster files from ArcGIS (e.g. GeoTIF), the file’s projection MUST MATCH the CityEngine scene’s Scene Coordinate System. CityEngine can not (yet) reproject raster files when importing into the scene (as opposed to Shapes and Graph Segments !). Since the amount of memory used per texture is directly linked to it’s resolution (e.g. 500x500 pixels) plus the bit-depth of the file, we recommend to work with as efficient files as possible : use graphics card drivers which are UP TO DATE ! use 8 bit textures whenever possible (except the terrain’s ‘heightmap’ which usually just is 32 bit) use texture resolutions &lt;= 1024 x 1024 px (does not need a square ratio) terrains may be higher in resolution, I’d say &lt;= 2048 x 2048 px. higher resolution textures may be downsampled automatically by CityEngine ( for viewport display only ! ). if a texture has too large a resolution (e.g. 13’000 x 13’000 px), it will not be displayed at all. 原文链接： http://forums.arcgis.com/threads/54072-textures-raster-files-concepts-in-CityEngine-ArcGIS","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"CityEngine","slug":"CityEngine","permalink":"http://www.kikitamap.com/tags/CityEngine/"}]},{"title":"ArcGIS Desktop 10.1 的系统自带的 prj 文件的去哪了?","slug":"WhereArethePRJs","date":"2013-04-22T01:33:33.000Z","updated":"2016-03-21T07:24:53.668Z","comments":true,"path":"2013/04/22/WhereArethePRJs/","link":"","permalink":"http://www.kikitamap.com/2013/04/22/WhereArethePRJs/","excerpt":"","text":"在过去的版本，例如 9.31，10.0 我们在安装目录中可以找到存放系统 prj 的地址，例如 C:\\Program Files (x86)\\ArcGIS\\Desktop10.0\\Coordinate Systems\\Projected Coordinate Systems。但是10.0之后，我们发现，这个文件夹消失了，那要得到其中的Prj文件怎么做呢？ 现在的 Coordinate Systems 文件变成的虚拟的结构，prj 文件都存储在 projection engine library (pe.dll)。从安装包中去掉了4000+的 prj 文件，会提升安装的性能。 如果是自定义的 prj 文件， 可以将文件复制到 ArcMap Favorites 文件夹。 如果需要得到 prj 文件，可以将其添加到收藏，或者另存为副本。 收藏夹的位置： Win7 ：c:\\Users\\[login]\\[Roaming | Local | etc]\\AppData\\ESRI\\Desktop10.1\\ArcMap\\Coordinate Systems WinXP： C:\\Documents and Settings\\[login]\\Application Data\\ESRI\\Desktop10.1\\ArcMap\\Coordinate Systems 文件夹中支持子文件夹进行分类。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Coordinate System","slug":"Coordinate-System","permalink":"http://www.kikitamap.com/tags/Coordinate-System/"}]},{"title":"File geodatabase size and name limits","slug":"FileGDBlimits","date":"2013-04-18T10:17:48.000Z","updated":"2016-03-18T09:40:18.000Z","comments":true,"path":"2013/04/18/FileGDBlimits/","link":"","permalink":"http://www.kikitamap.com/2013/04/18/FileGDBlimits/","excerpt":"","text":"很多用户会关心FileGDB的参数，扒出来方便参考： File geodatabase size and name limits are as follows: File geodatabase size: No limit Table or feature class size： 1 TB (default), 4 GB or 256 TB with keyword Number of feature classes and tables: 2,147,483,647 Number of fields in a feature class or table: 65,534 Number of rows in a feature class or table: 2,147,483,647 Geodatabase name length: Number of characters the operating system allows in a folder name Feature class or table name length: 160 characters Field name length: 64 characters Text field width: 2,147,483,647 链接：http://resources.arcgis.com/en/help/main/10.1/index.html#//018s00000002000000","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"【CityEngine】如何在街道两侧放置路灯、行树等","slug":"CityEnginePlantTree","date":"2013-04-17T02:23:08.000Z","updated":"2016-03-18T08:10:42.000Z","comments":true,"path":"2013/04/17/CityEnginePlantTree/","link":"","permalink":"http://www.kikitamap.com/2013/04/17/CityEnginePlantTree/","excerpt":"","text":"使用CGA代码将对象（路灯、树木等）放置到路边。这里用到的主要方法就是Split 函数去做分割。 思路是，现将shape按照较短的轴向进行最初的分割剥离，得到路的两边sidewalk，然后将这些分割出来的形状进行再次分割，也就是沿着长的轴的方向分割成多个重复的小的形状，最后，用实际的模型（如路灯或树等）替换这些小块。 下面是示例代码，参考下： 12345678910111213141516171819202122232425262728293031[plain] view plain copySidewalk --&gt; SidewalkGeometry. SidewalkObjects # 复制shape! # 思路：沿着道路的方向纵向切割道路，得到两边的人行道。 # 在剩下的shape“dot”中，插入树木、路灯等静态模型对象。 attr placementWidth = 0.05 attr streetDist = 0.2 attr objectDist = 5 attr objectSize = 0.1 attr objectHeigt = 2 SidewalkObjects --&gt; # 沿道路纵向分割两边的人行道。 split(v,unitSpace,0) &#123; streetDist : NIL | placementWidth : PlacementStrip | ~1 : NIL &#125; PlacementStrip --&gt; # 沿着人行道分割横向切割，切成小段。 split(u,unitSpace,0) &#123;objectDist: NIL | placementWidth : PlacementPoint &#125;* PlacementPoint --&gt; alignScopeToGeometry(yUp, 0) # align the shape to the current point shape, thus the street direction! # r(0,90,0) # 旋转90度，视情况使用，例如路灯模型。 s(objectSize*2, objectHeigt, objectSize) i(\"builtin:cube\") center(xz) 效果示例：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"},{"name":"CityEngine","slug":"CityEngine","permalink":"http://www.kikitamap.com/tags/CityEngine/"}]},{"title":"单独打开CityEngine本地帮助","slug":"DeployCityEngineLocalHelp","date":"2013-03-22T03:21:19.000Z","updated":"2016-03-18T08:11:56.000Z","comments":true,"path":"2013/03/22/DeployCityEngineLocalHelp/","link":"","permalink":"http://www.kikitamap.com/2013/03/22/DeployCityEngineLocalHelp/","excerpt":"","text":"CityEngine软件的自带帮助中有大量的信息可供查找学习，但是自带的 Help Content，正常是在启动CE后，再去打开才可以，这与 eclips 的帮助是一个道理。 有时仅仅为了看看帮助，而启动着庞大的CE，有点喧宾夺主喽。在老王的帮助指导下，找到了单独运行CE帮助的方法，磨刀不误砍柴工~ 在这里总结下。 一、设置系统环境变量 在“系统变量中，设置3项属性，JAVA_HOME, PATH, CLASSPATH （大小写无所谓)）, 若已存在则点击“编辑”，不存在则点击“新建”； JAVA_HOME：例如：C:\\Program Files\\Esri\\CityEngine（CE的安装目录即可，下面有 bin 和 jre 文件夹） PATH：%JAVA_HOME%/bin;%JAVA_HOME%/jre/bin %JAVA_HOME%/lib/dt.jar;%JAVA_HOME%/lib/tools.jar （要加.表示当前路径） PS：%JAVA_HOME% 就是引用前面指定的JAVA_HOME； 关于配置环境变量的详情，可参阅：http://blog.csdn.net/huanghm88/article/details/3965218 2.键入命令 java，出现画面，说明环境变量配置成功； 二、单独运行帮助制作个启动脚本–bat文件。 内容如下： 12345C:\\Program Files\\Esri\\CityEnginecd %ehome%C:java -classpath plugins\\org.eclipse.help.base_3.5.2.v201009090800.jar org.eclipse.help.standalone.Help -command displayHelppause PS：蓝色部分仍然是 CE 的安装目录，下面包含 jre，bin 等目录。 关于单独使用eclipse帮助的详情：http://hi.baidu.com/caichaowei/item/4ab4ccb8e8304cd385dd7917 三、更改CE程序文件名上面的脚本运行之后，也许会报错，找不到 eclipse.exe。 可以将CityEngine.exe，做个副本，重命名之，变成一位伪eclipse.exe。 然后运行上一步中的 bat 脚本，单独的CE帮助就跳出来了~ CE进入esri怀抱已久，相信风格会越来越接近 ArcGIS 核心产品，现有的WebHelp链接如下： http://cehelp.esri.com/help/index.jsp?topic=/com.procedural.cityengine.help/html/toc.html 郑重鸣谢：~ ~ 菩提老王 ~ ~","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"CityEngine","slug":"CityEngine","permalink":"http://www.kikitamap.com/tags/CityEngine/"}]},{"title":"在CityEngine中的圆柱体建模","slug":"CurveinCityEngine","date":"2013-03-12T09:54:48.000Z","updated":"2016-03-18T08:41:36.000Z","comments":true,"path":"2013/03/12/CurveinCityEngine/","link":"","permalink":"http://www.kikitamap.com/2013/03/12/CurveinCityEngine/","excerpt":"","text":"CityEngine中不支持弧段的存储，各种面都是折线面，也就是ArcGIS中的Polygon。 当遇到圆柱体的建筑物或实体时，如何为其建模呢？ 考虑到ArcGIS与CityEngine的数据是可以互操作的，那就在ArcGIS中来构建圆形或者弧段，然后将之处理成近似弧段的多边形，然后导入CityEngine来作为模型的底面基础。按照这个思路，来动手做一下。 1. 准备带弧的数据在ArcGIS Desktop 中准备数据，创建 File GDB，用于存储弧段。可以从空白开始，也可以在现有数据中编辑。 创建圆、椭圆、贝塞尔曲线、圆弧构成的面等等： 以上图形都处于节点编辑状态，从节点数目我们可以发现，都是以复杂对象存储的。然而这些是CE不能读取的，那么下一步就是转折线了。 2. 弧转折线使用 ArcToolbox中的工具 Densify 工具来对弧段加密，从而将高级的函数要素对象转为简单的点线面几何。 根据需要设置间距或者偏移等参数，从而控制加密点的生成位置，这里的需要主要是指将来模型的详细程度。 如果需要比较逼真，距离可以相对小一些，这样的节点会更密集些，但是在CE中建模时可能会更耗时，更加占用资源； 如果相对可以粗略些，距离可以设置大些，这样的节点会稀疏些，建立模型会更加快速，但是边界相对不会很平滑。 3.导入CE，进一步加工经过简单的拉拔，可以做出简单的类似弧段建筑物。 到这里，这些类弧段的楼房骨架就有了。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"},{"name":"CityEngine","slug":"CityEngine","permalink":"http://www.kikitamap.com/tags/CityEngine/"}]},{"title":"ArcGIS支持3D视图吗？","slug":"ArcGIS3DView","date":"2013-03-04T01:26:11.000Z","updated":"2016-03-18T08:42:42.000Z","comments":true,"path":"2013/03/04/ArcGIS3DView/","link":"","permalink":"http://www.kikitamap.com/2013/03/04/ArcGIS3DView/","excerpt":"","text":"ArcGIS Desktop 中的 ArcScene 组件支持 3D 视图。 在ArcScene中的 View 菜单下，有 View Setting 菜单。 默认是“透视图（perspective）”，也就是我们打开ArcScene的缺省设置显示方法： 我们可以切换到“立体视图（stereo）”，方法可以选择例如常用的红蓝眼镜类型，如下图所示： 另外还有一种视图，称为“正射视图（orthographic）”，也就2D显示效果。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"3D数据互操作之认识Collada","slug":"OverviewCollada","date":"2013-03-04T01:22:20.000Z","updated":"2016-03-18T08:45:40.000Z","comments":true,"path":"2013/03/04/OverviewCollada/","link":"","permalink":"http://www.kikitamap.com/2013/03/04/OverviewCollada/","excerpt":"","text":"Collada的名称来自于COLLAborative Design Activity（协同设计活动），是用于存储 3D 模型的开放式标准 XML 格式，最早是由 Sony Computer Entertainment（SCEA）发起。 以下介绍来自网络： COLLADA™ 是面向交互式 3D 应用程序的基于 XML 的数字资产交换方案，使 3D 创作应用程序可以自由地交换数字资产而不损失信息 - 使多种DCC和3D处理软件包可以组合成强大的工具链管道。独特的交互模式提供了广泛全面的视觉编译。COLLADA FX支持使用 OpenGL ES 着色语言创作和封装着色器，以使一流的 3D 创作工具可以有效协作创建 OpenGL / OpenGL ES 应用程序和资产。 COLLADA是一个开放的标准，最初用于3D软件数据交换，由SCEA发起，现在则被许多著名厂家支持如Autodesk、XSI等。COLLADA不仅仅可以用于建模工具之间交换数据之用，也可以作为场景描述语言用于小规模的实时渲染。因为COLLADA DOM拥有丰富的内容用于表现场景中的各种元素，从多边形几何体到摄像机无所不包。我们可以通过COLLADA DOM库来进行场景文件的读取与处理操作。COLLADA DOM的编程方式类似COM。 总之，我们可以将Collada理解成一个开放的3D数据资源的交换方案。COLLADA 文件的扩展名是 .dae，此类文件中还可能引用一些附加的图像文件，这些文件被用作 3D 对象上覆盖的纹理。了解更多资源，点击：http://collada.org/mediawiki/index.php/COLLADA ArGIS Desktop 中如何转化呢？ 从ArcGIS 10.0之后，ArcToolbox中就增加了 Multipath to Collada，可以将ArcGIS的多面体矢量格式转换为3D的解决方案。从而也便利了与 SkecthUp，3DS Max 等第三方软件的交互。 将多面体要素导出到 COLLADA 会创建若干文件 - 一个包含 3D 对象的 XML 表示的 .dae 文件以及一个或多个包含纹理的图像文件（例如 .jpg 或 .png 文件）。 每一个multipatch会对应的生成一个Collada文件，他们之间的关联是通过指定字段维护的，如果没有特殊指定，就使用ObjectID。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"},{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"有关shapefile存储时间字段的问题","slug":"shapefileDataField","date":"2013-03-04T01:20:05.000Z","updated":"2016-03-18T08:50:36.000Z","comments":true,"path":"2013/03/04/shapefileDataField/","link":"","permalink":"http://www.kikitamap.com/2013/03/04/shapefileDataField/","excerpt":"","text":"很多ArcGIS的用户会很疑惑，为什么excel或者其他数据库中的时间数据数据，例如15:40:30等这样的数据，转成shapefile数据后，这个日期字段中的值会变成12:00:00 ？ 我们知道shapefile是基于dbase来存储的，通过dbf文件来存储属性字段，dbf支持的日期时间字段，实际上不是真正意义上的DateTime型，而是只能存储8位的日期型字段，也就是：YYYYMMDD。 所以，强烈建议用户，如果需要使用日期时间型字段时，请选用GDB数据类型。如果出于特定原因一定需要使用shapefile的。可以考虑新加字段，单独来存储时间，两种常用的方案： （1）将时间换算成秒，由某个数值型字段来存储。 （2）分别使用三个字段来存储，时分秒数值。 顺便提一嘴。GDB存储时间日期的格式为：yyyy-mm-dd hh:mm:ss AM or PM。至于ArcMap中日期的显示的样式，是由windows系统来控制的。例如：M/d/yy, MM/dd/yy, yy/MM/dd等样式。 关于shape文件的详细描述，请查看如下两个连接中的任何一个： http://www.digitalpreservation.gov/formats/fdd/fdd000280.shtml http://www.gdal.org/ogr/drv_shapefile.html 从中都会获得有用的数据描述。 在资源库中也上传了esri有关shapefile的描述文档。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"CityEngine 2012_1 与 ArcGIS 10_0 一同安装的注意事项","slug":"TipsCityEngine20121ArcGIS100","date":"2013-03-04T01:19:27.000Z","updated":"2016-03-18T08:52:08.000Z","comments":true,"path":"2013/03/04/TipsCityEngine20121ArcGIS100/","link":"","permalink":"http://www.kikitamap.com/2013/03/04/TipsCityEngine20121ArcGIS100/","excerpt":"","text":"CityEngine 2012.1 与 ArcGIS 10.1 是同期发布的产品，ArcGIS Lisence Manager 10.1 是可以统一管理这两个产品的许可。比起CityEngine 2011的版本，许可方面的确便利了许多。 但是如果想使用 ArcGIS 10.0怎么办呢？ Esri 为了解决这个问题，提供了一个Patch，Esri CityEngine 2012.1 Software Authorization Patch，下载地址： http://support.esri.com/en/downloads/patches-servicepacks/view/productid/186/metaid/1929 如果您ArcGIS Desktop当前处于中文版界面，打开 ArcGIS Administrator 配置许可的时候，没准会遇到这个问题：“试图执行不支持的程序”。 将ArcGIS Desktop语言切回英文即可解决。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"}]},{"title":"如何检测显卡类型和OpenGL版本?","slug":"checkOpenGLVersion","date":"2013-03-04T01:17:58.000Z","updated":"2016-03-18T08:53:40.000Z","comments":true,"path":"2013/03/04/checkOpenGLVersion/","link":"","permalink":"http://www.kikitamap.com/2013/03/04/checkOpenGLVersion/","excerpt":"","text":"摘要OpenGL是一个行业标准的3D图像API。运行 CityEngine 需要 OpenGL 2.x 或更高版本。OpenGL 驱动通常与显卡驱动和支持的软件（例如：DirectX）一同安装。 过程1.检测显卡类型（Windows）：1） 打开 “运行” 窗口。 2）输入&nbsp;dxdiag&nbsp;进入 DirectX诊断工具，即列出显卡信息。 2.检测 OpenGL版本（Windows，Mac，移动设备）需要安装个第三方小软件。。名字叫：OpenGL Extension Viewer. 下载并安装 OpenGL Extension Viewer Mac、移动设备：在 OpenGL Extension Viewer 网页中，对应的选择从 Mac App Store、iTunes Store、Android Market下载即可。 OpenGL Extension Viewer是个免费的应用程序，由 Realtech VR 开发。此工具可以显示当前安装的 OpenGL 版本，并且可以检测和升级显卡驱动。 本文内容来源于 ArcGIS Resource Center 技术文件，编号：39476","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"}]},{"title":"将ArcMap中的符号样式导出的供ArcPad使用","slug":"ExportStyletoArcpad","date":"2013-01-15T08:40:35.000Z","updated":"2016-03-18T08:55:16.000Z","comments":true,"path":"2013/01/15/ExportStyletoArcpad/","link":"","permalink":"http://www.kikitamap.com/2013/01/15/ExportStyletoArcpad/","excerpt":"","text":"在安装有ArcGIS Desktop的机器上，安装ArcPad。这里采用了各个产品的最新版本，分别是ArcGIS Desktop 10.1 和 ArcPad 10.0.4。 激活ArcMap中的对应扩展： 打开ArcPad 工具条，将当前地图的样式导出。 默认是保存在安装目录下的Style文件夹。将将要生成的aps最好放置到这个位置， \\Users\\Public\\Documents\\ArcPad\\Styles 。 为什么么呢？后面会说到~ 无论保存在哪，最后会提示保存成功。 使用ArcPad样式文件。 ArcPad读取并使用这些样式，对路径是有要求的，只要下述路径才能直接使用。因此其他路径是需要重新拷贝的。 PC Windows：\\Users\\Public\\Documents\\ArcPad\\Styles 移动设备 WM： \\Program Files\\ArcPad\\Styles 最后，在ArcPad的图层属性中就可以看到ArcMap导出的自定义的Style文件。 哦啦，就到这里~","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"ArcPad","slug":"ArcPad","permalink":"http://www.kikitamap.com/tags/ArcPad/"}]},{"title":"City Engine 的学习资源","slug":"CityEngineResources","date":"2012-12-20T05:31:59.000Z","updated":"2016-03-18T09:13:36.000Z","comments":true,"path":"2012/12/20/CityEngineResources/","link":"","permalink":"http://www.kikitamap.com/2012/12/20/CityEngineResources/","excerpt":"","text":"原文链接：http://forums.arcgis.com/threads/52242-Learning-CityEngine-Tutorials-and-other-Training Dear all, We’re getting a lot of inquiries concerning training materials, tutorials and other resources, to learn the CityEngine most efficiently. Here’s the list of resources I usually recommend : I highly recommend to browse through all the mentioned resources since they contain all the basic information to get started on a professional level CityEngine project. 1] Resource Center : Videoshttp://video.arcgis.com/series/62/cityengine/date/desc Recommended are all videos which were recorded on version 2012.1, as indicated in each description. [ Some of the videos are older, though we decided to keep them on the web. ]These give a good overview over how the CityEngine works in it’s basics and what the common workflows are. I recommend to go through all of them and try to follow the concepts, even though the user interface may have changed slightly between the versions. Find the current list of Tutorial videos and 2012 Features here:http://forums.arcgis.com/threads/648...URCES-FAQ-HELP 2] Quick Start GuideGo to Help &gt; Help Contents &gt; Quick Start Guide 3] ManualThere’s a detailed manual inside the CityEngine. Go to Help &gt; Help Contents 4] Example CitiesHave a look at the downloadable Example Cities. Download them via Help &gt; Download Tutorials and ExamplesOr via the Resource Center:http://resources.arcgis.com/en/commu...-ce-version:10 5] Written TutorialsThe written Tutorials (PDFs) are located within the downloadable tutorial project’s ‘scenes’ folder. 6] CityEngine Workflowshttp://resources.arcgis.com/en/commu...ype:0000010000 7] Dedicated Forumshttp://forums.arcgis.com/forums/45-Solutions These 5 dedicated forums already have a great traction and are a valuable resource for basic and advanced questions. I’m here a lot and answer most questions personally.","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"CityEngine","slug":"CityEngine","permalink":"http://www.kikitamap.com/tags/CityEngine/"}]},{"title":"E7210005 操作系统策略不允许该操作 解决","slug":"E7210005FingerPrint","date":"2012-12-20T02:04:15.000Z","updated":"2016-03-18T09:15:00.000Z","comments":true,"path":"2012/12/20/E7210005FingerPrint/","link":"","permalink":"http://www.kikitamap.com/2012/12/20/E7210005FingerPrint/","excerpt":"","text":"本文用于解决windows7系统不能使用内部administrator用户注册指纹的问题，已测试通过，绝对原创！ 电脑型号：Thinkpad X220系统：windows7 64位 1、计算机上点右键，选择 管理–本地用户和组–用户，在Administrator用户上点右键，选择重命名，重命名为Administrator1 2、新建一个Administrator账号，密码与Administrator1一样，注销后用Administrator登录，录入指纹，导出指纹配置 3、注销后用Administrator1用户登录，删除Administrator用户，重命名Administrator1为Administrator 4、注销后用Administrator用户登录，导入指纹文件 方法二： 上述方法虽然有一个问题，就是用指纹开机后，在进入系统进还要再刷一次指纹，经过测试，找到了一个可以彻底解决这个问题的方法： 一、本人先装了XP 32位，安装后在 管理–本地用户和组–用户 中启用administrator用户，将装系统时创建的用户禁用，用administrator注册指纹，然后导出指纹数据 二、安装win7 64位，安装后在 管理–本地用户和组–用户 中启用administrator用户，将装系统时创建的用户禁用，重启系统，用administrator登录，导入第一步的指纹数据，即可完美破解win7注册指纹的问题","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"}]},{"title":"ArcGIS Terrain Dataset","slug":"ArcGIS-Terrain-Dataset","date":"2012-12-13T08:23:24.000Z","updated":"2016-03-18T09:31:04.000Z","comments":true,"path":"2012/12/13/ArcGIS-Terrain-Dataset/","link":"","permalink":"http://www.kikitamap.com/2012/12/13/ArcGIS-Terrain-Dataset/","excerpt":"","text":"1 了解 Terrain DatasetTerrain Dataset 是多分辨率的基于 TIN 的表面数据结构，支持 ArcSDE、个人以及文件地理数据库，存储在ArcGIS&nbsp; Geodatabase 的 Feature Dataset 中，Feature Dataset 中需要包含构建 TIN 的要素类。 Terrain Dataset&nbsp;引用原始要素类，对数据重新组织重建索引，动态生成 TIN 表面，并没有实际创建栅格或 TIN 数据。 在数据组织过程中，会创建金字塔，用于决定数据细节层次。&nbsp;terrain 数据集是多分辨率 TIN。它具有一系列 TIN，其中每一个 TIN 都在特定的地图比例尺范围内使用。 Terrain Dataset 可由不同类型的数据组成。支持的几何类型包括点、多点、线和多边形。每一种几何类型的数据都可以具有不同的表面要素类型（SFType），这与前面一篇博客中构建TIN时选择表面类型作用是相同的。 帮助中的下表很好的将常见数据类型的应用做了总结： 2 Terrain Dataset 的属性基本属性设置：1） 平均点间距（Approximate Point Spacing） 创建地形数据集时，需要指定输入测量值的平均点间距。平均点间距的作用是对点进行归类或分组，从而构造出虚拟分块系统。 平均点距的获得：查看元数据、向数据提供商或数据维护人员寻求帮助。实在无法获取，只能用量距工具估算了。 这个参数能够决定 Tile Size，查看Terrain数据集属性可以看到。 2） 高度源（Height Source） 向地形添加要素类时，需要指明该要素类是否具有 z 值；如果具有 z 值，则还需要指明这些值的来源。 3） 表面要素类型（SFType） 定义在对地形数据集表面进行定义时该要素类所发挥的作用。存在离散多点、断裂线以及若干种多边形类型。上面图表中有说明。 4）地形金字塔（Terrain Pyramid） 地形金字塔等级采用的依据是对精确度的要求随比例的减小而降低。金字塔等级在概念和用途上均类似于栅格金字塔，但二者的实现方法不同。 Terrain Pyramid 通过点抽稀实现。也就是下一级金字塔使用的点数少于上一级，但是采用的点都是原始的点值。 金字塔不使用任何重采样、平均化或派生的数据。 有两种金字塔类型：z 容差和窗口大小。 在窗口大小的选项中，可以设置二次抽稀。 高级属性设置 5）概貌地形（Overview Terrain） 概貌地形是地形数据集最粗略表示，专门用于小比例尺下的快速绘制。如下图： 6）定位点（Anchor Point） 定位点在地形数据集的所有金字塔等级中保持不变。这些点不会被过滤，也不会被细化掉。这将确保无论使用何种分辨率金字塔等级，定位点都会存在于地形表面中。对于显示和分析操作都是这样。支持定位点的目的是使用户始终能在地形中保留一个相对较小的重要测量值集合，如控制点、水准点和最佳水深。 7）组（Group） 组用于为线要素和多边形要素定义多种详细程度。将相同的组 ID 指定给每个多边形要素类，向地形告知它们属于同一主题（例如，研究区域边界）。 8）嵌入式要素类（Embedded feature classes） terrain 金字塔的大小约相当于参与 terrain 的要素类中所包含几何的大小，需要较大的存储空间。对于较大的点集合（通常由激光雷达或声纳表示），开销可能相当大，可以将较大的多点要素类嵌入 terrain 数据集中，以节省存储空间。构建 terrain 后，它将成为点的容器，而不再引用源要素类。可以将这些要素类删除，以恢复其存储空间。 性能的提示1） 最好将所有硬断线都放置在一个要素类中。 2） 定义 terrain 时，使用的要素类越少越好。 3） 不同数据库的数据量的选择： 个人地理数据库的容量最小，应限制为包含 2,000 万或更少点数的地形。 文件地理数据库可用于包含数十亿个点的地形。 ArcSDE 的容量最大，适合点集可能会增长到数十亿的地形。 4） 金字塔类型的选择： 有两种方式可供选择： Z Tolerance 和 Windows Size。区别和使用情况如下： Z Tolerance：对地表裸露激光雷达最有效。金字塔过滤器速度较慢，但在某些分析中，控制垂直精度很重要，要细化此类分析中使用的数据，Z 容差金字塔过滤器更适合一些。 Windows Size：对所有数据、第一回波激光雷达点最有效。窗口大小过滤器速度较快，适合于较常规的用途，它以水平采样密度为基础。Windows Size 金字塔过滤器是基于窗口大小以及用户指定的窗口统计数据来确定的。指定的窗口统计数据可以是最小点高度、最大点高度、平均点高度，或者是同时指定最小和最大点高度。 5） 有关构建Terrain的建议和最佳方法： http://resources.arcgis.com/zh-cn/help/main/10.1/index.html#/na/005v0000001r000000/","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"},{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"不规则三角网（TIN）","slug":"AboutTIN","date":"2012-12-06T01:29:33.000Z","updated":"2016-03-18T09:35:08.000Z","comments":true,"path":"2012/12/06/AboutTIN/","link":"","permalink":"http://www.kikitamap.com/2012/12/06/AboutTIN/","excerpt":"","text":"数字高程模型（DEM）地球表面高低起伏，呈现一种连续变化的曲面，这种曲面无法用平面地图来确切表示。于是我们就利用一种全新的数字地球表面的方法——&nbsp;数字高程模型&nbsp;的方法，这种方法已被普遍广泛采用。数字高程模型即DEM（Digital Elevation Model），是以数字形式按一定结构组织在一起，表示实际地形特征空间分布的模型，也是地形形状大小和起伏的数字描述。 DEM有三种主要的表示模型：规则格网模型，等高线模型和不规则三角网。 格网（即GRID）DEM在地形平坦的地方，存在大量的数据冗余，在不改变格网大小情况下，难以表达复杂地形的突变现象，在某些计算，如通视问题，过分强调网格的轴方向。不规则三角网（简称TIN，即Triangulated Irregular Network）是另外一种表示数字高程模型的的方法（Peuker等，1978），它既减少了规则格网带来的数据冗余，同时在计算（如坡度）效率方面又优于纯粹基于等高线的方法。不规则三角网能随地形起伏变化的复杂性而改变采样点的密度和决定采样点的位置，因而它能够避免地形起伏平坦时的数据冗余，又能按地形特征点如山脊，山谷线，地形变化线等表示数字高程特征。 TIN的基本知识在TIN中，满足最佳三角形的条件为：尽可能的保证三角形的三个角都是锐角，三角形的三条边近似相等，最小角最大化。 TIN 是基于矢量的数字地理数据的一种形式，通过将一系列折点（点）组成三角形来构建。形成这些三角形的插值方法有很多种，例如 Delaunay 三角测量法或距离排序法。ArcGIS 支持 Delaunay 三角测量方法。 TIN 的单位是英尺或米等长度单位，而不是度分秒。当使用地理坐标系的角度坐标进行构建时，Delaunay 三角测量无效。创建&nbsp;TIN 时，应使用投影坐标系（PCS）。 TIN 模型的适用范围不及栅格表面模型那么广泛，且构建和处理所需的开销更大。获得优良源数据的成本可能会很高，并且，由于数据结构非常复杂，处理 TIN 的效率要比处理栅格数据低。 TIN 通常用于较小区域的高精度建模（如在工程应用中），此时 TIN 非常有用，因为它们允许计算平面面积、表面积和体积。 Ⅲ TIN在ArcGIS中的存储TIN 表面数据模型由结点（Node）、边（Edge）、三角形（Triangle）、包面（Hull）和拓扑（Topology）组成。 与 coverage 类似，TIN 以文件目录形式存储。但TIN没有关联的 INFO 文件。TIN 目录由七个包含 TIN 表面信息的文件组成。这些文件以二进制格式编码，因此无法通过标准文本显示或编辑程序读取。 TIN 的最大允许大小视连续可用内存资源而定。对于 Win32 系统而言，正常操作条件下，可达到的最大大小为 1000 到 1500 万个结点。出于可用性和性能的考虑，强烈建议始终将此大小限制在几百万。如果超出这一大小，则最好使用 terrain 数据集来表示。 ArcGIS 10 中采用了约束性&nbsp;Delaunay 三角测量，也就是除了沿隔断线的位置，其他地方都遵守Delaunay准则。 Ⅳ 如何创建TIN在ArcGIS中，TIN 主要是通过矢量数据、栅格数据、Terrain数据集来创建。 1. 从矢量数据创建这是最常用的一种方法。可以通过点、线、面来构建TIN，不同的几何类型可以提供不同的表面要素类型（SF_Type），我们一起来了解下不同的 SF_Type。 （1） 离散多点（Mass Point） 离散多点是 TIN 中的主要输入要素，由它们来决定表面的总体形状。 (2) 隔断线（Breakline） 隔断线通常用于呈现自然要素（如山脊线或河流）或建筑要素（如道路）。隔断线有以下两种：硬隔断线与软隔断线。 隔断线可以有高程信息，也可以没有高程信息。 硬隔断线：硬隔断线用于表示表面坡度的不连续性。河流和道路断面可作为硬隔断线包括在 TIN 中。硬隔断线能够捕获表面的突变并能改进 TIN 的显示和分析质量。 软隔断线：软隔断线是不会改变表面局部坡度的线状要素，例如表示研究区范围边界的线等。 (3) 多边形（Polygon） 裁剪多边形：用于定义 TIN 表面的边界。位于裁剪多边形之外的输入数据将从插值和分析操作（例如，等值线或体积计算）中排除。 擦除多边形：位于擦除多边形之内的输入数据，将从插值和分析操作（例如，等值线或体积计算）中排除。 替换多边形：用于将边界及所有内部高度设置为相同的值。可用于对湖泊或者坡度挖掘到水平面以下的区域进行建模。 填充多边形：用于将一个整数属性值分配给位于此填充多边形内部的所有三角形。表面高度不受影响，并且不发生裁剪或擦除操作。 以上多边形也有软硬之分，类似于软硬隔断线用法。 创建 TIN 使用的的工具是Creat TIN，在输入要素列表中，可以为每种要素的角色进行指定。 如果是更新、修改TIN，可以使用工具Edit TIN工具。 2. 从栅格数据创建栅格数据可以转换为 TIN，并且可以用于简化地表模型。在ArcGIS中主要是通过 Raster to TIN 工具进行显示。 栅格转 TIN 工作过程：首先根据足量的输入栅格点（像元中心）生成候选 TIN，以便完全覆盖栅格表面的边缘。然后，该工具会逐步改进 TIN 表面，直到符合指定的 Z 容差。这个工具的使用主要有两个参数需要注意：Z Tolerance，Max point。 Z Tolerance ：输入栅格与输出 TIN 之间所允许的最大高度差（z 单位）。默认情况下，z 容差是输入栅格 z 范围的 1/10。 Max point：用于控制将在处理过程终止前添加到 TIN 的最大点数。默认情况下，该过程将一直持续到所有点被添加完。 对比如下设置了默认 Z 容差和 500 的Z容差的TIN 效果： 3. 从其他数据创建（1）将 ArcGIS terrain dataset 数据转成 TIN。使用工具 terrain to TIN。 可使用 terrain 金字塔等级的 z 容差或窗口大小分辨率来决定TIN的精细程度。默认值为 0（z 容差），或全分辨率（窗口大小）。 （2）将 LAS Dataset 转成 TIN，使用工具 LAS Dataset to TIN。可通过一定得细化类型和细化方法生成TIN。 （3）使用工具&nbsp;LandXML to TIN，将 LandXML 数据转为TIN。什么是 LandXML？在网上找了个连接：点击。 有关 LAS Dataset 和 Terrain Dataset 后面会再整理总结。 Ⅴ 编辑已有TIN如果使用矢量数据批量编辑TIN，可以使用工具 Edit TIN，位于ArcToolbox中的3D分析工具箱。 如果需要进行交互式的TIN编辑，可以使用ArcMap中提供的 TIN Editing 工具条。 如果调出TIN Editing工具条后，工具都是灰色的，那是因为没有设置编辑对象。 要编辑的 TIN 必须是 3D Analyst 工具条的下拉菜单中的选定图层。 可见，TIN编辑的功能是依赖于3D分析扩展许可的。 交互式的TIN编辑中有个GP工具没有的功能： 从中心线分级（Grade from centralline ……），可用于向 TIN 表面添加道路、堤坝和类似护堤的要素。需要事先选中某一矢量线要素。 Ⅵ 从TIN中输出几何信息使用ArcToolbox中的工具可以将TIN中的信息提取为矢量要素。位于3D分析工具箱中的转换工具集下： 1) TIN Domain：获得TIN的范围，可以选择生成线或者面。 2) TIN Edge：生成表示 TIN 边的矢量线要素。0 — A regular edge；1 — A soft edge；2 — A hard edge 3) TIN line： 生成TIN的隔断线。1—Soft breakline&nbsp;2— Hard breakline 4) TIN Node： 将TIN的节点导出成点要素类，2D、3D要素可选。 5) TIN Polygon Tag：&nbsp;使用 TIN 中的标签值创建面要素。标签是指：分配给三角形的简单形式的整数属性值。其边界在三角测量中将强化为隔断线。标签以有符号长整型数据形式存储。 6) TIN Triangle： 生成构成TIN的三角形面。并为每个三角形提供山体阴影的坡度、坡向和可选属性以及标签值。 7) TIN to Raster： 将TIN生成栅格数据。可选插值方法、数据类型、数据格式等。 Ⅶ 其他仅适用于TIN的工具（1）如果使用的10.0之后的版本，TIN的存储版本有区别，可以使用Copy TIN 工具将 TIN 数据转成低版本（10.0之前）的 TIN 数据。 （2）如果需要裁剪TIN的边界，可以使用工具Delineate TIN Data Area 工具，设置最长边参数，删除 TIN 中的长边。 （3） 如果需要比较两个TIN的差异，使用工具Compare TIN。 O了，至此有关TIN的一个概况结束喽。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"},{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"3D分析之常用转换工具","slug":"3DConversionTool","date":"2012-11-21T03:49:04.000Z","updated":"2016-03-18T09:42:44.000Z","comments":true,"path":"2012/11/21/3DConversionTool/","link":"","permalink":"http://www.kikitamap.com/2012/11/21/3DConversionTool/","excerpt":"","text":"三维分析工具箱中，Conversion工具集为我们提供了很多用于格式转换的工具，其中有几个能为我们解决很多常见问题，这里整理下： 1. 各种数据格式的3D模型导入到ArcGIS中展示使用 Import 3D file 工具，ArcGIS 主要支持以下 3D模型的导入： 3D Studio Max (*.3ds) SketchUp (*.skp) VRML and GeoVRML (*.wrl) OpenFlight (*.flt) COLLADA (*.dae). 将数据导入为ArcGIS的 Multipatch（多面体）要素类，可以选择 shapefile 和 Geodatabase 来存储。 这里需要注意：shapefile multipatch 是不能存储纹理的，如果需要保存纹理，要选择 GDB multipatch feature class。 2. 需要得到 Multipatch 的 2D 轮廓线使用 Multipatch Footprint 工具 3. 获得栅格数据三维边界线/面使用 Raster Domain 工具 4. 使用点数据和现有模型制作场景常常有这样的应用场景：手头有采集的兴趣点数据，并且有现成的3DS、Skp等等诸多模型，需要将这些模型放置在正确地理位置，并将它们统一存入GDB中进行维护。我们可以这样来做： （1） 在ArcScene或者ArcGlobe中添加点图层. （2）双击图层符号，弹出【符号选择器】窗口，点击【编辑符号】。 （3）在弹出的【符号属性编辑器】中，类型下拉列表中选择【3D Marker Symbol】，并在之后的窗口中选择模型的路径。 （4）上步中，根据需要分门别类的给每类点配以不同的模型，最后得到丰富的3D模型组成的场景。 （5） 使用工具：&nbsp;Layer 3D to Feature Class，将模型统一转入GDB，集中存储和维护。原来的模型细节及纹理得到很好的保留。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"3D分析之Functional Surface工具箱","slug":"3DFunctionalSurface","date":"2012-11-18T13:51:59.000Z","updated":"2016-03-18T09:55:32.000Z","comments":true,"path":"2012/11/18/3DFunctionalSurface/","link":"","permalink":"http://www.kikitamap.com/2012/11/18/3DFunctionalSurface/","excerpt":"","text":"1. Add Surface Information（添加表面信息）向点、线或面要素的属性表添加表面高程信息。 ||要素几何||表面属性||||Point||从表面上点的 XY 坐标插入的点高程。||||MultiPoint||针对多点记录中所有点得到的点的最小、最大和平均高程。||||Polyline||沿着表面的线的 3D 距离。从表面上线的路径获得的最小、最大和平均高程和坡度。||||Polygon||面定义的表面部分的 3D 面积。来自表面的最小、最大和平均高程和坡度。|| 2. Interpolate shape（插值 Shape）根据从栅格、不规则三角网 (TIN)、或 terrain 数据集获取的高程值为要素类插入 z 值。 3.&nbsp;Intersect 3D Line With Surface（&nbsp;3D线与表面相交）计算 3D 线要素与一个或多个表面的几何交集，并以分割线要素和点的形式返回交集。 4.&nbsp;Stack Profile（堆栈剖面）创建表格和可选图表，用于说明一个或多个多面体、栅格、TIN 或 terrain 表面上的线要素的剖面。 这个工具可以来制作剖面图。 表中各个字段的含义： FIRST_DIST - 到剖面段中第一个折点的距离。 FIRST_Z - 剖面段中第一个折点的高度。 SEC_DIST - 剖面段中第二个折点的距离。 SEC_Z - 剖面段中第二个折点的高度。 LINE_ID - 用于定义剖面的线要素的唯一 ID。 SRC_TYPE - 剖面源的数据类型，是表面或多面体。 SRC_ID - 要描绘剖面的多面体要素的唯一 ID。不适用于表面输入。 SRC_NAME - 剖面源的名称和路径。 5.&nbsp;Surface Volume（表面体积）可计算指定参考平面以上或以下的栅格、不规则三角网 (TIN) 或 terrain 数据集表面的面积和体积。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"3D分析之3D要素工具箱","slug":"3D3DFeatures","date":"2012-11-18T13:50:43.000Z","updated":"2016-03-18T10:17:00.000Z","comments":true,"path":"2012/11/18/3D3DFeatures/","link":"","permalink":"http://www.kikitamap.com/2012/11/18/3D3DFeatures/","excerpt":"","text":"整理有关 ArcGIS 10.1 3D分析工具箱中，3D Feature 工具箱中，各个工具的功能及注意事项。 1. Add Z information （添加 Z 信息） 各种几何类型的Z信息： Points - Z 值 Multipoints - Z 最小值、Z 最大值、Z 平均值、点计数 Polylines - Z 最小值、Z 最大值、Z 平均值、3D 长度、最小坡度、最大坡度、平均坡度、折点计数 Polygons - Z 最小值、Z 最大值、Z 平均值、3D 长度、最小坡度、最大坡度、平均坡度、折点计数 Multipatches- Z 最小值、Z 最大值、表面面积、体积、最小坡度、最大坡度、平均坡度 关于坡度值： 坡度以百分比值或度数的形式返回 最小坡度根据值最接近 0 或水平度的线段获得。 最大坡度根据具有最大计算值的线段获得。 平均坡度通过按 3D 长度对每条线段进行加权后对所有线段的坡度求平均值获得。这会导致较长线段对结果值的影响比较短线段更大。 面要素的坡度值仅针对边要素计算，使用的方法与线段应用的方法一样。 关于体积： 只能对闭合多面体计算体积。非闭合多面体要素将返回值 0.0。 在 Solaris 平台上，设计的局限性当前将使工具无法确定多面体是否闭合，因此假定所有多面体均为闭合多面体，将针对所有多面体计算体积测量。 关于噪点过滤器： 提供可用于在进行统计计算时排除一小部分要素的选项。此选项非常适用于获得准确的最大坡度估值，因为一小部分要素的坡度值通常较极端，可能使统计结果产生偏差。 面积或长度选项中给出的值将被用于排除这部分要素。此参数不适用于点和多点要素。 NO_FILTER —不使用任何噪点过滤器。这是默认设置。 AREA &lt;…&gt; —对多面体要素类中的部分要素应用面积过滤器。面积 值为 0.001 表示系统将忽略多面体中面积小于 0.001 的部分。 LENGTH &lt;…&gt; — 对线要素类或面要素类中的部分要素应用长度过滤器。长度值为 0.001 时表示系统将忽略长度小于 0.001 的那部分要素。 2. Buffer 3D（3D 缓冲区） 在点或线要素周围创建 3D 缓冲区。点输入将会生成球体，线输入将会生成圆柱要素。结果为Multipatch要素。 提高缓冲质量会生成更平滑的 3D 要素，但处理时间将会更长。 考虑指定一个简化值以提高复杂线要素（例如带有大量折点的曲线）的性能。 3.&nbsp;Difference 3D（3D 差异） 类似于2D中 Erase 工具。 输入面必须是闭合的Multipatch，生成的结果不包含任何属性信息。 参数 Output Table，勾选后，生成这样三列： Output_ID - 输出要素类的唯一 ID。Minuend_ID - 主多面体的唯一 ID。Subtrahend - 已从主多面体中减去的多面体要素的唯一 ID。 4. Enclose Multipatch （封闭多面体）创建闭合多面体要素。 Grid Size：用于构造闭合多面体要素的精度。此值使用输入要素的空间参考的线性单位定义。 5.&nbsp;Feature To 3D By Attribute（通过属性从要素转换到 3D）从输入要素的属性中获得的Z值创建 3D 要素。 此工具支持点、多点、线和面几何。 各要素的高程都从在指定的字段中获得。 对于线要素还可提供第二个高度字段。每条线的起点使用第一个高度，终点使用第二个高度。中间所有折点的高度都将根据两个端点连线的坡度进行内插。 6. Inside 3D（3D 内部）用于识别3D 要素是否包含在闭合的多面体中。 Input Feature 可以是：point、polyline、polygon、multipatch feature class； 输出的表中包含： Target_ID - 输入要素的唯一 ID。Status - 要素完全还是部分落入多面体内。 如果勾选了 Complex Output Table ，生成的表中会多出来：Container_ID - 多面体的唯一 ID。 7. Intersect 3D（3D 相交）计算闭合多面体要素的交集。 注意： 如果只提供了一个输入要素类，将会计算该多面体数据集中各要素的相交情况； 如果提供了两个要素，将会确定这两个数据集的要素的相交部分，同时忽略那些只存在于一个输入中相交情形。 输出类型： SOLID — 创建交集闭合多面体。这是默认设置。 SURFACE — 创建表示输入要素之间共享面的多面体表面。 POLYLINE — 创建表示输入要素之间共享边的折线。 8.&nbsp;Intersect 3D Line With Multipatch（3D 线与多面体相交） 确定并返回线与多面体要素之间几何交集的数量。可选择性地将表示交集的点要素和表示在此类点分开的输入线的线要素写入输出要素类中。 交点计数将在消息窗口中作为整数结果返回，并可在模型和脚本中用于建立后续操作的前提条件。 9.&nbsp;Is Closed 3D（是否为闭合 3D）评估多面体要素是否是完全封闭的。 将 IsClose 字段添加到现有Multipatch要素的属性表中。 10. Near 3D（3D 邻近）计算每个输入要素到一个或多个邻近要素类中的最近要素的三维距离。 在原输入数据的属性表中增加N多最邻近点的信息。 11. Union 3D（3D 联合）基于输入要素类对闭合的重叠多面体要素进行合并。 如果两个或多个多面体要素仅共享一条边或一个折点，则会发出一个警告，说明生成的要素不是简单要素，因此无法创建。 如果组中包含的多面体没有共享的体积或空间，则会返回相同的消息。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"3D分析之ArcGIS 支持的表面类型","slug":"3DSupportedSurface","date":"2012-11-17T04:14:13.000Z","updated":"2016-03-20T03:06:56.279Z","comments":true,"path":"2012/11/17/3DSupportedSurface/","link":"","permalink":"http://www.kikitamap.com/2012/11/17/3DSupportedSurface/","excerpt":"","text":"为了表示连续的表面，ArcGIS 提供了多种表示、存储函数表面的数据格式，主要是以下四类，其中包括10.1带来的新类型：LAS Dataset。 我们可以借助于ArcGIS的3D分析扩展，对这些函数表面数据进行三维的显示、分析等。但是需要注意的是，这些数据并不是真正意义上的真三维，这是我们常说的2.5D。因为这些数据在某个XY坐标对对应的位置上，只能存储一个Z值，而真正的三维实体是在某个位置上有一系列的Z值。这种三维实体，ArcGIS中是以Multipatch存储和表示的。 1.Raster 这是最常见的一种栅格表面数据格式，通常是浮点型的连续栅格。 2.TIN 3.LAS Dataset 4.Terrain Dataset 四种格式，在各种GDB中的支持情况：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"了解 ArcScene 与 ArcGlobe","slug":"ArcSceneArcGlobe","date":"2012-11-17T04:13:13.000Z","updated":"2016-03-20T03:09:48.285Z","comments":true,"path":"2012/11/17/ArcSceneArcGlobe/","link":"","permalink":"http://www.kikitamap.com/2012/11/17/ArcSceneArcGlobe/","excerpt":"","text":"ArcGIS 中，ArcScene 与 ArcGLobe 是两种3D数据可视化以及分析的组件或者说环境，它们二者有什么样的区别，如何根据自己的应用去选择呢？以下是对这二者的对比信息总结： 1. 许可都需要 3D Analyst License 才能启动。 2. 坐标系统ArcScene - 使用第一个加入ArcScene的数据的坐标系统，当不同坐标系的数据加入时，进行动态投影，这点同ArcMap。通常使用平面坐标系（投影坐标系）。ArcGlobe - WGS 1984 Cube Projection *，当不同坐标系的数据加入时，进行动态投影。 那神马是立方体投影（cube projection）？也就是将地球投影到各面都是正方形的六面体上。如下图： 需要说明，这种投影，经线和纬线都是直线；在纬度 +45° 和 -45° 之间，东南西北方向是准确的，比例尺是正确的；在极面上，由中心确定的方向是真实的。但是这种投影不适合制图，仅适用于ArcGlobe。 3. 内存管理与缓存机制ArcScene - 将所有数据加载到内存中，必要的时候使用虚拟内存。也因此，ArcScene通常用来展示小场景、小数据量。ArcGlobe - 通常专用于超大型数据集，缓存过程中会建立索引并将所有数据组织为各个切片和细节层次。 4. 数据类型的支持ArcGlobe支持terrain数据，但是ArcScene不支持。ArcScene中不支持Annotation。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"3D","slug":"3D","permalink":"http://www.kikitamap.com/tags/3D/"}]},{"title":"空间分析之水文分析","slug":"SAHydrology","date":"2012-08-27T01:11:00.000Z","updated":"2016-03-20T05:48:33.281Z","comments":true,"path":"2012/08/27/SAHydrology/","link":"","permalink":"http://www.kikitamap.com/2012/08/27/SAHydrology/","excerpt":"","text":"接收雨水的区域以及雨水到达出水口前所流经的网络被称为水系。流经水系的水流只是通常所说的水文循环的一个子集，水文循环还包括降雨、蒸发和地下水流。水文分析工具重点处理的是水在地表上的运动情况。“水文分析”工具用于为地表水流建立模型。 盆域分析（Basin）：创建描绘所有流域盆地的栅格。 填洼（Fill）：通过填充表面栅格中的汇来移除数据中的小缺陷。 流量（Flow Accumulation）：创建每个像元累积流量的栅格。可选择性应用权重系数。 流向（Flow Direction）：创建从每个像元到其最陡下坡相邻点的流向的栅格。 水流长度（Flow length）：计算沿每个像元的流路径的上游（或下游）距离或加权距离。 汇（Sink）：创建识别所有汇或内流水系区域的栅格。 捕捉倾泻点（Snap pour point）：将倾泻点捕捉到指定范围内累积流量最大的像元。 河流连接（Stream link）：向各交汇点之间的栅格线状网络的各部分分配唯一值。 河网分级（Stream Order）：为表示线状网络分支的栅格线段指定数值顺序。 栅格河网矢量化（Stream to Feature）：将表示线状网络的栅格转换为表示线状网络的要素。 分水岭（Watershed）：确定栅格中一组像元之上的汇流区域。 了解水系的术语，如下图： 以下流程图显示的是从数字高程模型 (DEM) 中提取水文信息（如分水岭边界和河流网络）的过程： 现在就以手中的这个DEM为例来依次使用工具集中的工具，来学习这部分功能： 一、流向（Flow Direction）流向工具的输出是值范围介于 1 到 255 之间的整型栅格。从中心出发的各个方向值为： 例如，如果最陡下降方向位于当前处理像元的左侧，则将该处理像元的流向编码将为 16。 如果像元的 z 值在多个方向上均发生相同变化，并且该像元是凹陷点的一部分，则该像元的流向将被视为未定义。此时，该像元在输出流向栅格中的值将为这些方向的总和。例如，如果 z 值向右（流向 = 1）和向下（流向 = 4）的变化相同，则该像元的流向为 1 + 4 = 5。可以使用汇工具将具有未定义流向的像元标记为凹陷点。 二、汇（Sink）汇是指流向栅格中流向无法被赋予八个有效值之一的一个或一组空间连接像元。汇被视为具有未定义的流向，并被赋予等于其可能方向总和的值。 汇工具的输出是一个整型栅格，其中每个汇都被赋予一个唯一值。汇的编号介于 1 到汇的数量之间。 三、填洼（Fill）通过填充表面栅格中的汇来移除数据中的小缺陷。 凹陷点是指具有未定义流域方向的像元；其周围的像元均高于它。倾泻点相对于凹陷点的汇流区域高程最低的边界像元。如果凹陷点中充满了水，则水将从该点倾泻出去。 TIPS：有关填充的Z限制 要填充的凹陷点与其倾泻点之间的最大高程差。如果凹陷点与其倾泻点之间的 z 值差大于 z 限制，则不会填充此凹陷点。 默认情况下将填充所有凹陷点（不考虑深度）。 四、流量（Flow Accumulation）创建每个像元累积流量的栅格。流量累积将基于流入输出栅格中每个像元的像元数。 高流量的输出像元是集中流动区域，可用于标识河道。流量为零的输出像元是局部地形高点，可用于识别山脊。 流量工具不遵循压缩环境设置。输出栅格将始终处于未压缩状态。 通过上面的填洼，求流向，得到如下流量图，看到了河道： 五、河网分级（Stream Order）河网分级是一种将级别数分配给河流网络中的连接线的方法。此级别是一种根据支流数对河流类型进行识别和分类的方法。仅需知道河流的级别，即可推断出河流的某些特征。 河网分级工具有两种可用于分配级别的方法。这两种方法由 Strahler (1957) 和 Shreve (1966) 提出。在这两种方法中，始终将 1 级分配给上游河段。 Strahler 河流分级方法： 在 Strahler 法中，所有没有支流的连接线都被分为 1 级，它们称为第一级别。当级别相同的河流交汇时，河网分级将升高。 因此，两条一级连接线相交会创建一条二级连接线，两条二级连接线相交会创建一条三级连接线，依此类推。但是，级别不同的两条连接线相交不会使级别升高。例如，一条一级连接线和一条二级连接线相交不会创建一条三级连接线，但会保留最高级连接线的级别。 Shreve 河流分级方法： Shreve 法考虑网络中的所有连接线。与 Strahler 法相同，所有外连接线都被分为 1 级。但对于 Shreve 法中的内连接线，级别是增加的。例如，两条一级连接线相交会创建一条二级连接线，一条一级连接线和一条二级连接线相交会创建一条三级连接线，而一条二级连接线和一条三级连接线相交则会创建一条五级连接线。 因为级别可增加，所以 Shreve 法中的数字有时指的是量级，而不是级别。在 Shreve 法中，连接线的量级是指上游连接线的数量。 六、栅格河网矢量化（Stream to Feature）栅格河网矢量化工具使用的算法主要用于矢量化河流网络或任何表示方向已知的栅格线性网络的栅格。 该工具使用方向栅格来帮助矢量化相交像元和相邻像元。可将两个值相同的相邻栅格河网矢量化为两条平行线。 这与栅格转折线 (Raster to Polyline) 工具相反，后者通常更倾向于将线折叠在一起。下图是两者的对比： 七、河流连接（Stream link）向各交汇点之间的栅格线状网络的各部分分配唯一值。 “连接”是指连接两个相邻交汇点、连接一个交汇点和出水口或连接一个交汇点和分水岭的河道的河段。 八、水流长度（Flow Length）水流长度工具的主要用途是计算给定盆地内最长水流的长度。该度量值常用于计算盆地的聚集时间。这可使用 UPSTREAM 选项来完成。 该工具也可通过将权重栅格用作下坡运动的阻抗，来创建假设降雨和径流事件的距离-面积图。 九、捕捉倾泻点（Snap pour point）捕捉倾泻点工具用于确保在使用分水岭工具描绘流域盆地时选择累积流量大的点。 捕捉倾泻点将在指定倾泻点周围的捕捉距离范围内搜索累积流量最大的像元，然后将倾泻点移动到该位置。 十、分水岭（Watershed）确定栅格中一组像元之上的汇流区域。 十一、盆域创建描绘所有流域盆地的栅格。 通过识别盆地间的山脊线，在分析窗口中描绘流域盆地。通过分析输入流向栅格数据找出属于同一流域盆地的所有已连接像元组。通过定位窗口边缘的倾泻点（水将从栅格倾泻出的地方）及凹陷点，然后再识别每个倾泻点上的汇流区域，来创建流域盆地。这样就得到流域盆地的栅格。 以下是盆域分析示例： That’s all.","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Analyst","slug":"Spatial-Analyst","permalink":"http://www.kikitamap.com/tags/Spatial-Analyst/"}]},{"title":"空间分析之插值分析","slug":"SAInterpolation","date":"2012-08-27T01:10:00.000Z","updated":"2016-03-20T05:43:37.085Z","comments":true,"path":"2012/08/27/SAInterpolation/","link":"","permalink":"http://www.kikitamap.com/2012/08/27/SAInterpolation/","excerpt":"","text":"在实际工作中，由于成本的限制、测量工作实施困难大等因素，我们不能对研究区域的每一位置都进行测量（如高程、降雨、化学物质浓度和噪声等级）。这时，我们可以考虑合理选取采样点，然后通过采样点的测量值，使用适当的数学模型，对区域所有位置进行预测，形成测量值表面。插值之所以可称为一种可行的方案，是因为我们假设，空间分布对象都是空间相关的，也就是说，彼此接近的对象往往具有相似的特征。 ArcGIS的空间分析中，提供了插值（Interpolation）工具集，如下： 1. 反距离权重法（IDW–Inverse Distance Weighted）此方法假定所映射的变量因受到与其采样位置间的距离的影响而减小。 幂参数： IDW主要依赖于反距离的幂值。基于距输出点的距离，幂参数可以控制已知点对内插值的影响。幂参数是一个正实数，默认值为 2，一般在0.5至3之间取值。随着幂值的增大，内插值将逐渐接近最近采样点的值。指定较小的幂值，将对距离较远的周围点产生更大影响，会产生更加平滑的表面。由于反距离权重公式与任何实际物理过程都不关联，因此无法确定特定幂值是否过大。作为常规准则，认为值为 30 的幂是超大幂，因此不建议使用。此外还需牢记一点，如果距离或幂值较大，则可能生成错误结果。 障碍： 障碍是一个用作可限制输入采样点搜索的隔断线的折线 (polyline) 数据集。一条折线 (polyline) 可以表示地表中的悬崖、山脊或某种其他中断。仅将那些位于障碍同一侧的输入采样点视为当前待处理像元。 注意事项： （1）因为反距离权重法是加权平均距离，所以该平均值不可能大于最大输入或小于最小输入。因此，如果尚未对这些极值采样，便无法创建山脊或山谷。 （2）此工具最多可处理约 4,500 万个输入点。如果输入要素类包含 4,500 万个以上的点，工具可能无法创建结果。 工具执行截图： ==&gt; 2. 克里金法（Kriging）克里金法假定采样点之间的距离或方向可以反映可用于说明表面变化的空间相关性。克里金法是一个多步过程；它包括数据的探索性统计分析、变异函数建模和创建表面，还包括研究方差表面。该方法通常用在土壤科学和地质中。 3. 自然邻域法（Natural Neighbor）可找到距查询点最近的输入样本子集，并基于区域大小按比例对这些样本应用权重来进行插值。该插值也称为 Sibson 或“区域占用 (area-stealing)”插值。 4. 样条函数（Spline）使用二维最小曲率样条法将点插值成栅格表面。生成的平滑表面恰好经过输入点。 5. 含障碍的样条函数（Spline with Barriers）通过最小曲率样条法利用障碍将点插值成栅格表面。障碍以面要素或折线要素的形式输入。样条函数法工具所使用的插值方法使用可最小化整体表面曲率的数学函数来估计值。 6. 地形转栅格（Topo to Raster）将点、线和面数据插值成符合真实地表的栅格表面。 依据文件实现地形转栅格（Topo to Raster by file） 通过文件中指定的参数将点、线和面数据插值成符合真实地表的栅格表面。通过这种技术创建的表面可更好的保留输入等值线数据中的山脊线和河流网络。 7. 趋势（trend）使用趋势面法将点插值成栅格曲面。趋势表面会逐渐变化，并捕捉数据中的粗尺度模式。 以上是插值工具的简单说明与比较，这些工具的背后都有庞大的理论基础和复杂的算法，需要进一步学习整理和补充。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Analyst","slug":"Spatial-Analyst","permalink":"http://www.kikitamap.com/tags/Spatial-Analyst/"}]},{"title":"空间分析之多元分析","slug":"SAMultiDimensions","date":"2012-08-27T01:10:00.000Z","updated":"2016-03-20T05:45:29.847Z","comments":true,"path":"2012/08/27/SAMultiDimensions/","link":"","permalink":"http://www.kikitamap.com/2012/08/27/SAMultiDimensions/","excerpt":"","text":"通过多元统计分析可以探查许多不同类型的属性之间的关系。 有两种可用的多元分析：分类（监督分类与非监督分类/Supervised&amp;Unsupervised)）和主成分分析/Principal Component Analysis (PCA)。 ArcGIS 提供了如下工具： 一、波段集统计工具（Band Collection Statistics）栅格波段必须具有一个公共交集。如果不存在公共交集，则会出现错误，且不会创建任何输出。 如果栅格波段的范围不同，统计数据将以所有输入栅格波段的共同的空间范围来计算。默认情况下，像元大小为输入栅格的最大像元的大小；否则，将取决于栅格分析环境设置。 此工具计算每个图层的基本统计测量值（最小值、最大值、平均值和标准差），如果勾选协方差和相关矩阵，还可以得到这两个值。 二、创建特征（Create Signature）创建由输入样本数据和一组栅格波段定义的类的 ASCII 特征文件。该工具可创建将用作其他多元分析工具的输入参数的文件。 该文件由两部分组成： 1） 所有类的常规信息，例如图层数、输入栅格名称和类别数。2） 每个类别的特征文件，由样本数、平均值和协方差矩阵组成。 三、编辑特征（Edit Signature）通过合并、重新编号和删除类特征来编辑和更新特征文件。 输入特征重映射文件是 ASCII 文件，其每一行有两列值与之对应，以冒号分隔。第一列是原始类 ID 值。第二列包含用于在特征文件中更新的新类 ID。文件中的所有条目必须基于第一列以升序进行排序。 编辑特征文件的写法是固定的，如下： 只有需要编辑的类才必须被放入特征重映射文件；任何在重映射文件中不存在的类将保持不变。 要合并一组类，原类 ID：新类 ID。 要删除类特征，使用 -9999 作为该类第二列的值。 要重新编号，将类 ID 重新编号为某个不存在于输入特征文件中的值。 示例：12342 : 34 : 115 : -99999 : 3 上例将使用 3 合并类 2 和 类 9，使用 11 合并类 4，并将删除类 5。 四、树状图（Dendrogram）构造可显示特征文件中连续合并类之间的属性距离的树状图。 有关其工作原理，详见：http://help.arcgis.com/zh-cn/arcgisdesktop/10.0/help/index.html#/na/009z000000q6000000/ 五、最大似然法分类（Maximum Likelihood Classification）最大似然法分类工具所用的算法基于两条原则： 1） 每个类样本中的像元在多维空间中呈正态分布2） 贝叶斯决策理论 TIPS：工具中有几个参数需要注意： reject_fraction：将因最低正确分配概率而得不到分类的像元部分。 默认值为 0.0；将对每个像元进行分类。共有 14 个有效输入：0.0、0.005、0.01、0.025、0.05、0.1、0.25、0.5、0.75、0.9、0.95、0.975、0.99 和 0.995。 a_priori_probabilities：指定将如何确定先验概率。 EQUAL — 所有类将具有相同的先验概率。 SAMPLE — 先验概率将与特征文件内所有类中采样像元总数的相关的各类的像元数成比例。 FILE — 先验概率将会分配给输入 ASCII 先验概率文件中的各个类。 以下是通过三类样本的特征文件，分类的栅格数据的示例： 六、Iso 聚类（Iso Cluster） Iso表示：iterative self-organizing –迭代自组织方法。 Iso聚类工具对输入波段列表中组合的多元数据执行聚类。所生成的特征文件（*.gsg）可用作生成非监督分类栅格的分类工具（例如最大似然法分类）的输入。 类数的最小有效值为二。不存在最大聚类数。通常情况下，聚类越多，所需的迭代就越多。 七、Iso 聚类非监督分类（Iso Cluster Unsupervised Classification）此工具为脚本工具，此工具结合了 Iso 聚类工具与最大似然法分类工具的功能。输出经过分类的栅格。 八、类别概率（Class Probability）如果发现分类中的某些区域被分配给某一类的概率不是很高，则说明可能存在混合类。 例如，根据分类概率波段，一个已被分类为森林的区域属于森林类的概率只有 55%。您又发现同一区域属于草地类的概率却有 40%。显然，该区域既不属于森林类也不属于草地类。它更可能是一个森林草地混合类。对于使用分类概率工具生成的分类概率，最好检查分类结果。 生成的多波段栅格数据的波段数等于类别数，每个波段表示某种分类的可能概率，像元值从0至100。 九、主成分分析（Principal Components）对一组栅格波段执行主成分分析 (PCA) 并生成单波段栅格作为输出。此工具生成的是波段数与指定的成分数相同的多波段栅格。 主成分分析工具用于将输入多元属性空间中的输入波段内的数据变换到相对于原始空间对轴进行旋转的新的多元属性空间。新空间中的轴（属性）互不相关。之所以在主成分分析中对数据进行变换，主要是希望通过消除冗余的方式来压缩数据。 以上提到的几个工具，在ArcGIS 10.x版本中，除了在ArcToolbox中可以找到，在 Image Classification 工具条中也可以找到对应的功能，如下图： 这个工具集涉及很多遥感的理论知识，仅仅使用工具是不够的，后面需要多多学习……","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Analyst","slug":"Spatial-Analyst","permalink":"http://www.kikitamap.com/tags/Spatial-Analyst/"}]},{"title":"空间分析之区域分析","slug":"SAZonal","date":"2012-08-24T09:12:00.000Z","updated":"2016-03-20T05:42:19.329Z","comments":true,"path":"2012/08/24/SAZonal/","link":"","permalink":"http://www.kikitamap.com/2012/08/24/SAZonal/","excerpt":"","text":"空间分析扩展中，有关区域分析，提供了如下工具： 可以将其分为这样几类： 一、确定区域中类的面积的工具面积制表（Tabulate Area）面积制表工具以表的形式进行输出。在此表中： 1）区域数据集的每个唯一值均有一条记录。 2）类数据集的每个唯一值均有一个字段。 3）每个记录将存储每个区域内每个类的面积。 TIPS： 使用此工具的常见错误： 1.“一个或多个输入没有关联属性表” 错误 此错误通常是由于区域输入中没有所需的属性表而导致的。 如果区域输入是一个栅格数据，请先使用构建栅格属性表为其创建一个属性表。 如果区域输入是一个要素数据集，则在内部转换为栅格的过程中会自动创建属性表。 2.“无法分配内存” 错误 程序使用内部表执行面积计算。如果区域输入的值域非常大（百万级别），则处理这些表的内存需求可能会接近或超出指定的系统分页文件大小。 如果所配置的内存总量不足，操作将失败，并将显示“无法分配内存”消息。此问题通常有两种解决方法： A） 您可增大虚拟内存设置以避免出现此错误。但是，要注意的是，工具执行完毕后，操作系统不会立即释放其所占用的虚拟内存。从而可能会降低计算机的总体性能。 B） 另一种方法是减小区域的值域（建议方法）。步骤如下：首先向区域属性表添加一个新项和一个索引值，然后对该项使用面积制表，最后再将结果与原始区域输入相关联。例如，如有仅有三个区域值 2,120,000、4,070,000 和 9,540,000，则可将它们除以 10,000，从而得到区域值 212、407 和 954。 3.输出面积小于预计结果 输出表中的某些面积值可能小于预计结果。 这通常与输入中的 NoData 像元有关，经重采样以匹配其他更为粗糙的输入之后，这些具有高分辨率的像元将变为更大的 NoData 区域。 为避免此情况，请对较粗糙的输入栅格进行重采样以使其与较精细的输入栅格的分辨率相匹配，或者将像元大小栅格分析环境设置为输入的最小值。 二、填充指定区域的工具区域填充（Zonal Fill ）输入区域栅格数据可以为整型或浮点型。使用权重栅格数据沿区域边界的最小像元值填充区域。 区域填充可用作水文分析的一部分，将洼地填充至分水岭边界的最小高程。 此工具有待实践，结合水文分析学习。 三、作用于区域形状的工具分区几何统计（Zonal Geometry）这里说的区域是指具有相同值的所有像元。各区无需相连。栅格和要素数据集都可用于工具的输入。 这个工具的亮点在于可以统计区的总面积（AREA）、总周长（PERIMETER）、厚度（THICKNESS）、质心（CENTROID）。其他三个比较好理解，我们看下厚度的概念。 分区厚度分析可计算输入栅格上各个区域中最深或最厚点距其周围像元的距离。 实际上，厚度就是可在各个区域中（不包括区域外部的任何像元）绘制的最大圆的半径（以像元为单位）。如下图： 以表格显示分区几何统计（Zonal Geometry as Table）将上述统计结果输出到Table表中。 其中，最后三个参数，用于描述各个区域的椭圆近似的形状。定义椭圆形状和大小的参数为长轴、短轴和方向。各椭圆的面积与为其分配的区域的面积相等。 MAJORAXIS：长轴的长度；MINORAXIS：短轴的长度。以地图单位表示。 ORIENTATION 值的单位为度，取值范围为 0 至 180。方向定义为 x 轴与椭圆长轴之间的角度。方向的角度值以逆时针方向增加，起始于东方向（右侧水平位置）的 0 值，在长轴垂直时通过 90 位置。如果某个特定区域仅由一个像元组成，或者该区域为单个像元方块，那么会将椭圆（在此情况下为圆）的方向设置为 90 度。 四、确定某输入栅格值在另一区域中的频数分布的工具区域直方图（Zonal Histogram）创建显示各唯一区域值输入中的像元值频数分布的表和直方图（Graph类型）。 区域字段必须为整型或字符串类型。 五、作用于区域属性的工具分区统计（Zonal Statistics）以表格显示分区统计（**Zonal Statistics as Table**） 这两个工具是，计算在另一个数据集的区域内栅格数据值的统计信息。这里的区域定义为输入中具有相同值的所有区。各区无需相连。栅格和要素数据集都可用于区域输入。 前者生成栅格数据，后者生成统计表。 OK……","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Analyst","slug":"Spatial-Analyst","permalink":"http://www.kikitamap.com/tags/Spatial-Analyst/"}]},{"title":"空间分析之邻域分析","slug":"SAProximity","date":"2012-08-23T08:49:00.000Z","updated":"2016-03-20T05:39:15.232Z","comments":true,"path":"2012/08/23/SAProximity/","link":"","permalink":"http://www.kikitamap.com/2012/08/23/SAProximity/","excerpt":"","text":"ArcGIS 的空间分析扩展中，提供了这样一组邻域分析工具： 1. 块统计（Block Statistics）分块统计，按照指定邻域类型计算区域统计值，输出区域为指定邻域类型的外接矩形。 以下为邻域的形式： NbrAnnulus({innerRadius}, {outerRadius}, {CELL | MAP}) NbrCircle({radius}, {CELL | MAP} NbrRectangle({width}, {height}, {CELL | MAP}) NbrWedge({radius}, {start_angle}, {end_angle}, {CELL | MAP}) NbrIrregular(kernel_file) NbrWeight(kernel_file) Irregular与Weight邻域类型需要指定核文件（ .txt 文件）。 可以进行统计的计算类型： MEAN/平均值； MAJORITY/众数（出现次数最多的值）； MAXIMUM/最大值； MEDIAN/中值； MINIMUM/最小值； MINORITY/少数（出现次数最少的值）； RANGE/范围（最大值和最小值之差）。 STD/标准差。 SUM/总和。 VARIETY/变异度（唯一值的数量）。 例如，输入为圆形邻域，输出为外接矩形的像元范围： 2. 滤波器（Filter）对栅格执行平滑（低通）滤波器或边缘增强（高通）滤波器。 滤波器工具既可用于消除不必要的数据，也可用于增强数据中不明显的要素的显示。 低通滤波（平滑边界）： 高通滤波（边缘增强）： 3. 焦点流（Focal Flow）焦点流工具使用直接的 3 x 3 邻域来确定一个像元的八个相邻点中哪一个流向此像元。 焦点流也可以是液体由高到低流动的方向，也可以是定义的任何移动（比如污染物向污染浓度较低的地方流入）。 举个例子，各个方向流向像元中心像元的值总和是最终值。 4. 焦点统计（Focal Statistics）为每个输入像元位置计算其周围指定邻域内的值的统计数据。 统计类型与邻域形状与块统计是相同的，区别在于，块统计的输出是整个邻域的外接矩形范围，而焦点统计的输出，是邻域内的焦点栅格。如下图： 5. 线统计工具用于为每个输出栅格像元周围的圆形邻域内所有线的指定字段值计算统计量。 可用的统计量类型有：均值、众数、最大值、中位数、最小值、少数、范围、标准差以及变异度。只有众数、少数和中位数统计量是根据线长度进行加权的。 还没有想到此工具的应用场景，以后有了再来追加。 6. 点统计该工具类似于焦点统计工具，不同之处在于它直接对点要素而非栅格进行操作。直接对要素进行操作的其中一个优点在于，即使点距离过近，在转换成栅格时点也不会丢失。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Analyst","slug":"Spatial-Analyst","permalink":"http://www.kikitamap.com/tags/Spatial-Analyst/"}]},{"title":"空间分析之表面分析","slug":"SASurface","date":"2012-08-20T01:31:00.000Z","updated":"2016-03-20T05:37:48.572Z","comments":true,"path":"2012/08/20/SASurface/","link":"","permalink":"http://www.kikitamap.com/2012/08/20/SASurface/","excerpt":"","text":"我们可以利用“表面分析（Surface）”工具量化及可视化地形地貌。 坡向（Aspect）：获得栅格表面的坡向。求得每个像元到其相邻像元方向像元值的变化率最大的下坡方向。 等值线（Contour）：根据栅格表面创建等值线（等值线图）的线要素类。 等值线序列（Contour List）：根据栅格表面创建所选等值线值的要素类。 含障碍的等值线（Contour with Barriers）：根据栅格表面创建等值线。如果包含障碍要素，则允许在障碍两侧独立生成等值线。 曲率（Curvature）：计算栅格表面的曲率，包括剖面曲率和平面曲率。 填挖方（Cut Fill）：计算两表面间体积的变化。通常用于执行填挖操作。 山体阴影（HillShade）：通过考虑照明源的角度和阴影，根据表面栅格创建地貌晕渲。 视点分析（Observer Point）：识别从各栅格表面位置进行观察时可见的观察点。 坡度（Slope）：判断栅格表面的各像元中的坡度（梯度或 z 值的最大变化率）。 视域（Viewshed）：确定对一组观察点要素可见的栅格表面位置。 下面分类来看一下这些工具： 一、 各种等值线工具1） 等值线（Contour） 根据栅格表面数据创建等值线线要素类。可以指定起算线和间隔。 2） 等值线列表（Contour list） 根据栅格表面创建所指定等值线值的要素类。 3）含障碍的等值线（Contour with Barriers） 根据栅格表面创建等值线。如果包含障碍要素，则允许在障碍两侧独立生成等值线。 TIPS： 关于等值线的质量问题 少数情况下，所创建等值线的轮廓可能会呈方形或不均匀，看起来犹如沿着栅格像元的边界。出现这种情况可能是因为各栅格的值为整数且恰好落在等值线上。这并不是个问题，该等值线不过是原样呈现数据而已。 如果希望等值线更平滑，可行的方法包括对源数据进行平滑处理或调整起始等值线。 二、表面特征相关工具1） 坡向（Aspect） 此工具求得每个像元到其相邻的各个像元方向的 z 值上变化率最大的下坡方向。 从概念上讲，坡向工具将根据要处理的像元或中心像元周围一个 3 x 3 的像元邻域的 z 值拟合出一个平面。该平面的朝向就是待处理像元的坡向。 输出栅格的值将是坡向的罗盘方向。坡向由 0 到 359.9 度之间的正度数表示，以北为基准方向按顺时针进行测量。会为输入栅格中的平坦（具有零坡度）像元分配 -1 坡向。 2） 坡度（Slope） 坡度是指各像元中 z 值的最大变化率。 从概念上讲，该工具会将一个平面与要处理的像元或中心像元周围一个 3 x 3 的像元邻域的 z 值进行拟合。该平面的坡度值通过最大平均值法来计算。 如果邻域内某个像元位置的 z 值为 NoData，则将中心像元的 z 值指定给该位置。如果直接邻域（3 x 3 窗口）中的中心像元为 NoData，则输出将为 NoData。 确定输出坡度数据的测量单位（度或百分比）。 DEGREE — 坡度倾角，单位：度，范围：0 ~ 90。 PERCENT_RISE — 高程增量百分比，也称为百分比坡度，范围：0 ~ ∞。 该工具可与其他类型的连续数据（如人口）配合使用，用来识别值的急剧变化。 关于工具的详细算法：http://help.arcgis.com/zh-cn/arcgisdesktop/10.0/help/index.html#/na/009z000000vz000000/ 3） 曲率（Curvature） 主要输出结果为每个像元的表面曲率。曲率是表面的二阶导数，或者可称之为坡度的坡度。曲率为正说明该像元的表面向上凸。曲率为负说明该像元的表面开口朝上凹入。值为 0 说明表面是平的。 可供选择的输出曲率类型为：剖面曲率（沿最大斜率的坡度）和平面曲率（垂直于最大坡度的方向）。 从应用的角度看，该工具的输出可用于描述流域盆地的物理特征，从而便于理解侵蚀过程和径流形成过程。坡度会影响下坡时的总体移动速率。坡向将决定流向。剖面曲率将影响流动的加速和减速，进而将影响到侵蚀和沉积。平面曲率会影响流动的汇聚和分散。 三、 填挖方（Cut Fill）计算两表面间体积的变化。通常用于执行填挖操作。 默认情况下，将使用专用渲染器来高亮显示执行填挖操作的位置。该渲染器将被挖的区域绘制成蓝色，将被填的区域绘制成红色。没有变化的区域将显示为灰色。 四、山影（Hillshade） 此工具考虑的主要因素是太阳（照明源）在天空中的位置。看下此工具的参数设置： 方位角（Azimuth）指的是太阳的角度方向，是以北为基准方向在 0 到 360 度范围内按顺时针进行测量的。90º 的方位角为东。此工具默认方向角为 315º (NW)。 高度（Altitude）指的是太阳高出地平线的角度或坡度。高度的单位为度，范围为 0（位于地平线上）到 90（位于头上）之间。此工具默认值为 45 度。 Model shadows 通过对选择 Model shadows，可计算局部照明度以及像元是否落入阴影内。阴影值为0，所有其他像元的编码为介于 1 和 255 之间的整数。 Z 因子（Z factor） z 单位与输入表面的 x,y 单位不同时，可使用 z 因子调整 z 单位的测量单位。计算最终输出表面时，将用 z 因子乘以输入表面的 z 值。 如果 x,y 单位和 z 单位采用相同的测量单位；则 z 因子为 1。这是默认值。此外，z 因子还可用于地形夸大。 例如，如果 z 单位是英尺而 x,y 单位是米，则应使用 z 因子 0.3048 将 z 单位从英尺转换为米（1 英尺 = 0.3048 米） 关于工具的详细算法：http://help.arcgis.com/zh-cn/arcgisdesktop/10.0/help/index.html#/na/009z000000z2000000/ 五、可见性分析1） 视点分析 视点工具生成的是在观测点处能够看到哪些位置的像元的二进制编码信息。观察点被限制为最多16 个。此工具仅支持点要素输入。 可见性信息存储在 VALUE 项中。如果要显示通过视点 3 能看到的所有栅格区域，就打开输出栅格属性表，然后选择视点 3 (OBS3) 等于 1 而其他所有视点等于 0 的记录。 例如，如下是7个观测点的可视性分析结果的属性表： 2） 视域 视域工具会创建一个栅格数据，以记录可从输入视点或 视点折线要素位置看到每个区域的次数。该值记录在输出栅格表的 VALUE 项中。 TIPS：控制可见性分析 通过在要素属性数据集中指定不同的项，可限制所检查的栅格区域。共有九项：SPOT、OFFSETA、OFFSETB、AZIMUTH1、AZIMUTH2、VERT1、VERT2、RADIUS1 和 RADIUS2。 附图帮助理解： 这些值的默认值： 选项 默认值 参数意义 SPOT 使用双线性插值进行估计 观测点位置的高程 OFFSETA 1 观测点高（例如，仪器高），必须为正数 OFFSETB 0 各像元高(例如，目标高），必须为正数 AZIMUTH1 0 观测起始方位角 AZIMUTH2 360 观测终止方位角 VERT1 90 观测起始竖直角 VERT2 -90 观测终止竖直角 RADIUS1 0 起始可见半径 RADIUS2 无穷大 终止可见半径 如果视点要素数据集是点要素类，则每个观测点都可具有属性表中的唯一一组观测约束。如果视点要素数据集是折线要素类，则沿输入折线的每个折点都会使用属性表的折线记录中包含的相同观测约束。如果某项不存在，将使用默认值。 O了，关于表面分析的工具，总结到此结束。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Analyst","slug":"Spatial-Analyst","permalink":"http://www.kikitamap.com/tags/Spatial-Analyst/"}]},{"title":"空间分析之常用工具","slug":"SAGeneral","date":"2012-08-19T13:19:00.000Z","updated":"2016-03-20T05:34:10.600Z","comments":true,"path":"2012/08/19/SAGeneral/","link":"","permalink":"http://www.kikitamap.com/2012/08/19/SAGeneral/","excerpt":"","text":"空间分析扩展模块中提供了很多方便栅格处理的工具，其中提取（Extraction）、综合（Generalization）等工具集中提供的功能是在分析处理数据中经常会用到的。 一、提取（Extraction）顾名思义，这组工具就是方便我们将栅格数据按照某种条件来筛选提取。 工具集中提供了如下工具： Extract by Attribute：按属性提取，按照SQL表达式筛选像元值。 Extract by Circle：按圆形提取，定义圆心和半径，按圆形提取栅格。 Extract by Mask：按掩膜提取，按指定的栅格数据或者矢量数据的形状的提取像元。 Extract by Point：按点提取，按给定坐标值列表进行提取。 Extract by Polygon：按多边形提取，按给定坐标序列作为节点的多边形进行提取。 Extract by Rectangle：按矩形提取，按给定的图层的Extent，或者定义了四至的矩形进行提取。 Extract Value to Point ：按照点要素的位置提取对应的（一个/多个）栅格数据的像元值，其中，提取的Value可以使用像元中心值或者选择进行双线性插值提取。 Extract Multi Value to Point：同上，只是提取多个栅格的像元值。 Sample：采样，根据给定的栅格或者矢量数据的位置提取像元值，采样方法可选：最邻近分配法（Nearest）、双线性插值法（Bilinear）、三次卷积插值法（Cubic）。 以上工具用来提取栅格中的有效值、兴趣区域\\点等很有用的。 二、综合（Generalization）这组工具主要用来清理栅格数据，可以大致分为三个方面的功能：更改数据的分辨率、对区域进行概化、对区域边缘进行平滑。 这些工具的输入都要求为整型栅格。 1. 更改数据分辨率： Aggregate： 聚合，生成降低分辨率的栅格。 其中，Cell Factor需要是一个大于1的整数，表示生成栅格的像元大小是原来的几倍。 生成新栅格的像元值可选：新的大像元所覆盖的输入像元的总和值、最小值、最大值、平均值、中间值。 效果如下，Cell factor设置为 6： ==&gt; 2. 对区域进行概化： Expand：扩展，按指定的像元数目扩展指定的栅格区域。 ==&gt; Shrink： 收缩，按指定像元数目收缩所选区域，方法是用邻域中出现最频繁的像元值替换该区域的值。同Expand。 Nibble：用最邻近点的值替换掩膜范围内的栅格像元的值。 Thin：细化，通过减少表示要素宽度的像元数来对栅格化的线状对象进行细化。 Region Group：区域合并，记录输出中每个像元所属的连接区域的标识。每个区域都将被分配给唯一编号。 工作原理：扫描的第一个区域接收值 1，第二个区域接收值 2，依此类推，直到所有区域都已赋值。扫描将按从左至右、从上至下的顺序进行。被赋予输出区域的值取决于系统在扫描过程中是在什么时候遇到它们的。 其中，添加链接选项为“真”时。这将在输出栅格的属性表中创建名为 LINK 的项，其保留输入栅格的每个像元的原始值。 如下图，原始数据具有相同值的区域有的并不连通，这时会新生成很多Region： ==&gt; 3. 对区域边缘进行平滑： Boundary Clean：边界清理，通过扩展和收缩来平滑区域间的边界。该工具会去更改X或Y方向上所有少于三个像元的位置。 Majority Filter：众数滤波，根据相邻像元数据值的众数替换栅格中的像元。可以认为是“少数服从多数”，太突兀的像元被周围的大部队干掉了。其中“大部队”的参数可设置，相邻像元可以4邻域或者8邻域，众数可选，需要大部分（3/4、5/8）还是过半数即可。 TIPS： 这两个工具仅支持整形栅格输入。 看如下示例，清理后，还是有明显变化的，细碎像元已经被处理掉了。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Analyst","slug":"Spatial-Analyst","permalink":"http://www.kikitamap.com/tags/Spatial-Analyst/"}]},{"title":"空间分析之距离分析","slug":"SADistance","date":"2012-08-10T05:08:00.000Z","updated":"2016-03-20T05:33:13.476Z","comments":true,"path":"2012/08/10/SADistance/","link":"","permalink":"http://www.kikitamap.com/2012/08/10/SADistance/","excerpt":"","text":"继续总结下距离分析。如下是ArcGIS 10.x中，距离分析相关的工具： ArcGIS中，主要可以通过如下的几种方式进行距离分析： 1） 欧氏距离分析 2） 成本加权距离分析 3） 用于垂直移动限制和水平移动限制的成本加权距离分析 4） 获取最短路径 使用ArcGIS空间分析扩展实现距离分析，最主要的是欧氏距离分析和成本加权距离分析两类工具。 一、欧氏距离工具欧氏距离工具测量每个像元距离最近源的直线距离（像元中心至像元中心的距离）。 欧氏距离（Euclidean Diatance）—— 求得每个像元至最近源的距离。 欧氏方向（Euclidean Direction）—— 求得每个像元至最近源的方向。 欧氏分配（Euclidean Allocation）—— 求得每个像元的最近的源。 TIPS： 1.源（Source） 可以是感兴趣的地物的位置，数据方面，既可以是栅格数据，也可以是矢量数据。但注意：如果数据选用了栅格数据，数据中必须仅包含表示源的像元，其他像元需要是Nodata。如果选用矢量，在执行工具之时，内部会将其先转成栅格。 2.欧氏距离的算法 简单理解为：工具会求得每个像元至每个源的距离，然后取得每个像元至每个源的最短距离以输出。其中，欧氏距离是像元中心与源像元的中心的直线距离。 如果像元与两个或更多源之间的距离相等，则计算都基于像元扫描过程中遇到的第一个源。无法控制该扫描过程。 帮助中有这样的描述： 工具在实际执行的过程中，进行两次顺序扫描。这样，工具的执行速度与源像元的数目、分布以及最大距离无关。影响工具执行速度的唯一因素是栅格的大小。计算时间与“分析”窗口中的像元数成线性比例。暂且不知道进行了什么样的两次顺序扫描。 3.欧氏距离输出栅格结果 投影平面上，像元与最近源之间的最短直线距离。如下图： 4.欧氏方向输出栅格结果 像元与最近源之间的方位角方向（以度为单位）。使用 360 度圆，刻度 360 指北，90指东，从刻度 1 顺时针增加。值 0 供源像元使用。如下图： 5.欧氏分配输出栅格结果 输出的每个像元都是距其最近源的值。如下图： 二、成本加权距离工具成本加权距离工具可以看成是对欧氏直线距离的进一步修改，将经过某个像元的距离赋以成本因素。举个简单的例子，翻过一座山到达目的地是最短的直线距离，绕行这座山距离较长，但是更节省时间和体力，那就后者的成本加权距离最短了。 1）成本距离（Cost Distance）：求得每个像元至最近源的成本距离。2）成本回溯链接（Cost back link）：求的一个方向栅格，可以从任意像元沿最小成本路径返回最近源。3）成本分配（Cost Allocation）：求得每个像元的最近的源。4）成本路径（Cost Patch）：求的任意像元到最近源的最小成本路径。 TIPS： 成本栅格可以是整形或者浮点型，但是其值中不能含有负值或者0。成本栅格中的Nodata视为障碍。 成本距离输出栅格数据这里的简单示例中，下面一层黑白渲染的是成本栅格，颜色深的像元代表成本比较高，反之较低。结果如下： 成本距离回溯链接要注意的是，它并不会求的要返回哪一个源像元以及如何返回。而是记录从任意像元回溯到最近源的路径上，每个像元向下一个像元指向的方向，这个方向以0-8的代码形式记录。如下图： 成本距离分配这个类似于前面的欧氏距离分配，得到的是每个像元至最近源的成本距离。 三、路径距离工具路径距离工具与成本距离相似，也可以确定从某个源到栅格上各像元位置的最小累积行程成本。但是，路径距离不仅可计算成本表面的累积成本，而且会考虑到行驶的实际曲面距离，和影响到移动总成本的水平和垂直因子。主要包含这几个工具 1）路径距离（Path Distance）2）路径回溯链接（Path back link）3）路径分配（Path Allocation） 这些工具生成的累积成本表面可用于扩散模型、流动和最低成本路径分析。 有关水平方向以及竖直方向的因子是如何影响的，工作原理是什么，ArcGIS帮助中有详细的解释： http://resources.arcgis.com/en/help/main/10.1/#/How_the_horizontal_and_vertical_factors_affect_path_distance/009z000000z9000000/ 四、 获得最短路径1.成本距离路径 任意像元到最近源的最小成本路径，需要引用到上面工具中生成的成本距离和成本回溯链接栅格数据。如下图： 2.廊道 另外要说的是廊道分析工具（Corridor）。此工具用于计算两个成本栅格的累积成本栅格结果，为了求得从一个源到另一个源且经过该像元位置的最小成本路径。 输出栅格不是单个最小成本路径，但会得到源之间累积成本的范围。 最后我们可以配合其他工具将小于某一阈值的结果提取出来，例如工具Extract by Attribute提取，或者通过Con进行条件赋值等等方法，获取结果。 如下如所示： 学校A、B成本距离分析结果： 学校C、D、E的成本距离分析结果： 有此两个距离成本结果，来分析得到A、B到C、D、E之间的廊道，也就是两组源之间的最小累积成本距离。 然后结果中我们可以按照一定的阈值来提取结果。例如累积成本在75以下的我才能接受： 至此，空间分析中的距离分析工具总结结束。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Analyst","slug":"Spatial-Analyst","permalink":"http://www.kikitamap.com/tags/Spatial-Analyst/"}]},{"title":"空间分析之密度分析","slug":"SADensity","date":"2012-08-06T09:13:00.000Z","updated":"2016-03-20T05:28:19.955Z","comments":true,"path":"2012/08/06/SADensity/","link":"","permalink":"http://www.kikitamap.com/2012/08/06/SADensity/","excerpt":"","text":"一、WHY DENSITY ？通过密度分析，我们可以讲测量的来的点或者线生成连续表面，从而可以找出那些地方点或者线比较集中。也就是，密度分析是根据输入要素数据计算整个区域的数据聚集状况。 密度分析是通过离散点数据或者线数据进行内插的过程，根据插值原理不同，主要是分为核密度分析和普通的点\\线密度分析。核密度分心中，落入搜索区的点具有不同的权重，靠近搜索中心的点或线会被赋予较大的权重，反之，权重较小，它的计算结果分布较平滑。在普通的点\\线密度分析中，落在搜索区域内的点或线有相同的权重，先对其求和，再除以搜索区域的大小，从而得到每个点的密度值。 二、HOWTO DENSITY ？ArcGIS 的空间分析工具箱中提供了密度分析工具集中的三个工具： 1. Kernel Density（核密度分析） 输入值可以是点或者线。 工作原理引自帮助： 概念上，每个点/线上方均覆盖着一个平滑曲面。在点/线所在位置处表面值最高，随着与点的距离的增大表面值逐渐减小，在与点/线的距离等于搜索半径的位置处表面值为零。仅允许使用圆形邻域。曲面与下方的平面所围成的空间的体积等于此点的 Population 字段值，如果将此字段值指定为 NONE 则体积为 1。每个输出栅格像元的密度均为叠加在栅格像元中心的所有核表面的值之和。核函数以 Silverman 的著作（1986 年版，第 76 页，方程 4.5）中描述的二次核函数为基础。 对于点，如果 population 字段设置使用的是除 NONE 之外的值，则每项的值用于确定点被计数的次数。例如，值 3 会导致点被算作三个点。值可以为整型也可以为浮点型。 对于线，如果 population 字段使用的是除 NONE 之外的值，则线的长度将由线的实际长度乘以此线的 population 字段的值而得出。 2. Point Density / Line Density（点、线密度分析）： 这两个工具的输出与核密度工具的输出的区别在于： 对于点密度和线密度，需要指定一个邻域，以便计算出各输出像元周围像元的密度。而核密度则可将各点的已知总体数量从点位置开始向四周分散。在核密度中，在各点周围生成表面所依据的二次公式可为表面中心（点位置）赋予最高值，并在搜索半径距离范围内减少到零。对于各输出像元，将计算各分散表面的累计交汇点总数。 1）点密度分析 每个栅格像元中心的周围都定义了一个邻域（邻域可以使用圆形、矩形、环形、楔形的形状来定义），将邻域内点的数量相加，然后除以邻域面积，即得到点要素的密度。如果 Population 字段设置使用的是 NONE 之外的值，则每项的值用于确定点被计数的次数。例如，值为 3 的项会导致点被算作三个点。值可以为整型也可以为浮点型。 2）线密度分析 使用搜索半径以各个栅格像元中心为圆心绘制一个圆。每条线上落入该圆内的部分的长度与 Population 字段值相乘。对这些数值进行求和，然后将所得的总和除以圆面积。 上图中显示的是栅格像元与其圆形邻域。线 L1 和 L2 表示各条线上落入圆内部分的长度。相应的 population 字段值分别为 V1 和 V2。因此： Density = ((L1 V1) + (L2 V2)) / (area_of_circle) 如果 population 字段使用的是除 NONE 之外的值，则线的长度将等于线的实际长度乘以其 population 字段的值。 详情参见：http://help.arcgis.com/zh-cn/arcgisdesktop/10.0/help/index.html#/na/009z0000000w000000/","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"},{"name":"Spatial Analyst","slug":"Spatial-Analyst","permalink":"http://www.kikitamap.com/tags/Spatial-Analyst/"}]},{"title":"关于高斯克吕格平面直角坐标系","slug":"AboutGaussKruger","date":"2012-06-01T08:43:00.000Z","updated":"2016-03-21T07:27:42.567Z","comments":true,"path":"2012/06/01/AboutGaussKruger/","link":"","permalink":"http://www.kikitamap.com/2012/06/01/AboutGaussKruger/","excerpt":"","text":"高斯克吕格平面直角坐标系是投影坐标系的一种，根据我国的地理情况，为建立地形图的测量控制和城市、矿山等区域性的测量控制，早在1952年决定，采用高斯克吕格平面直角坐标系。 投影面的形成：椭球面是不可展曲面，无论如何选择投影函数，椭球面上的元素，投影到平面上，都会产生变形（角度、长度、面积）。高斯投影是一种等角投影（正形投影），又称为横轴椭圆柱等角投影。想象用一个椭球柱面横套在椭球外面，并与某一条子午线相切，椭球的柱的中心轴通过椭球中心，然后用一定的投影方法将中央子午线两侧各一定经差范围内的地区投影到椭圆柱面上，再将此柱展开即成为投影面。 坐标系的定义：在投影面上，中央经线和赤道的投影都是直线，并且以中央经线和赤道的交点作为坐标原点，以中央经线的投影为纵坐标，以赤道的投影为横坐标，这就形成了高斯平面直角坐标系。 分带投影：高斯投影对投影函数的选择条件： 1）椭球面上的任意角度投影到平面后保持不变； 2）作为平面坐标轴的中央经线，投影后是一条直线，并且是投影点的对称轴； 3）中央子午线投影到平面后，其长度不变。 为了限制长度变形，就需要将投影区限定在中央经线两旁的狭窄范围内。 通常按经线每隔6°进行分带投影。由0°经线起每隔经差6°自西向东分带，依次编号1、2、3……。6°带的带号N和中央经线L的关系为：L=6N-3。 为了进一步限制变形，可以采用3°投影分带。3°带和6°带的中央经线重合，6°带的中央经线和分带经线均是3°带的中央经线。3°带的带号n和中央经线L的关系为：L=3n。 我国3°带的范围 24~45，6°带的范围 13~23。 x值无论在哪一带都是由赤道起算的自然值。 而由于中央经线以东取正号，以西取负号。实际工作中，为了避免横坐标y出现负值，规定在y值上500km（false easting）。同时，为了区别各带坐标不同，又规定在y值前冠以带号。 例如：6°带第20带中，y=-200.25m，成果表中应写为20499799.75m。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Coordinate System","slug":"Coordinate-System","permalink":"http://www.kikitamap.com/tags/Coordinate-System/"}]},{"title":"控制测量的基本概念总结","slug":"SurveyBasic","date":"2012-06-01T06:52:00.000Z","updated":"2016-03-21T07:27:28.094Z","comments":true,"path":"2012/06/01/SurveyBasic/","link":"","permalink":"http://www.kikitamap.com/2012/06/01/SurveyBasic/","excerpt":"","text":"铅垂线： 地球自转的离心力和地心引力，它们的合力称为重力，重力的方向即为铅垂线方向。 大地水准面： 我们设想一个只受重力作用，无潮汐风浪影响，完全处在静止和平衡状态的海水面扩展并延伸到大陆下面，从而形成一个与铅垂线方向正交的包围整个地球的封闭曲面。 注意：大地水准面是一个略有起伏的不规则的曲面，由于地表起伏以及地层内部密度变化造成质量分布不均，无法用数学公式把他精确的表达出来，也就不知道大地水准面的形状。故大地水准面不能作为控制测量计算的基准面。 地球椭球： 地球的形状近似于一个两级略扁的旋转椭球，因此世界各国都采用旋转椭球代表地球。它的形状大小与椭球的长短半轴a、b有关系。 习惯上，使用长半轴 a 和扁率 f=（a-b）/a，来表示椭球的形状和大小。 椭球定位： 将地球椭球面与大地水准面的相关位置确定下来的的工作就是椭球定位。这样就能将以大地水准面为基准面的野外测量成果换算到这个表面上，在它上面计算坐标。 参考椭球： 我们把形状和大小与大地体相近，且两者之间相对位置确定的旋转椭球称为地球椭球。参考椭球面是测量计算的基准面，椭球面的法线则是测量计算的基准线。 PS：世界各国总是根据本国的地面测量成果选择一个适合本国情况的参考椭球，所以参考椭球有很多个。 大地坐标系： 大地坐标系是在椭球面上建立起来的一种表示地面点位的球面坐标系。（大地经度L，大地维度B，大地高H） 高斯平面直角坐标系： 它是投影坐标系的一种，根据我国的地理情况，为建立地形图的测量控制和城市、矿山等区域性的测量控制，早在1952年决定，采用高斯克吕格平面直角坐标系。 椭球面是不可展曲面，无论如何选择投影函数，椭球面上的元素，投影到平面上，都会产生变形（角度、长度、面积）。高斯投影是一种等角投影（正形投影），又称为横轴椭圆柱等角投影。想象用一个椭球柱面横套在椭球外面，并与某一条子午线相切，椭球的柱的中心轴通过椭球中心，然后用一定的投影方法将中央子午线两侧各一定经差范围内的地区投影到椭圆柱面上，再将此柱展开即成为投影面。 在投影面上，中央经线和赤道的投影都是直线，并且以中央经线和赤道的交点作为坐标原点，以中央经线的投影为纵坐标，以赤道的投影为横坐标，这就形成了高斯平面直角坐标系。 摘录出自《控制测量学》","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Coordinate System","slug":"Coordinate-System","permalink":"http://www.kikitamap.com/tags/Coordinate-System/"}]},{"title":"中国UTM分区","slug":"ChineseUTMZone","date":"2012-05-23T03:07:00.000Z","updated":"2016-03-21T07:23:07.681Z","comments":true,"path":"2012/05/23/ChineseUTMZone/","link":"","permalink":"http://www.kikitamap.com/2012/05/23/ChineseUTMZone/","excerpt":"","text":"其实UTM和高斯-克吕格投影投影仅仅相差一个参数。高斯-克吕格投影是“等角横切圆柱投影”，投影后中央经线保持长度不变，即比例系数为1；UTM投影是“等角横轴割圆柱投影”，圆柱割地球于南纬80度、北纬84度两条等高圈，投影后两条割线上没有变形，中央经线上长度比0.9996。从计算结果看，两者主要差别在比例因子上，高斯-克吕格投影中央经线上的比例系数为1， UTM投影为0.9996。 高斯-克吕格投影自0度子午线起每隔经差6度自西向东分带，第1带的中央经度为3°；UTM投影自西经180°起每隔经差6度自西向东分带，第1带的中央经度为-177°，因此高斯-克吕格投影的第1带是UTM的第31带。此外，两投影的东伪偏移都是500公里，高斯-克吕格投影北伪偏移为零，UTM北半球投影北伪偏移为零，南半球则为10000公里。 带号 中央经线 经度范围 43 75E 72E-78E 44 81E 78E-84E 45 87E 84E-90E 46 93E 90E-96E 47 99E 96E-102E 48 105E 102E-108E 49 111E 108E-114E 50 117E 114E-120E 51 123E 120E-126E 52 129E 126E-132E 53 135E 132E-138E 补充，方便直观理解，看看中国境内的重要经纬线：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Coordinate System","slug":"Coordinate-System","permalink":"http://www.kikitamap.com/tags/Coordinate-System/"}]},{"title":"ArcPad 10 使用与同步 ArcGIS Server 的数据全攻略（二）","slug":"ArcPad10Synchronization1","date":"2012-04-10T01:16:00.000Z","updated":"2016-03-20T05:15:17.144Z","comments":true,"path":"2012/04/10/ArcPad10Synchronization1/","link":"","permalink":"http://www.kikitamap.com/2012/04/10/ArcPad10Synchronization1/","excerpt":"","text":"继续上个话题，数据准备好了，我们就开始发布服务吧~ 三、发布 ArcGIS Server 服务在进行到这一步的时候，我遇到过很多问题，有配置的问题，有数据的问题，有自己不够仔细的问题。这里总结下注意事项，帮助大家少走弯路。 TIPS：首先，ArcGIS Server服务器要安装ArcPad扩展，这个扩展在ArcPad安装光盘中有。ArcGIS Desktop 与 ArcPad 版本一定要对应：ArcPad 10.0对应ArcGIS Desktop、ArcGIS Server 10.0（.NET）; ArcPad 8.0对应ArcGIS Desktop、ArcGIS Server 9.3.1（.NET）。必须使用 ArcGIS Server for .NET Framework ，不支持 Java，许可级别必须是 Advanced版。将前面制作的MXD以及通过上一步方法得到的同名apo放置到C盘根目录文件夹下，例如C:/MXD。数据尽量使用ArcGIS Tutorial Data，以防止是数据本身问题导致服务发不成，以后调通了，再用自己的数据。发布服务，在你的GIS服务器连接上，右键 Add new Services。而不要直接在你的mxd上右键发布服务。 好，记住了这些，就开始发布服务吧，步骤和以前发布服务的方法几乎没有差异，GO ON…… 添加服务： 注意这一步要勾选 ArcPad，使得发布的 Map Service 可以被ArcPad所支持： 后面几步可以保持默认…… 最后发布成功。 四、Arcpad 加载 ArcGIS Server 服务并使用数据保证移动设备网络与Server连通，可以使用Wifi、USB等等…… 在移动设备上打开ArcPad： 在添加数据下拉列表中，选择”Add Data from Server“ 类型选择 ArcGIS Server ArcPad Service，地址填写服务器地址，点击刷新按钮可以显示服务列表，注意服务器地址填写完整： 等待片刻，服务加载成功：","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"ArcPad","slug":"ArcPad","permalink":"http://www.kikitamap.com/tags/ArcPad/"}]},{"title":"ArcPad 10 使用与同步 ArcGIS Server 的数据全攻略（一）","slug":"ArcPad10Synchronization2","date":"2012-04-09T06:13:00.000Z","updated":"2016-03-20T05:12:51.148Z","comments":true,"path":"2012/04/09/ArcPad10Synchronization2/","link":"","permalink":"http://www.kikitamap.com/2012/04/09/ArcPad10Synchronization2/","excerpt":"","text":"在移动设备上，使用ArcPad可以创建、显示、查询、编辑数据。根据工作流模式的不同，我们可以采取不同的数据组织形式。 首先，先了解下ArcPad 支持哪些数据格式： ShapeFile； ArcPad AXF 文件： 这个文件使用了SQL Server 精简版数据引擎，所以在上一篇中说部署时，需要安装SQL Server Compact for Windows Mobile； ArcPad Graphics layer：用XML写的文件，可以储存 annotation, points, lines, and polygons； ArcPad Photo layer：用XML写的文件，用于存储引用的照片信息，需要和照片文件放置在同个文件夹中； ArcPad StreetMap 文件 Raster layers，具体支持以下格式: JPEG (*.jpg) JPEG 2000 (*.jp2) MrSID Generation Two, or MG2 (*.sid) MrSID Generation Three, or MG3 (*.sid) Portable Network Graphics, or PNG (*.png) Tagged Image File Format, or TIFF, including GeoTIFF (*.tif) Windows Bitmap (*.bmp) CADRG raster maps 如果想要进行“从0开始”的外业作业方式，可以在ArcPad 中创建快速工程（包含了点、线、面三个shapefile层）。 如果已有 shapefile 数据，只需将这些数据拷贝到移动设备中，在ArcPad添加数据时引用即可。这与ArcGIS Desktop是一致的。 如果已有本地Geodatabase数据，这时，也可以使用ArcPad数据管理工具条Check out数据，然后通过check in提交数据。 如果是企业级的应用，可以与ArcGIS Server 、ArcGIS Desktop 联合使用，使用ArcPad加载已发布的服务，并且进行版本编辑，同步服务器数据。 以上提到的四种应用的场景，前三种比较好理解，也易于操作。所以最后一种，作为本文的主要总结对象，网上ArcPad的资料相对较少，遂决定梳理一下这种情况下授权、管理、编辑数据的全过程，一共我会分两次与大家分享。 一、激活ArcPad Data Manager扩展必须先了解的是ArcPad Data Manger工具条。这个工具条是在PC上安装ArcPad时，自动安装的一个ArcGIS Desktop的扩展。 既然是扩展，当然首选需要激活，在ArcMap的菜单栏中，Custom – Extensions – 勾选 “ArcPad Data Manager”，如下图： 这一扩展包含了ArcPad Data Manager 与 ArcPad Tools两部分，分别位于工具条与ArcToolbox工具箱中。 二、为 ArcGIS Server 授权数据用于授权给ArcGIS Server的数据是有要求的，必须满足以下条件： （1）SDE GDB；（2）含有Global ID；（3）注册为版本。 点击 Author Project for ArcGIS Server”，进行数据授权。 选择需要签出的数据， 设置空间参考范围，以及生成ArcPad地图文档的名称， 设置完成后，会提示正确信息： 至此，ArcPad 数据的准备就完成了。 下一篇文章，会进入 ArcGIS Server with ArcPad Capability 的发布，ArcPad如何加载和使用ArcGIS Server 服务的主题。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"ArcPad","slug":"ArcPad","permalink":"http://www.kikitamap.com/tags/ArcPad/"}]},{"title":"ArcPad 10 的安装部署","slug":"ArcPad10Deployment","date":"2012-03-28T01:19:00.000Z","updated":"2016-03-20T05:00:17.174Z","comments":true,"path":"2012/03/28/ArcPad10Deployment/","link":"","permalink":"http://www.kikitamap.com/2012/03/28/ArcPad10Deployment/","excerpt":"","text":"ArcPad是安装在手持设备或者移动终端的一个外业ArcGIS产品，也就是说ArcPad是Esri的一款软件产品，而不是硬件设备哦。虽然不比ArcGIS Desktop功能复杂缤纷，但是对于野外作业、数据采集等工作来说，算是功能十分丰富了。 说到安装，首先要了解系统要求，http://resources.arcgis.com/zh-cn/content/arcpad/10.0/system-requirements。ArcPad 仅支持 Windows Mobile 移动平台（5.0以上），最高可使用Windows Mobile 6.5。 说明： 本文及后续有关ArcPad文章的截图说明的环境： ArcPad 10.0.2 （Build 30）； Windows Mobile 6.5 模拟器，下载地址 ； Windows Mobile 5.0 基于移动设备 Trimble Juno ST； Windows 7 。 在PC上安装ArcPad运行光盘，安装ArcPad。 页面中还有一项”ArcGIS Server ArcPad Extension“，此项可以先不安装，在用到添加ArcGIS Server 服务、同步数据时才会用的这一项。关于这一部分的功能、要求、应用等，以后抽时间整理一下。安装过程很简单不赘述。 安装过程中，提示填写注册码，可以忽略，那ArcPad就进入了评估模式，评估模式一切功能和正式版是相同的，只是使用时间为20分钟，超过20分钟ArcPad会自动退出。如果为了方便长时间使用，需要填写注册码。自己学习研究，就用这个吧：~@RCP@DD00R~。当然，商业用途和项目开发等要使用正式版的…… 安装完成后，开始菜单中会出现： 其中，第一项ArcPad 10 for Windows 是PC端的ArcPad程序，功能上与移动端ArcPad是一致的。 第二项 ArcPad Deployment Manager 就是用来向手持设备部署ArcPad的。 手持端 ArcPad 部署1.首先安装windows同步程序。 Windows XP： 安装 Microsoft ActiveSync ；Windows vista 或 Windows 7： 安装 Windows Mobile Device Center。 2.上述程序安装好后，连接移动设备和PC，保证连接状态正常。 3.打开 开始 — ArcGIS — ArcPad 10 — ArcPad Deployment Manager。 在这个窗口勾选需要安装的项即可： Arcpad for Windows Mobile 是必然需要安装的； 如果需要移动设备的“桌面快捷方式“，今日插件（Today-Plugin）可以选择安装； 如果需要 ArcPad 中文界面，可以勾选安装相应语言包； Samples，示例数据是初学者探索Arcpad 的学习资源，如果需要并且存储足够，推荐安装； 如果需要用到数据的check in 、check out，SQL Server Compact也需要安装了； 如果涉及到一些脚本的应用 VBScript Runtime也需要安装； 剩下两个没说到的，Streetmap 和 Datum 的，不需要安装，不适宜国内用户的需求。 做好选择之后，点击”Deploy“，就开始了Arcpad的自动部署。当然过程中不要忘记响应移动设备的询问。 4.至此，Arcpad 安装完成。 在移动设备的 开始 – 程序 中，打开ArcPad： O了，可以开始使用ArcPad了。 学习资源主要还是ArcPad 官方帮助，在线帮助：http://help.arcgis.com/en/arcpad/10.0/help/index.html。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"ArcPad","slug":"ArcPad","permalink":"http://www.kikitamap.com/tags/ArcPad/"}]},{"title":"ArcMap中将地图导出至PDF","slug":"ArcMapExportPDF","date":"2012-02-28T07:35:00.000Z","updated":"2016-03-20T04:53:19.921Z","comments":true,"path":"2012/02/28/ArcMapExportPDF/","link":"","permalink":"http://www.kikitamap.com/2012/02/28/ArcMapExportPDF/","excerpt":"","text":"在使用ArcMap导出地图时，ArcGIS提供了很多种格式，其中，由于PDF方便存档、共享、查询等，就成为了不少用户喜爱的格式。在这里一起学习总结下有关地图导出成PDF的知识和设置~ ArcMap的【文件】下的【导出地图…】，选择PDF格式后，我们可以对导出PDF进行设置。 常规设置： 分辨率：此参数用于设置输出图像的DPI（Dots Per Inch / 每英寸的点数）。这个值越高，图像就会越清楚，当然文档的大小和处理的时间也会随之增加。 输出图像质量：此控件是用来打印导出地图时对栅格进行重采样的。对于带有栅格数据和透明矢量图层的地图，调整此值有显著效果，可以缩减处理时间和文档大小。 格式： 目标颜色空间：控制在输出文件中指定颜色的颜色空间。RGB 是默认颜色空间，通常用于屏幕显示、喷墨打印机、激光打印机打印。CMYK 模式用于商业性印刷生产。 压缩向量图形：导出压缩的文件。此选项仅对矢量部分和文字进行压缩。对于影像的压缩需要采用下面的选项。 图像压缩：选择一种压缩方案。选项提供了：无（None）、RLE、LZW、压缩（Deflate）、JPEG、自适应（Adaptive）。此选项对于PDF文件，仅会对文件中的影像和栅格数据进行处理。自适应（Adaptive）模式可生成最小的文件，但也会在输出图像上产生压缩伪影。要获得对于 PDF 中栅格图像的无损压缩，可使用压缩（Deflate）模式。 JPEG质量：这个比较好理解，对于JPEG，质量越高，地图月清晰，文件也会越大。 图片符号：此选项用于指定图片标记符号（BMP、EMF）和图片填充符号是否转换为矢量或栅格化。 将标记符号转换为面：此选项是将基于字符的标记符号转为面。在某些符号字体不可用或者无法被嵌入的情况下，可以勾选此选项，用来保证正确显示。但是，需要了解，此选项勾选后，会对所有基于字符的标记符号禁用字体嵌入，这就可能导致符号外观发生变化。 嵌入所有文档字体：此选项勾选后，可将文档本身内部使用的字体都嵌入到文档内部。这样的好处就是，导出的PDF文件，即使在没有安装文档中字体的机器上，也能正常打开。这个还是很常用，建议一直勾选。但是还是提醒下：某些字体不支持嵌入，即使选中此选项也不会嵌入。 高级： 除了用作地图的交换格式之外，从 ArcMap 导出的 PDF 文件还具有其他高级功能。PDF 文件可以包含来自 ArcMap 内容列表（TOC）中的图层，这样就可以在PDF文档中开启和禁用图层的可见性；还可以包含要素的属性以及每个地图数据框的地理配准信息。在 Adobe Reader 或 Adobe Acrobat 中查看 PDF 文档的任何用户都可以使用 Acrobat Analysis 工具检查要素属性并查找和识别地理坐标。 图层和属性： 通过设置此选项，ArcMap 导出的 PDF 中可以包含图层，用户可在 Adobe Acrobat 和 Reader 6.0 及其更高版本中控制这些图层的可见性。 凭借 Adobe Acrobat 和 Adobe Reader 的内置功能，从 ArcGIS 导出的 PDF 文件可以包含要素属性表中的要素属性。在要素属性表中字段的可见性确定了在生成的 PDF 中将导出哪些字段。我们可在 Adobe Acrobat 和 Adobe Reader 中通过对象数据工具访问这些属性。 导出地理配准信息： Adobe Acrobat 和 Adobe Reader 9 以上版本可以查看 PDF 文件内部编码的地图坐标和地理配准信息。在启用导出地图地理配准信息选项的情况下导出地图，将记录 PDF 内部每个数据框的地理配准信息。在兼容的查看器（如 Adobe Reader 9）中打开地理配准的 PDF 时，用户可以访问地理空间功能（如坐标值读数和查找 x,y）。 另外，导出PDF还支持数据驱动页面以及导出后加密。数据驱动以后会专门再总结一篇。 加密PDF： 可以使用简单的 arcpy.mapping 脚本来加密 PDF 文档和并为其设置密码保护，如下示例： 1234pdfDoc = arcpy.mapping.PDFDocumentOpen(r\"C:\\Project.pdf\")pdfDoc.updateDocSecurity(\"secret\", \"secret\")pdfDoc.saveAndClose()del pdfDoc 步骤：将地图导出成PDF之后，记下文件位置，替换第一行的路径；设置密码，代替示例密码“secret”；将脚本复制进Python窗口，运行即可。 以上就是地图导出成PDF时，全部设置的总结啦 ~","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Mapping","slug":"Mapping","permalink":"http://www.kikitamap.com/tags/Mapping/"}]},{"title":"解决Godaddy邮箱无法收信的问题","slug":"GodaddyEmailFailure","date":"2012-02-17T08:46:00.000Z","updated":"2016-03-20T04:48:37.220Z","comments":true,"path":"2012/02/17/GodaddyEmailFailure/","link":"","permalink":"http://www.kikitamap.com/2012/02/17/GodaddyEmailFailure/","excerpt":"","text":"Godaddy上面有附送免费的邮箱，每申请一个域名，都可以获得赠送一个1G的邮箱，同时空间的话可以获得5个邮箱。这些邮箱可以按照我们自己的意愿来设置域名后缀，这对中小型的外贸企业来说是个不错的选择。尤其是中国大部分的邮件服务器垃圾邮件成灾的时候！ 我们使用Godaddy附送的邮箱可以尽可能的避免我们的邮件被归类到垃圾邮件！（虽然Godaddy的免费邮箱速度不快，面板也不是太方便。但是结合foxmail可以很好的使用！） 上次在设置Godaddy邮箱的时候遇到了邮箱可以发送邮件，但是无法收邮件的问题，下面是解决方法，希望可以帮到大家！ Godaddy域名附赠邮箱能发送邮件但无法接收邮件解决方法如下： 1.登录你的Godaddy帐号. 2.点击 My Account. 3.点击左侧栏中的 Free Products 4.在右侧栏中的Products列表点击 Email Account List. 5.在出现的邮件管理页面中选择Free email addresses for yourdomain.com(yourdomain.com是你的域名)，然后点击右边的 Manage Account. 6.选择 Domains 标签 7.选择你要修正MX记录的邮件帐号，然后点击Server Addresses. 8.点击 Update my MX records for me 让系统自动帮你修正MX记录 到此问题就解决了！出处：http://ltl3884.iteye.com/blog/1276793","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"}]},{"title":"Point to Raster 工作原理","slug":"HowPointtoRasterWorks","date":"2012-02-08T00:58:00.000Z","updated":"2016-03-20T04:45:09.503Z","comments":true,"path":"2012/02/08/HowPointtoRasterWorks/","link":"","permalink":"http://www.kikitamap.com/2012/02/08/HowPointtoRasterWorks/","excerpt":"","text":"点在栅格中，表示为一个像元。通常，如果有两个或更多个点落入某像元范围内，ArcGIS 在为像元赋值时会随机选择这些点中的一个点。但在使用“Point to Raster”工具时，可选择像元值分配类型（频率最高、求和、平均值、标准差、最大值、最小值、范围、数目）。具有值的像元数有可能少于要转换的点数。 工具说明： A．可以将包含点或多点要素的任意要素类（地理数据库、shapefile 或 coverage）转换为栅格数据集。 B．输入字段类型决定输出栅格的类型。如果字段是整型，则输出栅格也是整型；如果字段是浮点型，则输出栅格也是浮点型。 C．如果输入字段包含字符串值，则输出栅格将包含一个整数值字段和一个字符串字段。 D．Priority Field仅与像元分配类型的 MOST_FREQUENT 选项一起使用。如果一个像元中存在多个点，优先级高的值被采用，如果优先级相同的，属性值出现频率最高的被采用，如果优先级和出现频率全都相同，采取FID最小的。如下图情况所示： 若要素位于单元边界，则遵循边界规则。 下图举例说明了要素恰巧落在单元边界上时适用的规则。 如果要素落在单元边界上，则使用它上面的单元；如果它上面没有单元，则使用下面的单元。 如果左侧有一个单元，则使用此单元；如果没有，则使用右侧的单元。 与之相应的，还有一个Raster to Point 工具。 工具说明： A. 允许输入整形或者浮点型的栅格数据；输入栅格的栅格单元大小可以任意，并且可以属于任何有效的栅格数据集。 B. 针对输入栅格数据集的每个栅格单元，都会在输出要素类中创建一个点。这些点将定位于它们所代表的栅格单元的中心。NoData 栅格单元不会转换为点。 C. Field参数可选，来设置栅格数据的某个字段转换为生成点要素的属性字段。此字段可以是整型、浮点型、字符型。如果不选，默认使用Value字段。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Raster","slug":"Raster","permalink":"http://www.kikitamap.com/tags/Raster/"},{"name":"Geoprocessing","slug":"Geoprocessing","permalink":"http://www.kikitamap.com/tags/Geoprocessing/"}]},{"title":"ArcGIS for AutoCAD 小结","slug":"ArcGISforAutoCAD","date":"2012-02-07T06:42:00.000Z","updated":"2016-03-20T04:42:04.874Z","comments":true,"path":"2012/02/07/ArcGISforAutoCAD/","link":"","permalink":"http://www.kikitamap.com/2012/02/07/ArcGISforAutoCAD/","excerpt":"","text":"一、 简介 ArcGIS for AutoCAD是Esri提供的一个针对AutoCAD免费插件。此插件可以使AutoCAD作为ArcGIS Server的客户端加载服务；并且可以作为GIS结构编辑器来组织CAD数据，从而作为直接可用的GIS 要素类；给CAD数据定义坐标系，可以被ArcGIS产品识别。 二、 系统要求 这里基于ArcGIS for AutoCAD 250版本。 | 版本 | AutoCAD 2010/2011, 32-bit or 64-bit || AutoCAD Map 3D 2010/2011, 32-bit or 64-bit || AutoCAD Civil 3D 2010/2011, 32-bit or 64-bit|| 操作系统| Windows 7 Enterprise, Ultimate, Professional, or Home Premium|| Windows Vista Enterprise, Business, Ultimate, or Home Premium (SP1 or later) || Windows XP Professional or Home edition (SP3)|| Microsoft .NET Framework | Microsoft .NET Framework Version 3.5 (SP1 or later) || Internet 方式连接ArcGIS Server | ArcGIS Server 9.3 或更高版本发布服务 | 三、 安装与加载 下面以AutoCAD 2010（x64），ArcGIS for AutoCAD 250（x64）为例，介绍一下此插件的安装使用过程。 1. 获取并安装插件 插件的下载地址：http://support.esrichina-bj.cn/2011/0224/963.html 注意此插件区分32bit与64bit，选择合适版本下载，我这里使用ArcGISforAutoCADDownloadx64.exe。 在已经安装AutoCAD的前提下，双击运行此exe即可。 2. 插件的加载 以管理员身份运行AutoCAD，在AutoCAD的命令提示行中输入：NETLOAD。出现资源管理器窗口，浏览至插件的安装目录，选择 ArcGISForAutoCAD.dll打开。 之后出现插件加载画面。 加载ArcGIS for AutoCAD插件成功。 加载后，会多出ArcGIS for AutoCAD插件栏，如下图： 注意事项： 添加ArcGIS Online服务时，可能会遇到错误：“找不到资源：‘basemapui\\basemapcenter.xaml’”。 解决方法：这是个已知问题，下载补丁既可以解决此问题，地址：http://resources.arcgis.com/zh-cn/content/patches-and-service-packs?fa=listPatches&amp;PID=129 至此，ArcGIS for AutoCAD 插件即可以开始使用啦。 四、 功能与使用 1. Map Service 有了这个插件，首先可以使AutoCAD直接加载Map Service： (1) ArcGIS Online 使用Esri Map Gallery中的地图作为地图，添加到现有的CAD工程中。 (2) ArcGIS Server 向现有的CAD工程中添加ArcGIS Server服务。 2. CAD Feature Class 此插件可以将 AutoCAD 作为 GIS 方案编辑器，用来将 CAD 数据组织为可供 GIS 使用的要素类。 类型对象过滤器是预定义的，用来约束ArcGIS Desktop支持的feature class与DWG 对象的对应关系。 DWG 对象与ArcGIS 要素的强制对应关系如下： | Feature type | DWG object types || Point | Point, Insert, shape, Hatch, Proxy || Polyline | Arc, Circle, Ellipse, Line, Mline, polyline, 3D polyline Ray, spline, Xline, Trace, solid, 3Dface || Polygon | Circle, Solid, Ellipse, Face, closed polyline, closed 3D polyline, Mline || Annotation | Text, Mtext, Attribute, Attdef || Multipatch | Arc, Circle, Ellipse, Line, Mline, polyline, 3D polyline Ray, spline, Xline, Trace, solid, 3Dface | 3.坐标系统 插件使用的坐标系统是通过*.prj 文件来定义的。当给DWG文件定义坐标系后，这个有效的空间参考是可以被ArcGIS Server、ArcMap、ArcCatalog以及ArcGIS 地理处理工具识别的。 关于CAD与ArcGIS一体化的文章，后面会不断更新~","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"},{"name":"CAD","slug":"CAD","permalink":"http://www.kikitamap.com/tags/CAD/"}]},{"title":"ArcGIS的空间参考","slug":"ArcGISSpatialReference","date":"2012-02-07T06:31:00.000Z","updated":"2016-03-21T07:23:20.201Z","comments":true,"path":"2012/02/07/ArcGISSpatialReference/","link":"","permalink":"http://www.kikitamap.com/2012/02/07/ArcGISSpatialReference/","excerpt":"","text":"1．坐标系（CoordinateSystem） 主要提供了这个几种：地理坐标系或大地坐标系（GCS）、投影坐标系（PCS）、垂直坐标系（UCS）。坐标系在这先不多说，以后有时间自己整理下。 2．分辨率（Resolution）：x，y值的最小距离 分辨率值的单位与相关坐标系的单位相同。 默认分辨率值是 0.0001 米 (1/10 mm)，或者为其等效值（以地图单位表示）。 具有较小（较精细）的 x,y 分辨率的要素坐标可以具有更多的精度位数。但是，极小的 x,y分辨率可能会影响性能，因为使用了过多的磁盘空间以及更多的 I/O。 ESRI官方文档强烈建议，在大多数情况下使用默认的 x,y分辨率，因为默认分辨率性能非常好并且可以适用于大多数坐标精度。 3． 容差（Tolerance）： 容差值为坐标之间的最小距离。如果一个坐标在另一个坐标的容差值范围内，则会将二者视为同一位置。 默认容差是分辨率值的 10倍，大多数情况下推荐使用此设置。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Coordinate System","slug":"Coordinate-System","permalink":"http://www.kikitamap.com/tags/Coordinate-System/"}]},{"title":"ArcMap的Feature Cache","slug":"ArcMapFeatureCache","date":"2012-02-07T06:28:00.000Z","updated":"2016-03-20T04:13:38.844Z","comments":true,"path":"2012/02/07/ArcMapFeatureCache/","link":"","permalink":"http://www.kikitamap.com/2012/02/07/ArcMapFeatureCache/","excerpt":"","text":"一、介绍 使用地理数据库中存储的数据时，创建要素缓存可以加快ArcMap的执行速度。要素缓存可以将 ArcMap当前显示的要素临时存储到计算机的内存中。 Arcmap 中有提供了 Feature Cache 的工具，如下： 各个工具的作用如下： 值得注意的是这两个工具： 第一个，构建要素缓存工具是在当前地图范围内构建缓存。 第四个，设置自动缓存比例，也就是进行缓存的最小比例尺。注意ArcGIS自带帮助文档这里写得有误，不是最大比例尺。 第五个，显示要素缓存按钮，颜色会随缓存状态变化。绿色表示已缓存，红色表示未缓存。 二、设置自动缓存 自动缓存通常适用于，不确定缓存边界时，或者需要缓存一系列的地图时。开启自动缓存时，会自动的去缓存超出当前已缓存范围的地图。由于自动缓存可能影响性能（占大量内存），因此应当设置自动缓存最小比例。只有当地图比例大于最小比例时，才自动创建要素缓存。 使用上述工具条的，切换自动缓存按钮开启。 或者在数据框属性中开启，如下图： 三、性能提升 对于地理数据库数据，当数据源是 ArcSDE 地理数据库时，要素缓存的优势最为显著。 使用文件或个人地理数据库的要素缓存能够获得微小的性能提升。 在特定地图范围内进行操作时，要素缓存尤其有用。 要素缓存不适合：在较大区域跨度内频繁平移和缩放操作。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Performance","slug":"Performance","permalink":"http://www.kikitamap.com/tags/Performance/"}]},{"title":"Geodatabase之基础","slug":"GeodatabaseBasic","date":"2012-02-07T06:25:00.000Z","updated":"2016-03-20T03:58:03.352Z","comments":true,"path":"2012/02/07/GeodatabaseBasic/","link":"","permalink":"http://www.kikitamap.com/2012/02/07/GeodatabaseBasic/","excerpt":"","text":"Geodatabase是用来表达和管理地理信息的复杂数据模型，是ArcGIS的主要存储数据方式，主要存储了 featureclasses、 rasterdatasets、attributes、具有行为的高级GIS数据对象、 管理空间完整性的规则、要素栅格属性关系工具。 一、Geodatabase 的种类： 就其种类呢，无非是三种：File Geodatabase，PersonalGeodatabase，ArcSDEGeodatabase。 1、 FileGeodatabase：以文件夹形式存储。每个Dataset作为一个文件存储，最大可达1T。对于PGDB更推荐FGDB。单用户，同一个Dataset 、独立的featureclass或者table，并发只能有一人写操作，可以多人读操作。支持跨平台。 2、PersonalGeodatabase：所有的Dataset都存储在MicrosoftAccess数据文件中,最大大小不超过2 GB。单用户，一个人写多人读。仅支持Windows。 3、ArcSDEGeodatabase：储存在关系数据库中，可使用 Oracle,MicrosoftSQL Server, IBM DB2, IBM Informix,PostgreSQL。这些多用户的数据库要求使用ArcSDE，不限制大小和用户的数量。平台支持：Windows, UNIX,Linux。 二、Geodatabase中的Dateset Geodatabase 中包含基本的dataset，包括：feature classes、 rasterdatasets、attributes。还包含高级地理数据类型：coordinate systems, coordinateresolution, feature classes,topologies, networks, raster catalogs,relationships, domains。 1、Table 用于存储属性等。字段类型包含：Numbers（长整型、短整型、单精度、双精度）、Text、Date（日期时间型）、BLOBs（二进制大对象，例如Symbol、CAD几何要素）、GlobalID（全局标识符）、XML。 2、Feature Class Feature Class以一张单独的表存储，每个要素是一条记录。种类： Points、Lines、Polygons、Annotation、 Dimensions（尺寸）、MultiPoints（由多个点组成的要素，如雷达激光点）、MultiPatches（多面体）。 其中要素坐标可包含Z值，表示垂直测量结果；线状要素可以包含M值，表示线性测量结果。路径是指具有唯一标识符和通用测量系统的任意线状要素（如城市街道、公路、河流或管线）。 与FeatureClass相关的：FeatureDataset，subtype，AttributeDomain，RelationshipClasses，Topology，Network Dataset，Geometric network，TerrainDataset，Linear referencing，Cartographicrepresentation，versioning。 3、Raster 栅格的地理属性通常包括：坐标系，参考坐标或 X,Y 位置（通常在栅格左上角或左下角），单元大小，行计数和列计数。地理数据库可以针对多种用途管理栅格：作为单个数据集、数据集的逻辑集合和表中的图片属性.","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"有关shape文件的说明","slug":"Aboutshapefile","date":"2012-02-07T06:04:00.000Z","updated":"2016-03-20T03:56:02.673Z","comments":true,"path":"2012/02/07/Aboutshapefile/","link":"","permalink":"http://www.kikitamap.com/2012/02/07/Aboutshapefile/","excerpt":"","text":"shapefile 是存储地理信息的简单文件格式，但是工作中，常会接到用户的很多问题，这里把常见的汇总下。 一、shape 文件到底可以多大？ shapefile 的每个文件都不能超过 2 GB。也就是说，存储数据的 .dbf 与.shp 分别不能超过 2GB。但是，所有文件的总大小可以超过 2 GB。 二、 shape 文件是怎么构成的？ shape 文件用 ArcGIS 查看仅显示一个文件，但是用 windows 资源管理器查看就可能看到以下文件。 .shp - 存储要素几何的主文件；必需文件。 .shx - 存储要素几何索引的索引文件；必需文件。 .dbf - 存储要素属性信息的 dBASE 表；必需文件。 .prj - 存储坐标系信息的文件；由 ArcGIS 使用。 .xml - ArcGIS 的元数据 - 用于存储 shapefile 的相关信息。 .sbn 和 .sbx - 存储要素空间索引的文件。 .fbn 和 .fbx - 存储只读 shapefile 的要素空间索引的文件。 .ain 和 .aih - 存储某个表中或专题属性表中活动字段属性索引的文件。 .atx - .atx 文件针对各个 shapefile 或在 ArcCatalog 中创建的 dBASE属性索引而创建。 .ixs - 读/写 shapefile 的地理编码索引。 .mxs - 读/写 shapefile（ODB 格式）的地理编码索引。 .cpg - 可选文件，指定用于标识要使用的字符集的代码页。 强烈建议，对shape操作时，在 ArcGIS 中进行。 三、 shape 中创建字段注意什么？ 不能对现有字段修改，可以新建字段包括自定义数据类型；字段名长度不要超过10，超过会被截断。 新建字段时，有三个参数可供设置： precision（精度）—— 数字字段中可存储的位数； scale（标度）—— 浮点或双精度类型字段中数值的小数点右侧的位数； length（长度）—— 字符型字段的文本字段的长度。 注意，long integer 当精度超过 10 时，会自动转为 Double 型。 相关资料： 由于shape文件是公开数据格式，可以很好来作为交换格式，这里有个技术描述可供下载： shape文件技术描述","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]},{"title":"认识虚拟内存与分页文件","slug":"virtualmemory","date":"2012-02-07T06:00:00.000Z","updated":"2016-03-20T03:53:46.476Z","comments":true,"path":"2012/02/07/virtualmemory/","link":"","permalink":"http://www.kikitamap.com/2012/02/07/virtualmemory/","excerpt":"","text":"如果计算机缺少运行程序或操作所需的RAM，则 Windows 使用虚拟内存进行补偿。 查看RAM数量： 注意：某些情况下，Windows会报告计算机上安装的内存数量以及可以使用的内存数量。如果使用的是32位版本的Windows，则可用内存的数量可能低于安装的内存总量。 虚拟内存将计算机的RAM和硬盘上的临时空间组合在一起。当RAM运行速度缓慢时，虚拟内存将数据从RAM移动到称为分页文件的空间中。将数据移入与移出分页文件可以释放RAM，以便计算机可以完成工作。 一般而言，计算机的RAM越多，程序运行得越快。如果计算机的速度由于缺少RAM而降低，则可以尝试增加虚拟内存来进行补偿。但是，计算机从RAM读取数据的速度要比从硬盘读取数据的速度快得多，因此增加RAM是更好的方法。 分页文件：硬盘上一个或者多个隐藏文件 pagefile.sys，Windows用于存储未存入内存的部分程序和数据文件。页面文件和物理内存或随机存取内存（RAM）构成了虚拟内存。Windows会根据需要将数据从页面文件移至内存，或将数据从内存移至页面文件以便为新数据释放内存。也叫“交换文件”。 错误消息与自定义大小 如果收到警告虚拟内存不足的错误消息，则需要添加更多的RAM 或增加分页文件的大小，这样才能在计算机上运行程序。Windows 通常会自动管理大小，但是如果默认的大小不能满足您的需要，则可以手动更改虚拟内存的大小。 如何自定义虚拟内存的大小？ 如果您收到虚拟内存不足的警告，则您将需要增加&lt;分页文件的最小大小。Windows设置分页文件的初始最小大小等于您计算机上安装的随机存取内存(RAM)的数量加上300兆字节(MB)，最大大小是您计算机上安装的RAM 数量的3倍。如果您看到对这些建议级别的警告，则增加最小大小和最大大小。 单击打开我的电脑“属性”。 在左窗格中，单击“高级系统设置”。 在“高级”选项卡上，在“性能”下，单击“设置”。 单击“高级”选项卡，然后在“虚拟内存”下，单击“更改”。 清除“自动管理所有驱动器的分页文件大小”复选框。 在“驱动器[卷标]”下，单击要更改的分页文件所在的驱动器。 单击“自定义大小”，在“初始大小(MB)”或“最大大小(MB)”框中键入新的大小（以兆字节为单位），单击“设置”，然后单击“确定”。 注意：增加大小通常不需要重新启动更改就能生效，但是如果减小大小，则需要重新启动计算机更改才能生效。建议不要禁用或删除页面文件。 “任务管理器”内存列的含义 列 描述 PID（进程标识符） 唯一标识所运行进程的编号。 用户名 运行该进程的用户帐户。 会话标识 标识进程所有者的编号。当多个用户登录时，每个用户都有一个唯一的会话标识。 CPU使用率 自上次更新以来，进程使用CPU的时间百分比（列标题中列为“CPU”）。 CPU时间 进程自其启动以来使用的总处理时间（以秒为单位）。 内存-工作集 私人工作集中的内存数量与进程正在使用且可以由其他进程共享的内存数量的总和。 内存-高峰工作集 进程所使用的工作集内存的最大数量。 内存-工作集增量 进程所使用的工作集内存中的更改量。 内存-专用工作集 工作集的子集，它专门描述了某个进程正在使用且无法与其他进程共享的内存数量。 内存-提交大小 为某进程使用而保留的虚拟内存的数量。 内存-页面缓冲 由内核或驱动程序代表进程分配的可分页内核内存的数量。可分页内存是可写入其他存储媒体（例如硬盘）的内存。 内存-非页面缓冲池 由内核或驱动程序代表进程分配的不可分页的内核内存的数量。不可分页的内存是不能写入其他存储媒体的内存。 页面错误 自某进程启动后该进程生成的页面错误数。进程访问当前不在工作集的内存页面时会出现页面错误。某些页面错误要求从磁盘中检索页面内容；其他的页面错误可在不访问磁盘的情况下解决。 页面错误增量 自上次更新以来页面错误数量的变化。 基本优先级 优先排名，它确定了所计划进程的线程顺序。 句柄数 进程的对象表中的对象句柄数。 线程数 进程中运行的线程数。 USER对象 当前由进程使用的USER对象数。USER 对象是来自Window管理器的对象，它包含窗口、菜单、光标、图标、挂接、加速器、监视器、键盘布局及其他内部对象。 GDI对象 图形输出设备应用程序编程接口(API)的图形设备接口(GDI)库中的对象数量。 I/O读取 由进程（包括文件、网络和设备I/O）生成的读取输入/输出操作的数量。无法计算定向到CONSOLE（控制台输入对象）句柄的I/O 读取数量。 I/O写入 由进程（包括文件、网络和设备I/O）生成的写入输入/输出操作的数量。无法计算定向到CONSOLE（控制台输入对象）句柄的I/O 写入数量。 I/O其他 由既非读取又非写入的进程（包括文件、网络和设备I/O）生成的输入/输出操作的数量。此类操作的示例是控制功能。无法计算定向到CONSOLE（控制台输入对象）句柄的I/O 其他操作数量。 I/O读取字节 由进程（包括文件、网络和设备I/O）生成的输入/输出操作所读取的字节数。无法计算定向到CONSOLE（控制台输入对象）句柄的I/O 读取字节数。 I/O写入字节 由进程（包括文件、网络和设备I/O）生成的输入/输出操作所写入的字节数。无法计算定向到CONSOLE（控制台输入对象）句柄的I/O 写入字节数。 I/O其他字节 由既非读取又非写入的进程（包括文件、网络和设备I/O）生成的输入/输出操作所传输的字节数。此类操作的示例是控制功能。无法计算定向到CONSOLE（控制台输入对象）句柄的I/O 其他字节数。 映像路径名称 硬盘上的进程位置。 命令行 指定为创建进程的完整命令行。 用户帐户控制(UAC)虚拟化 确定为此进程启用、禁用还是不允许使用用户帐户控制(UAC) 虚拟化。UAC虚拟化将文件和注册表写入错误重定向到每用户位置。 描述 进程的描述。 数据执行保护 是否为此进程启用或禁用数据执行保护。有关详细信息，请参阅什么是数据执行保护？","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Deployment","slug":"Deployment","permalink":"http://www.kikitamap.com/tags/Deployment/"}]},{"title":"ArcPad 8 简介","slug":"ArcPad8Overview","date":"2012-02-07T05:59:00.000Z","updated":"2016-03-20T03:23:26.904Z","comments":true,"path":"2012/02/07/ArcPad8Overview/","link":"","permalink":"http://www.kikitamap.com/2012/02/07/ArcPad8Overview/","excerpt":"","text":"ArcPad主要是针对外业数据采集人员的一款产品，它相对独立，但不是完全孤立的，可以与GPS、测距仪、数码相机进行一体化作业。2009年4月推出的ArcPad8以其强大的功能为GIS外业人员提供了巨大的便利。 ArcPad包中包含了Arcpad和ArcPad Application Builder，前者主要用于外业数据采集，后者主要用于定制功能。由此大家可能还联想到ArcGIS Mobile，它是集成与ArcGIS Server高级企业版中的，主要用于通过开发来定制移动GIS功能，提供解决方案。ArcPad与ArcGIS Mobile二者可以用ArcGIS Desktop和AE来类比。 ArcPad在移动设备上支持Windows Mobile 5.0以上的系统，PC上支持Vista、XP，目前我用的Windows7，也没发现什么问题。注意：ArcPad8是不再支持Windows CE .NET的。 ArcPad的工作流程大致有三种： 1、快速工程：这是一种立即可用的数据采集方案，没有正式的数据结构和现有数据背景，通常需求是临时提的。直接在移动设备上打开ArcPad，选择快速工程，自动生成点线面图层，是shapefiles。通过采集和编辑之后，将这些数据文件copy到ArcGIS Desktop中，利用ArcGIS来管理数据即可。 2、本地数据工作流程：原来已经有数据，需要到ArcGIS Desktop中将数据导出，这用到一个工具条ArcPad Data Manager。然后利用手持设备外业采集，在ArcPad中进行编辑，最后将数据再导入即可。这种工作流程通常是用于小型的工作组。 3、ArcGIS Server 企业级工作流程：首先是在ArcCatalog或者ArcGIS Server Manager中发布服务，在ArcPad中浏览服务，进行数据的编辑。在ArcPad8中，增加了同步数据的功能，用户可以将在野外实时采集的数据同步到ArcGIS Server的GDB中。大大提高了工作效率。这种工作流程对SDE数据库有要求，就是数据要先注册版本，并且表中要含有字段“GlobalID”。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"ArcPad","slug":"ArcPad","permalink":"http://www.kikitamap.com/tags/ArcPad/"}]},{"title":"Maplex中，设置面要素标注锚点位置","slug":"AnchorPointinMaplex","date":"2012-02-07T05:54:00.000Z","updated":"2016-03-20T03:21:36.997Z","comments":true,"path":"2012/02/07/AnchorPointinMaplex/","link":"","permalink":"http://www.kikitamap.com/2012/02/07/AnchorPointinMaplex/","excerpt":"","text":"开启Maplex标注引擎后，面要素的标注选项中有一项叫做Anchor Point，用来设置带有背景牵引线的标注的放置位置。 一共提供了四种放置位置，一起来了解下区别在哪里。 几何中心(然后轮廓线上最近点) Geometric center (then closest point on outline) 这里的几何中心是指面的重心。注意：重心并不一定都处于图形的内部。所以尝试先放置要素几何中心，如果几何中心在外部无法放置，则放置到最近的轮廓线上一点。 侵蚀中心 Eroded center (always within polygon) 向内“缩小”面，收紧到最后，得到中心点，类似剥洋葱，这个点一定位于面内部。 多边形轮廓线上的最近点 Closest point on the polygon outline 锚点将放置在多边形轮廓线上距离标注最接近的点。 未裁剪多边形的几何中心(然后侵蚀中心) Geometric center of unclipped polygon (then eroded center) 先尝试忽略中间“洞”的多边形的几何中心，不行再放到侵蚀中心。 下图作为这几个中心的比较： 其实，如果嫌麻烦，把Placement选项设置好也可以满足大部分需求。","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Mapping","slug":"Mapping","permalink":"http://www.kikitamap.com/tags/Mapping/"}]},{"title":"KML/KMZ到ArcGIS完全转化","slug":"importKMLKMZ","date":"2012-02-07T05:50:13.000Z","updated":"2016-03-20T03:17:15.843Z","comments":true,"path":"2012/02/07/importKMLKMZ/","link":"","permalink":"http://www.kikitamap.com/2012/02/07/importKMLKMZ/","excerpt":"","text":"在ArcGIS中，做KML（Keyhole Markup Language）的导入，我们可以使用两种方法：一是ArcToolbox中的转换工具；二是数据互操作扩展。本文将以ArcToolbox中的工具为例来导入KML或KMZ。当然如果没有数据互操作扩展的用户，第一种方法也是首选。 在ArcToolbox中有转换工具（Conversion Tools）下的由KML转出（From KML）下的KML转图层（KML to Layer）。 此工具将会把KML或KMZ文件的数据，转换到FileGDB中的数据集中，数据的展现符号化等信息存储在同名的图层文件（.lyr）中。 注意：此工具中，仅需要选择一个目的文件夹，GDB和lyr文件都会自行创建。 其实到这里，KML文件中包含的信息已经进入ArcGIS的怀抱了。 如果有特殊需要，就Export下，可以得到shape。 另外，ArcGIS 提供了导出成KML、KMZ的工具： 图层转KML（Layer to KML） 地图转KML（Map to KML）","categories":[{"name":"木工开物","slug":"木工开物","permalink":"http://www.kikitamap.com/categories/木工开物/"}],"tags":[{"name":"Geodata","slug":"Geodata","permalink":"http://www.kikitamap.com/tags/Geodata/"}]}]}