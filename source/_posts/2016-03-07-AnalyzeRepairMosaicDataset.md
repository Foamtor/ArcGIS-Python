title: 镶嵌数据集工具小结（十一）分析、修复、同步镶嵌数据集
categories:
  - 木工开物
date: 2014-12-09 15:40:37
tags: [Raster,Geodata]
---
这是这个专题的最后一篇，将剩下的几个工具放在一起说一说。下面的这些工具在镶嵌数据集正常运行时常常会被忽略，但是一旦出现异常或者故障，这些工具就有了用武之地。 

![](http://7xospm.com1.z0.glb.clouddn.com/97a90632-548f-456f-a03d-87db163c5cab_20141208100341577.png) 

<br>

# 分析镶嵌数据集 

当我们发现镶嵌数据集不能按照预期运行，或者性能比较差的的时候，可以使用工具 **Analyze Mosaic Dataset** 来分析检查存在的问题。这个工具可以发现常见问题、发出警告消息，并且给出些解决方法或者建议等。另外，当在 ArcMap 中镶嵌数据集图层的右键菜单也可以调用这个工具。 

![](http://7xospm.com1.z0.glb.clouddn.com/03b3b577-6754-471b-bd67-daad6db13b9b_SouthEast.png) 

<br>

分析之后，在 Prepare 窗口中列出检查到的 Error，Warning，Message等，在列表的每一行上右键，都会打开相应的解决方法或者建议。 

![](http://7xospm.com1.z0.glb.clouddn.com/a432d3e5-1e55-425a-83b9-6652bab117c8_20141208111037265.png) 

使用分析镶嵌数据集工具，我们可以分析的对象有： 

> **FOOTPRINT** — 镶嵌数据集的轮廓线 
> **FUNCTION**—镶嵌数据集的栅格函数 
> **RASTER** — 栅格数据 
> **PATHS**— 分析是否存在损坏的路径 
> **SOURCE_VALIDITY**— 对源数据的潜在问题进行分析。此方法可以有效检测同步工作期间可能发生的问题。 
> **STALE** — 分析镶嵌数据集项目是否过时 
> **PYRAMIDS** — 栅格数据金字塔，测试金字塔是否有断开连接的辅助文件。 
> **STATISTICS** —  栅格统计数据和直方图 
> **PERFORMANCE** — 对性能相关的问题进行分析。例如，传输期间未压缩，或建议对涉及大量栅格函数的项目进行项目缓存。 
> **INFORMATION** —  对镶嵌数据集及其项目进行分析，并会为分析结果生成信息日志。 

<br>

# 计算脏区

**Compute Dirty Area** 工具用于标识镶嵌数据集中在指定时间点之后发生更改的区域。 

工具的输出结果为面要素类，在面要素类区域以内就是发生变化的区域。工具支持较多的时间格式的输入，参考工具内部格式样例填写即可。 

<br>
 
# 镶嵌数据集的路径 

我们知道镶嵌数据集中存储的是栅格数据源的引用信息，而不是栅格数据源本身。当我们复制或者移动镶嵌数据集到其他位置时，镶嵌数据集中的引用信息并没有发生变化。 

有时，在同一台机器上，由于源数据的绝对路径没有变化，因此即使挪了镶嵌数据集的位置，也没有什么影响。但是如果是把镶嵌数据集移动或者复制到另一台机器上，或者其他原因源栅格数据的路径发生了更改，那么我们要做的就是更新或者说修复路径。 

如果我们需要知道镶嵌数据集现在使用的数据源，使用 **Export Mosaic Dataset Paths** 工具可以将镶嵌数据集引用的路径信息导出成一张表。也可以仅将损坏的路径导出。 

然后使用工具 **Repair ****Mosaic Dataset Paths** 对路径进行修复，如果要更改所有路径，可输入星号 (*) 作为原始路径。 

<br>

# 同步镶嵌数据集  

工具 **Synchronize Mosaic Dataset **可以将镶嵌数据集保持为最新状态。要理解同步镶嵌数据集，理解镶嵌数据集内数据的组织方式非常重要。 

1）最常见的是直接引用栅格数据的镶嵌数据集。这种镶嵌数据集与源数据有直接关系，可以称之为“源镶嵌数据集”。 

![](http://7xospm.com1.z0.glb.clouddn.com/8efdb800-0181-44e8-b591-39dbd592a08c_20141209135158700.png) 

2）镶嵌数据集的数据源还可以是另外一个镶嵌数据集，也就是在创建镶嵌数据集后，添加数据的数据源是另外一个镶嵌数据集。这种可以称之为“派生镶嵌数据集”，帮助理解。当源镶嵌数据集发生变化时，为了保持派生镶嵌数据集最新，同步镶嵌数据集就非常重要了。 

PS：在第一篇中提到过 “引用镶嵌数据集 / Referenced Mosaic Dataset” ，这是一种特别的镶嵌数据集，与上文要表达的 “派生镶嵌数据集” 不是一种哦。 

![](http://7xospm.com1.z0.glb.clouddn.com/084158f4-dbe0-4e4b-88a9-8e696e30978d_20141209150853266.png) 

同步镶嵌数据集是个单向操作，其中源数据中的更改可以同步到镶嵌数据集的属性表，但属性表中的更改将不会影响源数据，同步时所做的更改无法撤消。。应该在同步派生镶嵌数据集之前同步源镶嵌数据集，因为派生镶嵌数据集只能使用源镶嵌数据集中的信息进行更新。 

同步镶嵌数据集工具中有一系列的参数可供配置，来细化控制参与同步的想，所见即所得，不再赘述。 

<br>

# 更改镶嵌数据集方案

**Alter Mosaic Dataset Schema** 工具通过生成所需的表或字段准备 ArcSDE 中镶嵌数据集的方案。该工具可防止在 ArcSDE 中存储镶嵌数据集时可能发生的方案锁定问题。 

只有在 ArcSDE 中创建镶嵌数据集，而且由非数据集所有者编辑镶嵌数据集时，才需要此工具。 

在工具中，选择该镶嵌数据集所允许的操作。这将创建所需的必要表。如果非数据集所有者尝试执行不允许的操作，则操作会失败。 

操作选项：ANALYSIS，BOUNDARY，CACHE，COLOR_CORRECTION，LEVELS，LOG，OVERVIEW，SEAMLINE，STEREO，VIEW 

选择该镶嵌数据集所允许的栅格类型。这将创建所需的必要字段。如果非数据集所有者使用添加栅格至镶嵌数据集工具并尝试使用该工具未指定的栅格类型，则添加栅格至镶嵌数据集的执行将会失败。 

 